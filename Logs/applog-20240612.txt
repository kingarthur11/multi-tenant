2024-06-12 03:38:13.036 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2024-06-12 03:38:13.356 +01:00 [DBG] Hosting starting
2024-06-12 03:38:13.525 +01:00 [INF] Now listening on: http://localhost:5165
2024-06-12 03:38:13.590 +01:00 [DBG] Loaded hosting startup assembly MyProject
2024-06-12 03:38:13.591 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2024-06-12 03:38:13.592 +01:00 [INF] Hosting environment: Development
2024-06-12 03:38:13.593 +01:00 [INF] Content root path: C:\Users\ARthur\Desktop\projects\personal\MyProject
2024-06-12 03:38:13.595 +01:00 [DBG] Hosting started
2024-06-12 03:39:12.948 +01:00 [INF] Application is shutting down...
2024-06-12 03:39:13.023 +01:00 [DBG] Hosting stopping
2024-06-12 03:39:13.093 +01:00 [DBG] Hosting stopped
2024-06-12 03:39:24.566 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2024-06-12 03:39:26.647 +01:00 [DBG] Hosting starting
2024-06-12 03:39:26.886 +01:00 [INF] Now listening on: http://localhost:5165
2024-06-12 03:39:28.057 +01:00 [DBG] Loaded hosting startup assembly MyProject
2024-06-12 03:39:28.125 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2024-06-12 03:39:28.130 +01:00 [INF] Hosting environment: Development
2024-06-12 03:39:28.133 +01:00 [INF] Content root path: C:\Users\ARthur\Desktop\projects\personal\MyProject
2024-06-12 03:39:28.134 +01:00 [DBG] Hosting started
2024-06-12 03:39:43.888 +01:00 [DBG] Connection id "0HN4AH3LCDNN3" accepted.
2024-06-12 03:39:43.893 +01:00 [DBG] Connection id "0HN4AH3LCDNN3" started.
2024-06-12 03:39:44.019 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5165/api/product - application/json 37
2024-06-12 03:39:44.051 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2024-06-12 03:39:44.122 +01:00 [DBG] 1 candidate(s) found for the request path '/api/product'
2024-06-12 03:39:44.133 +01:00 [DBG] Endpoint 'MyProject.Controller.ProductsController.Post (MyProject)' with route pattern 'api/product' is valid for the request path '/api/product'
2024-06-12 03:39:44.136 +01:00 [DBG] Request matched endpoint 'MyProject.Controller.ProductsController.Post (MyProject)'
2024-06-12 03:39:44.180 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2024-06-12 03:39:44.185 +01:00 [WRN] Failed to determine the https port for redirect.
2024-06-12 03:39:44.188 +01:00 [INF] Executing endpoint 'MyProject.Controller.ProductsController.Post (MyProject)'
2024-06-12 03:39:44.245 +01:00 [INF] Route matched with {action = "Post", controller = "Products"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Post(MyProject.DTOs.CreateProductRequest) on controller MyProject.Controller.ProductsController (MyProject).
2024-06-12 03:39:44.256 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2024-06-12 03:39:44.262 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2024-06-12 03:39:44.267 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2024-06-12 03:39:44.271 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2024-06-12 03:39:44.273 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2024-06-12 03:39:44.287 +01:00 [DBG] Executing controller factory for controller MyProject.Controller.ProductsController (MyProject)
2024-06-12 03:39:44.717 +01:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2024-06-12 03:39:44.782 +01:00 [DBG] Executed controller factory for controller MyProject.Controller.ProductsController (MyProject)
2024-06-12 03:39:44.805 +01:00 [DBG] Attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest' ...
2024-06-12 03:39:44.812 +01:00 [DBG] Attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest' using the name '' in request data ...
2024-06-12 03:39:44.819 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2024-06-12 03:39:44.852 +01:00 [DBG] Connection id "0HN4AH3LCDNN3", Request id "0HN4AH3LCDNN3:00000001": started reading request body.
2024-06-12 03:39:44.855 +01:00 [DBG] Connection id "0HN4AH3LCDNN3", Request id "0HN4AH3LCDNN3:00000001": done reading request body.
2024-06-12 03:39:44.867 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'MyProject.DTOs.CreateProductRequest'
2024-06-12 03:39:44.869 +01:00 [DBG] Done attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest'.
2024-06-12 03:39:44.871 +01:00 [DBG] Done attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest'.
2024-06-12 03:39:44.873 +01:00 [DBG] Attempting to validate the bound parameter 'request' of type 'MyProject.DTOs.CreateProductRequest' ...
2024-06-12 03:39:44.889 +01:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'MyProject.DTOs.CreateProductRequest'.
2024-06-12 03:39:45.882 +01:00 [DBG] Entity Framework Core 8.0.6 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2024-06-12 03:39:45.975 +01:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Product.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 03:39:46.061 +01:00 [DBG] Context 'AppDbContext' started tracking 'Product' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 03:39:46.073 +01:00 [DBG] DetectChanges starting for 'AppDbContext'.
2024-06-12 03:39:46.097 +01:00 [DBG] DetectChanges completed for 'AppDbContext'.
2024-06-12 03:39:46.103 +01:00 [DBG] SaveChanges starting for 'AppDbContext'.
2024-06-12 03:39:46.106 +01:00 [DBG] DetectChanges starting for 'AppDbContext'.
2024-06-12 03:39:46.109 +01:00 [DBG] DetectChanges completed for 'AppDbContext'.
2024-06-12 03:39:46.237 +01:00 [DBG] Creating DbConnection.
2024-06-12 03:39:46.484 +01:00 [DBG] Created DbConnection. (256ms).
2024-06-12 03:39:46.513 +01:00 [DBG] Opening connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 03:39:46.751 +01:00 [DBG] Opened connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 03:39:46.760 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-06-12 03:39:46.769 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (5ms).
2024-06-12 03:39:46.779 +01:00 [DBG] Initialized DbCommand for 'ExecuteReader' (19ms).
2024-06-12 03:39:46.792 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?' (DbType = Decimal), @p2='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Products" ("Name", "Price", "TenantId")
VALUES (@p0, @p1, @p2)
RETURNING "Id";
2024-06-12 03:39:46.895 +01:00 [ERR] Failed executing DbCommand (103ms) [Parameters=[@p0='?', @p1='?' (DbType = Decimal), @p2='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Products" ("Name", "Price", "TenantId")
VALUES (@p0, @p1, @p2)
RETURNING "Id";
2024-06-12 03:39:46.904 +01:00 [DBG] Closing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 03:39:46.919 +01:00 [DBG] Closed connection to database 'userservice_db' on server 'tcp://localhost:5432' (10ms).
2024-06-12 03:39:46.954 +01:00 [ERR] An exception occurred in the database while saving changes for context type 'MyProject.Data.AppDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23502: null value in column "TenantId" of relation "Products" violates not-null constraint

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
  Exception data:
    Severity: ERROR
    SqlState: 23502
    MessageText: null value in column "TenantId" of relation "Products" violates not-null constraint
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: Products
    ColumnName: TenantId
    File: execMain.c
    Line: 1974
    Routine: ExecConstraints
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChanges(IList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(StateManager stateManager, Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<>c.<SaveChanges>b__112_0(DbContext _, ValueTuple`2 t)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23502: null value in column "TenantId" of relation "Products" violates not-null constraint

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
  Exception data:
    Severity: ERROR
    SqlState: 23502
    MessageText: null value in column "TenantId" of relation "Products" violates not-null constraint
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: Products
    ColumnName: TenantId
    File: execMain.c
    Line: 1974
    Routine: ExecConstraints
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChanges(IList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(StateManager stateManager, Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<>c.<SaveChanges>b__112_0(DbContext _, ValueTuple`2 t)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
2024-06-12 03:39:46.983 +01:00 [INF] Executed action MyProject.Controller.ProductsController.Post (MyProject) in 2700.1314ms
2024-06-12 03:39:46.987 +01:00 [INF] Executed endpoint 'MyProject.Controller.ProductsController.Post (MyProject)'
2024-06-12 03:39:46.992 +01:00 [ERR] HTTP POST /api/product responded 500 in 2805.2952 ms
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23502: null value in column "TenantId" of relation "Products" violates not-null constraint

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
  Exception data:
    Severity: ERROR
    SqlState: 23502
    MessageText: null value in column "TenantId" of relation "Products" violates not-null constraint
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: Products
    ColumnName: TenantId
    File: execMain.c
    Line: 1974
    Routine: ExecConstraints
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChanges(IList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(StateManager stateManager, Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<>c.<SaveChanges>b__112_0(DbContext _, ValueTuple`2 t)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges()
   at MyProject.Data.AppDbContext.SaveChanges() in C:\Users\ARthur\Desktop\projects\personal\MyProject\Data\AppDbContext .cs:line 36
   at MyProject.Repository.ProductService.CreateProduct(CreateProductRequest request) in C:\Users\ARthur\Desktop\projects\personal\MyProject\Repository\ProductService .cs:line 41
   at MyProject.Controller.ProductsController.Post(CreateProductRequest request) in C:\Users\ARthur\Desktop\projects\personal\MyProject\Controller\ProductsController.cs:line 34
   at lambda_method2(Closure, Object, Object[])
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.SyncActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeNextActionFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2024-06-12 03:39:47.049 +01:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23502: null value in column "TenantId" of relation "Products" violates not-null constraint

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
  Exception data:
    Severity: ERROR
    SqlState: 23502
    MessageText: null value in column "TenantId" of relation "Products" violates not-null constraint
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: Products
    ColumnName: TenantId
    File: execMain.c
    Line: 1974
    Routine: ExecConstraints
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChanges(IList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(StateManager stateManager, Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<>c.<SaveChanges>b__112_0(DbContext _, ValueTuple`2 t)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges()
   at MyProject.Data.AppDbContext.SaveChanges() in C:\Users\ARthur\Desktop\projects\personal\MyProject\Data\AppDbContext .cs:line 36
   at MyProject.Repository.ProductService.CreateProduct(CreateProductRequest request) in C:\Users\ARthur\Desktop\projects\personal\MyProject\Repository\ProductService .cs:line 41
   at MyProject.Controller.ProductsController.Post(CreateProductRequest request) in C:\Users\ARthur\Desktop\projects\personal\MyProject\Controller\ProductsController.cs:line 34
   at lambda_method2(Closure, Object, Object[])
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.SyncActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeNextActionFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2024-06-12 03:39:47.110 +01:00 [DBG] Connection id "0HN4AH3LCDNN3" completed keep alive response.
2024-06-12 03:39:47.116 +01:00 [DBG] 'AppDbContext' disposed.
2024-06-12 03:39:47.127 +01:00 [DBG] Disposing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 03:39:47.133 +01:00 [DBG] Disposed connection to database 'userservice_db' on server 'tcp://localhost:5432' (6ms).
2024-06-12 03:39:47.138 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5165/api/product - 500 null text/plain; charset=utf-8 3123.5284ms
2024-06-12 03:41:57.443 +01:00 [DBG] Connection id "0HN4AH3LCDNN3" disconnecting.
2024-06-12 03:41:57.472 +01:00 [DBG] Connection id "0HN4AH3LCDNN3" stopped.
2024-06-12 03:41:57.480 +01:00 [DBG] Connection id "0HN4AH3LCDNN3" sending FIN because: "The Socket transport's send loop completed gracefully."
2024-06-12 03:46:24.008 +01:00 [INF] Application is shutting down...
2024-06-12 03:46:24.045 +01:00 [DBG] Hosting stopping
2024-06-12 03:46:25.146 +01:00 [DBG] Hosting stopped
2024-06-12 03:46:42.807 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2024-06-12 03:46:43.021 +01:00 [DBG] Hosting starting
2024-06-12 03:46:43.117 +01:00 [INF] Now listening on: http://localhost:5165
2024-06-12 03:46:43.128 +01:00 [DBG] Loaded hosting startup assembly MyProject
2024-06-12 03:46:43.135 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2024-06-12 03:46:43.138 +01:00 [INF] Hosting environment: Development
2024-06-12 03:46:43.140 +01:00 [INF] Content root path: C:\Users\ARthur\Desktop\projects\personal\MyProject
2024-06-12 03:46:43.142 +01:00 [DBG] Hosting started
2024-06-12 03:46:53.282 +01:00 [DBG] Connection id "0HN4AH7LBDUSP" accepted.
2024-06-12 03:46:53.312 +01:00 [DBG] Connection id "0HN4AH7LBDUSP" started.
2024-06-12 03:46:53.433 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5165/api/product - application/json 37
2024-06-12 03:46:54.354 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2024-06-12 03:46:54.710 +01:00 [DBG] 1 candidate(s) found for the request path '/api/product'
2024-06-12 03:46:56.122 +01:00 [DBG] Endpoint 'MyProject.Controller.ProductsController.Post (MyProject)' with route pattern 'api/product' is valid for the request path '/api/product'
2024-06-12 03:46:56.664 +01:00 [DBG] Request matched endpoint 'MyProject.Controller.ProductsController.Post (MyProject)'
2024-06-12 03:46:57.175 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2024-06-12 03:46:57.714 +01:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2024-06-12 03:46:58.341 +01:00 [INF] tenantinfo
2024-06-12 03:47:00.544 +01:00 [DBG] Entity Framework Core 8.0.6 initialized 'TenantDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2024-06-12 03:47:02.043 +01:00 [DBG] Compiling query expression: 
'DbSet<Tenant>()
    .Where(x => x.Id == __tenant_0)
    .FirstOrDefault()'
2024-06-12 03:47:02.945 +01:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Tenant>(
    asyncEnumerable: new SingleQueryingEnumerable<Tenant>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Tenant.Id (string) Required PK AfterSave:Throw, 0], [Property: Tenant.Name (string) Required, 1] }
            SELECT TOP(1) t.Id, t.Name
            FROM Tenants AS t
            WHERE t.Id == @__tenant_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Tenant>, 
        MyProject.Data.TenantDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2024-06-12 03:47:03.443 +01:00 [DBG] Creating DbConnection.
2024-06-12 03:47:03.535 +01:00 [DBG] Created DbConnection. (90ms).
2024-06-12 03:47:03.568 +01:00 [DBG] Opening connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 03:47:04.244 +01:00 [DBG] Opened connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 03:47:04.254 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-06-12 03:47:04.272 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (13ms).
2024-06-12 03:47:04.298 +01:00 [DBG] Initialized DbCommand for 'ExecuteReader' (45ms).
2024-06-12 03:47:04.316 +01:00 [DBG] Executing DbCommand [Parameters=[@__tenant_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Name"
FROM "Tenants" AS t
WHERE t."Id" = @__tenant_0
LIMIT 1
2024-06-12 03:47:04.496 +01:00 [INF] Executed DbCommand (171ms) [Parameters=[@__tenant_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Name"
FROM "Tenants" AS t
WHERE t."Id" = @__tenant_0
LIMIT 1
2024-06-12 03:47:05.060 +01:00 [DBG] Context 'TenantDbContext' started tracking 'Tenant' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 03:47:05.104 +01:00 [DBG] Closing data reader to 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 03:47:05.435 +01:00 [DBG] A data reader for 'userservice_db' on server 'tcp://localhost:5432' is being disposed after spending 452ms reading results.
2024-06-12 03:47:05.443 +01:00 [DBG] Closing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 03:47:05.454 +01:00 [DBG] Closed connection to database 'userservice_db' on server 'tcp://localhost:5432' (11ms).
2024-06-12 03:47:05.460 +01:00 [WRN] Failed to determine the https port for redirect.
2024-06-12 03:47:05.465 +01:00 [INF] Executing endpoint 'MyProject.Controller.ProductsController.Post (MyProject)'
2024-06-12 03:47:05.502 +01:00 [INF] Route matched with {action = "Post", controller = "Products"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Post(MyProject.DTOs.CreateProductRequest) on controller MyProject.Controller.ProductsController (MyProject).
2024-06-12 03:47:05.512 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2024-06-12 03:47:05.518 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2024-06-12 03:47:05.522 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2024-06-12 03:47:05.525 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2024-06-12 03:47:05.527 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2024-06-12 03:47:05.537 +01:00 [DBG] Executing controller factory for controller MyProject.Controller.ProductsController (MyProject)
2024-06-12 03:47:05.544 +01:00 [DBG] Executed controller factory for controller MyProject.Controller.ProductsController (MyProject)
2024-06-12 03:47:05.566 +01:00 [DBG] Attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest' ...
2024-06-12 03:47:05.572 +01:00 [DBG] Attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest' using the name '' in request data ...
2024-06-12 03:47:05.577 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2024-06-12 03:47:05.618 +01:00 [DBG] Connection id "0HN4AH7LBDUSP", Request id "0HN4AH7LBDUSP:00000001": started reading request body.
2024-06-12 03:47:05.620 +01:00 [DBG] Connection id "0HN4AH7LBDUSP", Request id "0HN4AH7LBDUSP:00000001": done reading request body.
2024-06-12 03:47:05.638 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'MyProject.DTOs.CreateProductRequest'
2024-06-12 03:47:05.645 +01:00 [DBG] Done attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest'.
2024-06-12 03:47:05.650 +01:00 [DBG] Done attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest'.
2024-06-12 03:47:05.652 +01:00 [DBG] Attempting to validate the bound parameter 'request' of type 'MyProject.DTOs.CreateProductRequest' ...
2024-06-12 03:47:05.668 +01:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'MyProject.DTOs.CreateProductRequest'.
2024-06-12 03:47:05.775 +01:00 [DBG] Entity Framework Core 8.0.6 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2024-06-12 03:47:05.817 +01:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Product.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 03:47:05.866 +01:00 [DBG] Context 'AppDbContext' started tracking 'Product' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 03:47:05.876 +01:00 [DBG] DetectChanges starting for 'AppDbContext'.
2024-06-12 03:47:05.902 +01:00 [DBG] DetectChanges completed for 'AppDbContext'.
2024-06-12 03:47:05.911 +01:00 [DBG] SaveChanges starting for 'AppDbContext'.
2024-06-12 03:47:05.917 +01:00 [DBG] DetectChanges starting for 'AppDbContext'.
2024-06-12 03:47:05.919 +01:00 [DBG] DetectChanges completed for 'AppDbContext'.
2024-06-12 03:47:06.023 +01:00 [DBG] Creating DbConnection.
2024-06-12 03:47:06.025 +01:00 [DBG] Created DbConnection. (2ms).
2024-06-12 03:47:06.028 +01:00 [DBG] Opening connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 03:47:06.034 +01:00 [DBG] Opened connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 03:47:06.038 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-06-12 03:47:06.039 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2024-06-12 03:47:06.041 +01:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2024-06-12 03:47:06.054 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?' (DbType = Decimal), @p2='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Products" ("Name", "Price", "TenantId")
VALUES (@p0, @p1, @p2)
RETURNING "Id";
2024-06-12 03:47:06.085 +01:00 [ERR] Failed executing DbCommand (30ms) [Parameters=[@p0='?', @p1='?' (DbType = Decimal), @p2='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Products" ("Name", "Price", "TenantId")
VALUES (@p0, @p1, @p2)
RETURNING "Id";
2024-06-12 03:47:06.099 +01:00 [DBG] Closing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 03:47:06.101 +01:00 [DBG] Closed connection to database 'userservice_db' on server 'tcp://localhost:5432' (2ms).
2024-06-12 03:47:06.129 +01:00 [ERR] An exception occurred in the database while saving changes for context type 'MyProject.Data.AppDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23502: null value in column "TenantId" of relation "Products" violates not-null constraint

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
  Exception data:
    Severity: ERROR
    SqlState: 23502
    MessageText: null value in column "TenantId" of relation "Products" violates not-null constraint
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: Products
    ColumnName: TenantId
    File: execMain.c
    Line: 1974
    Routine: ExecConstraints
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChanges(IList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(StateManager stateManager, Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<>c.<SaveChanges>b__112_0(DbContext _, ValueTuple`2 t)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23502: null value in column "TenantId" of relation "Products" violates not-null constraint

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
  Exception data:
    Severity: ERROR
    SqlState: 23502
    MessageText: null value in column "TenantId" of relation "Products" violates not-null constraint
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: Products
    ColumnName: TenantId
    File: execMain.c
    Line: 1974
    Routine: ExecConstraints
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChanges(IList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(StateManager stateManager, Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<>c.<SaveChanges>b__112_0(DbContext _, ValueTuple`2 t)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
2024-06-12 03:47:09.613 +01:00 [INF] Executed action MyProject.Controller.ProductsController.Post (MyProject) in 4075.8797ms
2024-06-12 03:47:09.619 +01:00 [INF] Executed endpoint 'MyProject.Controller.ProductsController.Post (MyProject)'
2024-06-12 03:47:09.623 +01:00 [ERR] HTTP POST /api/product responded 500 in 4161.9932 ms
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23502: null value in column "TenantId" of relation "Products" violates not-null constraint

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
  Exception data:
    Severity: ERROR
    SqlState: 23502
    MessageText: null value in column "TenantId" of relation "Products" violates not-null constraint
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: Products
    ColumnName: TenantId
    File: execMain.c
    Line: 1974
    Routine: ExecConstraints
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChanges(IList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(StateManager stateManager, Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<>c.<SaveChanges>b__112_0(DbContext _, ValueTuple`2 t)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges()
   at MyProject.Data.AppDbContext.SaveChanges() in C:\Users\ARthur\Desktop\projects\personal\MyProject\Data\AppDbContext .cs:line 36
   at MyProject.Repository.ProductService.CreateProduct(CreateProductRequest request) in C:\Users\ARthur\Desktop\projects\personal\MyProject\Repository\ProductService .cs:line 41
   at MyProject.Controller.ProductsController.Post(CreateProductRequest request) in C:\Users\ARthur\Desktop\projects\personal\MyProject\Controller\ProductsController.cs:line 34
   at lambda_method20(Closure, Object, Object[])
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.SyncActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeNextActionFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2024-06-12 03:47:09.686 +01:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23502: null value in column "TenantId" of relation "Products" violates not-null constraint

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
  Exception data:
    Severity: ERROR
    SqlState: 23502
    MessageText: null value in column "TenantId" of relation "Products" violates not-null constraint
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: Products
    ColumnName: TenantId
    File: execMain.c
    Line: 1974
    Routine: ExecConstraints
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChanges(IList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(StateManager stateManager, Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<>c.<SaveChanges>b__112_0(DbContext _, ValueTuple`2 t)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges()
   at MyProject.Data.AppDbContext.SaveChanges() in C:\Users\ARthur\Desktop\projects\personal\MyProject\Data\AppDbContext .cs:line 36
   at MyProject.Repository.ProductService.CreateProduct(CreateProductRequest request) in C:\Users\ARthur\Desktop\projects\personal\MyProject\Repository\ProductService .cs:line 41
   at MyProject.Controller.ProductsController.Post(CreateProductRequest request) in C:\Users\ARthur\Desktop\projects\personal\MyProject\Controller\ProductsController.cs:line 34
   at lambda_method20(Closure, Object, Object[])
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.SyncActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeNextActionFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at MyProject.Middleware.TenantResolver.InvokeAsync(HttpContext context, ICurrentTenantService currentTenantService) in C:\Users\ARthur\Desktop\projects\personal\MyProject\Middleware\TenantResolver.cs:line 26
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2024-06-12 03:47:09.739 +01:00 [DBG] Connection id "0HN4AH7LBDUSP" completed keep alive response.
2024-06-12 03:47:09.745 +01:00 [DBG] 'AppDbContext' disposed.
2024-06-12 03:47:09.754 +01:00 [DBG] Disposing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 03:47:09.758 +01:00 [DBG] Disposed connection to database 'userservice_db' on server 'tcp://localhost:5432' (4ms).
2024-06-12 03:47:09.762 +01:00 [DBG] 'TenantDbContext' disposed.
2024-06-12 03:47:09.764 +01:00 [DBG] Disposing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 03:47:09.767 +01:00 [DBG] Disposed connection to database 'userservice_db' on server 'tcp://localhost:5432' (2ms).
2024-06-12 03:47:09.770 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5165/api/product - 500 null text/plain; charset=utf-8 16341.4493ms
2024-06-12 03:49:20.136 +01:00 [DBG] Connection id "0HN4AH7LBDUSP" disconnecting.
2024-06-12 03:49:20.140 +01:00 [DBG] Connection id "0HN4AH7LBDUSP" stopped.
2024-06-12 03:49:20.143 +01:00 [DBG] Connection id "0HN4AH7LBDUSP" sending FIN because: "The Socket transport's send loop completed gracefully."
2024-06-12 03:54:00.514 +01:00 [INF] Application is shutting down...
2024-06-12 03:54:00.515 +01:00 [DBG] Hosting stopping
2024-06-12 03:54:00.524 +01:00 [DBG] Hosting stopped
2024-06-12 03:54:08.651 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2024-06-12 03:54:08.822 +01:00 [DBG] Hosting starting
2024-06-12 03:54:08.892 +01:00 [INF] Now listening on: http://localhost:5165
2024-06-12 03:54:08.893 +01:00 [DBG] Loaded hosting startup assembly MyProject
2024-06-12 03:54:08.895 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2024-06-12 03:54:08.897 +01:00 [INF] Hosting environment: Development
2024-06-12 03:54:08.899 +01:00 [INF] Content root path: C:\Users\ARthur\Desktop\projects\personal\MyProject
2024-06-12 03:54:08.900 +01:00 [DBG] Hosting started
2024-06-12 03:54:21.757 +01:00 [DBG] Connection id "0HN4AHBR0EHR9" accepted.
2024-06-12 03:54:21.932 +01:00 [DBG] Connection id "0HN4AHBR0EHR9" started.
2024-06-12 03:54:22.016 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5165/api/product - application/json 37
2024-06-12 03:54:22.035 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2024-06-12 03:54:22.080 +01:00 [DBG] 1 candidate(s) found for the request path '/api/product'
2024-06-12 03:54:22.089 +01:00 [DBG] Endpoint 'MyProject.Controller.ProductsController.Post (MyProject)' with route pattern 'api/product' is valid for the request path '/api/product'
2024-06-12 03:54:22.095 +01:00 [DBG] Request matched endpoint 'MyProject.Controller.ProductsController.Post (MyProject)'
2024-06-12 03:54:22.125 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2024-06-12 03:54:22.274 +01:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2024-06-12 03:54:22.312 +01:00 [INF] tenantinfo
2024-06-12 03:54:22.313 +01:00 [INF] tenantinfo header
2024-06-12 03:54:23.259 +01:00 [DBG] Entity Framework Core 8.0.6 initialized 'TenantDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2024-06-12 03:54:23.337 +01:00 [DBG] Compiling query expression: 
'DbSet<Tenant>()
    .Where(x => x.Id == __tenant_0)
    .FirstOrDefault()'
2024-06-12 03:54:24.110 +01:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Tenant>(
    asyncEnumerable: new SingleQueryingEnumerable<Tenant>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Tenant.Id (string) Required PK AfterSave:Throw, 0], [Property: Tenant.Name (string) Required, 1] }
            SELECT TOP(1) t.Id, t.Name
            FROM Tenants AS t
            WHERE t.Id == @__tenant_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Tenant>, 
        MyProject.Data.TenantDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2024-06-12 03:54:24.184 +01:00 [DBG] Creating DbConnection.
2024-06-12 03:54:24.296 +01:00 [DBG] Created DbConnection. (108ms).
2024-06-12 03:54:24.311 +01:00 [DBG] Opening connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 03:54:24.657 +01:00 [DBG] Opened connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 03:54:24.665 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-06-12 03:54:24.684 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (13ms).
2024-06-12 03:54:24.698 +01:00 [DBG] Initialized DbCommand for 'ExecuteReader' (33ms).
2024-06-12 03:54:24.720 +01:00 [DBG] Executing DbCommand [Parameters=[@__tenant_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Name"
FROM "Tenants" AS t
WHERE t."Id" = @__tenant_0
LIMIT 1
2024-06-12 03:54:24.842 +01:00 [INF] Executed DbCommand (129ms) [Parameters=[@__tenant_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Name"
FROM "Tenants" AS t
WHERE t."Id" = @__tenant_0
LIMIT 1
2024-06-12 03:54:24.937 +01:00 [DBG] Context 'TenantDbContext' started tracking 'Tenant' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 03:54:24.980 +01:00 [DBG] Closing data reader to 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 03:54:25.012 +01:00 [DBG] A data reader for 'userservice_db' on server 'tcp://localhost:5432' is being disposed after spending 151ms reading results.
2024-06-12 03:54:25.024 +01:00 [DBG] Closing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 03:54:25.034 +01:00 [DBG] Closed connection to database 'userservice_db' on server 'tcp://localhost:5432' (10ms).
2024-06-12 03:54:25.046 +01:00 [WRN] Failed to determine the https port for redirect.
2024-06-12 03:54:25.049 +01:00 [INF] Executing endpoint 'MyProject.Controller.ProductsController.Post (MyProject)'
2024-06-12 03:54:25.091 +01:00 [INF] Route matched with {action = "Post", controller = "Products"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Post(MyProject.DTOs.CreateProductRequest) on controller MyProject.Controller.ProductsController (MyProject).
2024-06-12 03:54:25.098 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2024-06-12 03:54:25.100 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2024-06-12 03:54:25.107 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2024-06-12 03:54:25.111 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2024-06-12 03:54:25.113 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2024-06-12 03:54:25.121 +01:00 [DBG] Executing controller factory for controller MyProject.Controller.ProductsController (MyProject)
2024-06-12 03:54:25.130 +01:00 [DBG] Executed controller factory for controller MyProject.Controller.ProductsController (MyProject)
2024-06-12 03:54:25.143 +01:00 [DBG] Attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest' ...
2024-06-12 03:54:25.148 +01:00 [DBG] Attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest' using the name '' in request data ...
2024-06-12 03:54:25.155 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2024-06-12 03:54:25.231 +01:00 [DBG] Connection id "0HN4AHBR0EHR9", Request id "0HN4AHBR0EHR9:00000001": started reading request body.
2024-06-12 03:54:25.742 +01:00 [DBG] Connection id "0HN4AHBR0EHR9", Request id "0HN4AHBR0EHR9:00000001": done reading request body.
2024-06-12 03:54:26.239 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'MyProject.DTOs.CreateProductRequest'
2024-06-12 03:54:26.249 +01:00 [DBG] Done attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest'.
2024-06-12 03:54:26.256 +01:00 [DBG] Done attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest'.
2024-06-12 03:54:26.257 +01:00 [DBG] Attempting to validate the bound parameter 'request' of type 'MyProject.DTOs.CreateProductRequest' ...
2024-06-12 03:54:26.283 +01:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'MyProject.DTOs.CreateProductRequest'.
2024-06-12 03:54:26.430 +01:00 [DBG] Entity Framework Core 8.0.6 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2024-06-12 03:54:26.487 +01:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Product.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 03:54:26.581 +01:00 [DBG] Context 'AppDbContext' started tracking 'Product' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 03:54:27.420 +01:00 [DBG] DetectChanges starting for 'AppDbContext'.
2024-06-12 03:54:27.498 +01:00 [DBG] DetectChanges completed for 'AppDbContext'.
2024-06-12 03:54:27.929 +01:00 [DBG] SaveChanges starting for 'AppDbContext'.
2024-06-12 03:54:27.943 +01:00 [DBG] DetectChanges starting for 'AppDbContext'.
2024-06-12 03:54:27.973 +01:00 [DBG] DetectChanges completed for 'AppDbContext'.
2024-06-12 03:54:28.363 +01:00 [DBG] Creating DbConnection.
2024-06-12 03:54:28.840 +01:00 [DBG] Created DbConnection. (476ms).
2024-06-12 03:54:29.608 +01:00 [DBG] Opening connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 03:54:29.613 +01:00 [DBG] Opened connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 03:54:29.937 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-06-12 03:54:29.939 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2024-06-12 03:54:29.943 +01:00 [DBG] Initialized DbCommand for 'ExecuteReader' (5ms).
2024-06-12 03:54:29.947 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?' (DbType = Decimal), @p2='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Products" ("Name", "Price", "TenantId")
VALUES (@p0, @p1, @p2)
RETURNING "Id";
2024-06-12 03:54:29.988 +01:00 [ERR] Failed executing DbCommand (40ms) [Parameters=[@p0='?', @p1='?' (DbType = Decimal), @p2='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Products" ("Name", "Price", "TenantId")
VALUES (@p0, @p1, @p2)
RETURNING "Id";
2024-06-12 03:54:29.996 +01:00 [DBG] Closing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 03:54:30.001 +01:00 [DBG] Closed connection to database 'userservice_db' on server 'tcp://localhost:5432' (4ms).
2024-06-12 03:54:30.026 +01:00 [ERR] An exception occurred in the database while saving changes for context type 'MyProject.Data.AppDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23502: null value in column "TenantId" of relation "Products" violates not-null constraint

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
  Exception data:
    Severity: ERROR
    SqlState: 23502
    MessageText: null value in column "TenantId" of relation "Products" violates not-null constraint
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: Products
    ColumnName: TenantId
    File: execMain.c
    Line: 1974
    Routine: ExecConstraints
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChanges(IList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(StateManager stateManager, Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<>c.<SaveChanges>b__112_0(DbContext _, ValueTuple`2 t)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23502: null value in column "TenantId" of relation "Products" violates not-null constraint

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
  Exception data:
    Severity: ERROR
    SqlState: 23502
    MessageText: null value in column "TenantId" of relation "Products" violates not-null constraint
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: Products
    ColumnName: TenantId
    File: execMain.c
    Line: 1974
    Routine: ExecConstraints
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChanges(IList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(StateManager stateManager, Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<>c.<SaveChanges>b__112_0(DbContext _, ValueTuple`2 t)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
2024-06-12 03:54:30.057 +01:00 [INF] Executed action MyProject.Controller.ProductsController.Post (MyProject) in 4935.2133ms
2024-06-12 03:54:30.069 +01:00 [INF] Executed endpoint 'MyProject.Controller.ProductsController.Post (MyProject)'
2024-06-12 03:54:30.074 +01:00 [ERR] HTTP POST /api/product responded 500 in 5026.5394 ms
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23502: null value in column "TenantId" of relation "Products" violates not-null constraint

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
  Exception data:
    Severity: ERROR
    SqlState: 23502
    MessageText: null value in column "TenantId" of relation "Products" violates not-null constraint
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: Products
    ColumnName: TenantId
    File: execMain.c
    Line: 1974
    Routine: ExecConstraints
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChanges(IList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(StateManager stateManager, Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<>c.<SaveChanges>b__112_0(DbContext _, ValueTuple`2 t)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges()
   at MyProject.Data.AppDbContext.SaveChanges() in C:\Users\ARthur\Desktop\projects\personal\MyProject\Data\AppDbContext .cs:line 36
   at MyProject.Repository.ProductService.CreateProduct(CreateProductRequest request) in C:\Users\ARthur\Desktop\projects\personal\MyProject\Repository\ProductService .cs:line 41
   at MyProject.Controller.ProductsController.Post(CreateProductRequest request) in C:\Users\ARthur\Desktop\projects\personal\MyProject\Controller\ProductsController.cs:line 34
   at lambda_method20(Closure, Object, Object[])
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.SyncActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeNextActionFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2024-06-12 03:54:30.520 +01:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23502: null value in column "TenantId" of relation "Products" violates not-null constraint

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
  Exception data:
    Severity: ERROR
    SqlState: 23502
    MessageText: null value in column "TenantId" of relation "Products" violates not-null constraint
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: Products
    ColumnName: TenantId
    File: execMain.c
    Line: 1974
    Routine: ExecConstraints
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChanges(IList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(StateManager stateManager, Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<>c.<SaveChanges>b__112_0(DbContext _, ValueTuple`2 t)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges()
   at MyProject.Data.AppDbContext.SaveChanges() in C:\Users\ARthur\Desktop\projects\personal\MyProject\Data\AppDbContext .cs:line 36
   at MyProject.Repository.ProductService.CreateProduct(CreateProductRequest request) in C:\Users\ARthur\Desktop\projects\personal\MyProject\Repository\ProductService .cs:line 41
   at MyProject.Controller.ProductsController.Post(CreateProductRequest request) in C:\Users\ARthur\Desktop\projects\personal\MyProject\Controller\ProductsController.cs:line 34
   at lambda_method20(Closure, Object, Object[])
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.SyncActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeNextActionFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at MyProject.Middleware.TenantResolver.InvokeAsync(HttpContext context, ICurrentTenantService currentTenantService) in C:\Users\ARthur\Desktop\projects\personal\MyProject\Middleware\TenantResolver.cs:line 27
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2024-06-12 03:54:30.567 +01:00 [DBG] Connection id "0HN4AHBR0EHR9" completed keep alive response.
2024-06-12 03:54:30.802 +01:00 [DBG] 'AppDbContext' disposed.
2024-06-12 03:54:30.810 +01:00 [DBG] Disposing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 03:54:30.815 +01:00 [DBG] Disposed connection to database 'userservice_db' on server 'tcp://localhost:5432' (5ms).
2024-06-12 03:54:30.820 +01:00 [DBG] 'TenantDbContext' disposed.
2024-06-12 03:54:30.821 +01:00 [DBG] Disposing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 03:54:30.823 +01:00 [DBG] Disposed connection to database 'userservice_db' on server 'tcp://localhost:5432' (1ms).
2024-06-12 03:54:30.826 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5165/api/product - 500 null text/plain; charset=utf-8 8811.5317ms
2024-06-12 03:56:41.630 +01:00 [DBG] Connection id "0HN4AHBR0EHR9" disconnecting.
2024-06-12 03:56:41.635 +01:00 [DBG] Connection id "0HN4AHBR0EHR9" stopped.
2024-06-12 03:56:41.642 +01:00 [DBG] Connection id "0HN4AHBR0EHR9" sending FIN because: "The Socket transport's send loop completed gracefully."
2024-06-12 04:03:58.662 +01:00 [INF] Application is shutting down...
2024-06-12 04:03:58.667 +01:00 [DBG] Hosting stopping
2024-06-12 04:03:58.690 +01:00 [DBG] Hosting stopped
2024-06-12 04:04:07.663 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2024-06-12 04:04:08.232 +01:00 [DBG] Hosting starting
2024-06-12 04:04:08.322 +01:00 [INF] Now listening on: http://localhost:5165
2024-06-12 04:04:08.336 +01:00 [DBG] Loaded hosting startup assembly MyProject
2024-06-12 04:04:08.343 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2024-06-12 04:04:08.354 +01:00 [INF] Hosting environment: Development
2024-06-12 04:04:08.388 +01:00 [INF] Content root path: C:\Users\ARthur\Desktop\projects\personal\MyProject
2024-06-12 04:04:08.414 +01:00 [DBG] Hosting started
2024-06-12 04:04:16.392 +01:00 [DBG] Connection id "0HN4AHHC7B43E" accepted.
2024-06-12 04:04:16.396 +01:00 [DBG] Connection id "0HN4AHHC7B43E" started.
2024-06-12 04:04:16.431 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5165/api/product - application/json 37
2024-06-12 04:04:16.442 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2024-06-12 04:04:16.474 +01:00 [DBG] 1 candidate(s) found for the request path '/api/product'
2024-06-12 04:04:16.480 +01:00 [DBG] Endpoint 'MyProject.Controller.ProductsController.Post (MyProject)' with route pattern 'api/product' is valid for the request path '/api/product'
2024-06-12 04:04:16.485 +01:00 [DBG] Request matched endpoint 'MyProject.Controller.ProductsController.Post (MyProject)'
2024-06-12 04:04:16.504 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2024-06-12 04:04:16.613 +01:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2024-06-12 04:04:17.487 +01:00 [DBG] Entity Framework Core 8.0.6 initialized 'TenantDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2024-06-12 04:04:17.613 +01:00 [DBG] Compiling query expression: 
'DbSet<Tenant>()
    .Where(x => x.Id == __tenant_0)
    .FirstOrDefault()'
2024-06-12 04:04:17.902 +01:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Tenant>(
    asyncEnumerable: new SingleQueryingEnumerable<Tenant>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Tenant.Id (string) Required PK AfterSave:Throw, 0], [Property: Tenant.Name (string) Required, 1] }
            SELECT TOP(1) t.Id, t.Name
            FROM Tenants AS t
            WHERE t.Id == @__tenant_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Tenant>, 
        MyProject.Data.TenantDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2024-06-12 04:04:17.969 +01:00 [DBG] Creating DbConnection.
2024-06-12 04:04:18.018 +01:00 [DBG] Created DbConnection. (44ms).
2024-06-12 04:04:18.030 +01:00 [DBG] Opening connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:04:18.343 +01:00 [DBG] Opened connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:04:18.354 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-06-12 04:04:18.370 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (7ms).
2024-06-12 04:04:18.380 +01:00 [DBG] Initialized DbCommand for 'ExecuteReader' (26ms).
2024-06-12 04:04:18.406 +01:00 [DBG] Executing DbCommand [Parameters=[@__tenant_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Name"
FROM "Tenants" AS t
WHERE t."Id" = @__tenant_0
LIMIT 1
2024-06-12 04:04:18.576 +01:00 [INF] Executed DbCommand (169ms) [Parameters=[@__tenant_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Name"
FROM "Tenants" AS t
WHERE t."Id" = @__tenant_0
LIMIT 1
2024-06-12 04:04:18.765 +01:00 [DBG] Context 'TenantDbContext' started tracking 'Tenant' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 04:04:18.910 +01:00 [DBG] Closing data reader to 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:04:18.929 +01:00 [DBG] A data reader for 'userservice_db' on server 'tcp://localhost:5432' is being disposed after spending 329ms reading results.
2024-06-12 04:04:18.941 +01:00 [DBG] Closing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:04:18.952 +01:00 [DBG] Closed connection to database 'userservice_db' on server 'tcp://localhost:5432' (10ms).
2024-06-12 04:04:18.956 +01:00 [INF] Tenant from header: Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpRequestHeaders
2024-06-12 04:04:18.958 +01:00 [INF] Tenant from header: beta
2024-06-12 04:04:18.963 +01:00 [WRN] Failed to determine the https port for redirect.
2024-06-12 04:04:18.968 +01:00 [INF] Executing endpoint 'MyProject.Controller.ProductsController.Post (MyProject)'
2024-06-12 04:04:18.988 +01:00 [INF] Route matched with {action = "Post", controller = "Products"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Post(MyProject.DTOs.CreateProductRequest) on controller MyProject.Controller.ProductsController (MyProject).
2024-06-12 04:04:18.993 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2024-06-12 04:04:18.996 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2024-06-12 04:04:19.000 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2024-06-12 04:04:19.004 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2024-06-12 04:04:19.006 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2024-06-12 04:04:19.011 +01:00 [DBG] Executing controller factory for controller MyProject.Controller.ProductsController (MyProject)
2024-06-12 04:04:19.019 +01:00 [DBG] Executed controller factory for controller MyProject.Controller.ProductsController (MyProject)
2024-06-12 04:04:19.027 +01:00 [DBG] Attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest' ...
2024-06-12 04:04:19.034 +01:00 [DBG] Attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest' using the name '' in request data ...
2024-06-12 04:04:19.039 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2024-06-12 04:04:19.064 +01:00 [DBG] Connection id "0HN4AHHC7B43E", Request id "0HN4AHHC7B43E:00000001": started reading request body.
2024-06-12 04:04:19.067 +01:00 [DBG] Connection id "0HN4AHHC7B43E", Request id "0HN4AHHC7B43E:00000001": done reading request body.
2024-06-12 04:04:19.079 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'MyProject.DTOs.CreateProductRequest'
2024-06-12 04:04:19.081 +01:00 [DBG] Done attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest'.
2024-06-12 04:04:19.084 +01:00 [DBG] Done attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest'.
2024-06-12 04:04:19.086 +01:00 [DBG] Attempting to validate the bound parameter 'request' of type 'MyProject.DTOs.CreateProductRequest' ...
2024-06-12 04:04:19.098 +01:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'MyProject.DTOs.CreateProductRequest'.
2024-06-12 04:04:19.198 +01:00 [DBG] Entity Framework Core 8.0.6 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2024-06-12 04:04:19.234 +01:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Product.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 04:04:19.277 +01:00 [DBG] Context 'AppDbContext' started tracking 'Product' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 04:04:19.286 +01:00 [DBG] DetectChanges starting for 'AppDbContext'.
2024-06-12 04:04:19.304 +01:00 [DBG] DetectChanges completed for 'AppDbContext'.
2024-06-12 04:04:19.308 +01:00 [DBG] SaveChanges starting for 'AppDbContext'.
2024-06-12 04:04:19.310 +01:00 [DBG] DetectChanges starting for 'AppDbContext'.
2024-06-12 04:04:19.311 +01:00 [DBG] DetectChanges completed for 'AppDbContext'.
2024-06-12 04:04:19.378 +01:00 [DBG] Creating DbConnection.
2024-06-12 04:04:19.380 +01:00 [DBG] Created DbConnection. (1ms).
2024-06-12 04:04:19.383 +01:00 [DBG] Opening connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:04:19.386 +01:00 [DBG] Opened connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:04:19.389 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-06-12 04:04:19.391 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2024-06-12 04:04:19.393 +01:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2024-06-12 04:04:19.395 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?' (DbType = Decimal), @p2='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Products" ("Name", "Price", "TenantId")
VALUES (@p0, @p1, @p2)
RETURNING "Id";
2024-06-12 04:04:19.412 +01:00 [ERR] Failed executing DbCommand (17ms) [Parameters=[@p0='?', @p1='?' (DbType = Decimal), @p2='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Products" ("Name", "Price", "TenantId")
VALUES (@p0, @p1, @p2)
RETURNING "Id";
2024-06-12 04:04:19.421 +01:00 [DBG] Closing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:04:19.424 +01:00 [DBG] Closed connection to database 'userservice_db' on server 'tcp://localhost:5432' (2ms).
2024-06-12 04:04:19.442 +01:00 [ERR] An exception occurred in the database while saving changes for context type 'MyProject.Data.AppDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23502: null value in column "TenantId" of relation "Products" violates not-null constraint

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
  Exception data:
    Severity: ERROR
    SqlState: 23502
    MessageText: null value in column "TenantId" of relation "Products" violates not-null constraint
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: Products
    ColumnName: TenantId
    File: execMain.c
    Line: 1974
    Routine: ExecConstraints
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChanges(IList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(StateManager stateManager, Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<>c.<SaveChanges>b__112_0(DbContext _, ValueTuple`2 t)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23502: null value in column "TenantId" of relation "Products" violates not-null constraint

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
  Exception data:
    Severity: ERROR
    SqlState: 23502
    MessageText: null value in column "TenantId" of relation "Products" violates not-null constraint
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: Products
    ColumnName: TenantId
    File: execMain.c
    Line: 1974
    Routine: ExecConstraints
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChanges(IList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(StateManager stateManager, Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<>c.<SaveChanges>b__112_0(DbContext _, ValueTuple`2 t)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
2024-06-12 04:04:19.466 +01:00 [INF] Executed action MyProject.Controller.ProductsController.Post (MyProject) in 451.6596ms
2024-06-12 04:04:19.470 +01:00 [INF] Executed endpoint 'MyProject.Controller.ProductsController.Post (MyProject)'
2024-06-12 04:04:19.473 +01:00 [ERR] HTTP POST /api/product responded 500 in 510.2330 ms
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23502: null value in column "TenantId" of relation "Products" violates not-null constraint

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
  Exception data:
    Severity: ERROR
    SqlState: 23502
    MessageText: null value in column "TenantId" of relation "Products" violates not-null constraint
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: Products
    ColumnName: TenantId
    File: execMain.c
    Line: 1974
    Routine: ExecConstraints
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChanges(IList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(StateManager stateManager, Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<>c.<SaveChanges>b__112_0(DbContext _, ValueTuple`2 t)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges()
   at MyProject.Data.AppDbContext.SaveChanges() in C:\Users\ARthur\Desktop\projects\personal\MyProject\Data\AppDbContext .cs:line 36
   at MyProject.Repository.ProductService.CreateProduct(CreateProductRequest request) in C:\Users\ARthur\Desktop\projects\personal\MyProject\Repository\ProductService .cs:line 41
   at MyProject.Controller.ProductsController.Post(CreateProductRequest request) in C:\Users\ARthur\Desktop\projects\personal\MyProject\Controller\ProductsController.cs:line 34
   at lambda_method20(Closure, Object, Object[])
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.SyncActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeNextActionFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2024-06-12 04:04:19.512 +01:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23502: null value in column "TenantId" of relation "Products" violates not-null constraint

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
  Exception data:
    Severity: ERROR
    SqlState: 23502
    MessageText: null value in column "TenantId" of relation "Products" violates not-null constraint
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: Products
    ColumnName: TenantId
    File: execMain.c
    Line: 1974
    Routine: ExecConstraints
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChanges(IList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(StateManager stateManager, Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<>c.<SaveChanges>b__112_0(DbContext _, ValueTuple`2 t)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges()
   at MyProject.Data.AppDbContext.SaveChanges() in C:\Users\ARthur\Desktop\projects\personal\MyProject\Data\AppDbContext .cs:line 36
   at MyProject.Repository.ProductService.CreateProduct(CreateProductRequest request) in C:\Users\ARthur\Desktop\projects\personal\MyProject\Repository\ProductService .cs:line 41
   at MyProject.Controller.ProductsController.Post(CreateProductRequest request) in C:\Users\ARthur\Desktop\projects\personal\MyProject\Controller\ProductsController.cs:line 34
   at lambda_method20(Closure, Object, Object[])
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.SyncActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeNextActionFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at MyProject.Middleware.TenantResolver.InvokeAsync(HttpContext context, ICurrentTenantService currentTenantService) in C:\Users\ARthur\Desktop\projects\personal\MyProject\Middleware\TenantResolver.cs:line 30
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2024-06-12 04:04:19.549 +01:00 [DBG] Connection id "0HN4AHHC7B43E" completed keep alive response.
2024-06-12 04:04:19.556 +01:00 [DBG] 'AppDbContext' disposed.
2024-06-12 04:04:19.566 +01:00 [DBG] Disposing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:04:19.571 +01:00 [DBG] Disposed connection to database 'userservice_db' on server 'tcp://localhost:5432' (5ms).
2024-06-12 04:04:19.575 +01:00 [DBG] 'TenantDbContext' disposed.
2024-06-12 04:04:19.577 +01:00 [DBG] Disposing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:04:19.579 +01:00 [DBG] Disposed connection to database 'userservice_db' on server 'tcp://localhost:5432' (2ms).
2024-06-12 04:04:19.583 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5165/api/product - 500 null text/plain; charset=utf-8 3153.1867ms
2024-06-12 04:06:30.553 +01:00 [DBG] Connection id "0HN4AHHC7B43E" disconnecting.
2024-06-12 04:06:30.565 +01:00 [DBG] Connection id "0HN4AHHC7B43E" stopped.
2024-06-12 04:06:30.574 +01:00 [DBG] Connection id "0HN4AHHC7B43E" sending FIN because: "The Socket transport's send loop completed gracefully."
2024-06-12 04:12:23.982 +01:00 [INF] Application is shutting down...
2024-06-12 04:12:23.985 +01:00 [DBG] Hosting stopping
2024-06-12 04:12:24.002 +01:00 [DBG] Hosting stopped
2024-06-12 04:12:30.936 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2024-06-12 04:12:31.199 +01:00 [DBG] Hosting starting
2024-06-12 04:12:31.292 +01:00 [INF] Now listening on: http://localhost:5165
2024-06-12 04:12:31.305 +01:00 [DBG] Loaded hosting startup assembly MyProject
2024-06-12 04:12:31.308 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2024-06-12 04:12:31.313 +01:00 [INF] Hosting environment: Development
2024-06-12 04:12:31.315 +01:00 [INF] Content root path: C:\Users\ARthur\Desktop\projects\personal\MyProject
2024-06-12 04:12:31.317 +01:00 [DBG] Hosting started
2024-06-12 04:12:36.566 +01:00 [DBG] Connection id "0HN4AHM19C2S7" accepted.
2024-06-12 04:12:36.570 +01:00 [DBG] Connection id "0HN4AHM19C2S7" started.
2024-06-12 04:12:36.613 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5165/api/product - application/json 37
2024-06-12 04:12:36.627 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2024-06-12 04:12:36.665 +01:00 [DBG] 1 candidate(s) found for the request path '/api/product'
2024-06-12 04:12:36.674 +01:00 [DBG] Endpoint 'MyProject.Controller.ProductsController.Post (MyProject)' with route pattern 'api/product' is valid for the request path '/api/product'
2024-06-12 04:12:36.680 +01:00 [DBG] Request matched endpoint 'MyProject.Controller.ProductsController.Post (MyProject)'
2024-06-12 04:12:36.710 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2024-06-12 04:12:36.885 +01:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2024-06-12 04:12:37.884 +01:00 [DBG] Entity Framework Core 8.0.6 initialized 'TenantDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2024-06-12 04:12:38.415 +01:00 [DBG] Compiling query expression: 
'DbSet<Tenant>()
    .Where(x => x.Id == __tenant_0)
    .FirstOrDefault()'
2024-06-12 04:12:38.841 +01:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Tenant>(
    asyncEnumerable: new SingleQueryingEnumerable<Tenant>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Tenant.Id (string) Required PK AfterSave:Throw, 0], [Property: Tenant.Name (string) Required, 1] }
            SELECT TOP(1) t.Id, t.Name
            FROM Tenants AS t
            WHERE t.Id == @__tenant_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Tenant>, 
        MyProject.Data.TenantDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2024-06-12 04:12:38.905 +01:00 [DBG] Creating DbConnection.
2024-06-12 04:12:38.952 +01:00 [DBG] Created DbConnection. (43ms).
2024-06-12 04:12:38.959 +01:00 [DBG] Opening connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:12:39.215 +01:00 [DBG] Opened connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:12:39.221 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-06-12 04:12:39.232 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (6ms).
2024-06-12 04:12:39.244 +01:00 [DBG] Initialized DbCommand for 'ExecuteReader' (23ms).
2024-06-12 04:12:39.259 +01:00 [DBG] Executing DbCommand [Parameters=[@__tenant_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Name"
FROM "Tenants" AS t
WHERE t."Id" = @__tenant_0
LIMIT 1
2024-06-12 04:12:39.361 +01:00 [INF] Executed DbCommand (107ms) [Parameters=[@__tenant_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Name"
FROM "Tenants" AS t
WHERE t."Id" = @__tenant_0
LIMIT 1
2024-06-12 04:12:39.436 +01:00 [DBG] Context 'TenantDbContext' started tracking 'Tenant' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 04:12:39.465 +01:00 [DBG] Closing data reader to 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:12:39.481 +01:00 [DBG] A data reader for 'userservice_db' on server 'tcp://localhost:5432' is being disposed after spending 110ms reading results.
2024-06-12 04:12:39.491 +01:00 [DBG] Closing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:12:39.499 +01:00 [DBG] Closed connection to database 'userservice_db' on server 'tcp://localhost:5432' (8ms).
2024-06-12 04:12:39.503 +01:00 [INF] Tenant from header: Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpRequestHeaders
2024-06-12 04:12:39.504 +01:00 [INF] Tenant from header: beta
2024-06-12 04:12:39.509 +01:00 [WRN] Failed to determine the https port for redirect.
2024-06-12 04:12:39.512 +01:00 [INF] Executing endpoint 'MyProject.Controller.ProductsController.Post (MyProject)'
2024-06-12 04:12:39.535 +01:00 [INF] Route matched with {action = "Post", controller = "Products"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Post(MyProject.DTOs.CreateProductRequest) on controller MyProject.Controller.ProductsController (MyProject).
2024-06-12 04:12:39.540 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2024-06-12 04:12:39.543 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2024-06-12 04:12:39.548 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2024-06-12 04:12:39.551 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2024-06-12 04:12:39.553 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2024-06-12 04:12:39.558 +01:00 [DBG] Executing controller factory for controller MyProject.Controller.ProductsController (MyProject)
2024-06-12 04:12:39.565 +01:00 [DBG] Executed controller factory for controller MyProject.Controller.ProductsController (MyProject)
2024-06-12 04:12:39.576 +01:00 [DBG] Attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest' ...
2024-06-12 04:12:39.582 +01:00 [DBG] Attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest' using the name '' in request data ...
2024-06-12 04:12:39.587 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2024-06-12 04:12:39.616 +01:00 [DBG] Connection id "0HN4AHM19C2S7", Request id "0HN4AHM19C2S7:00000001": started reading request body.
2024-06-12 04:12:39.618 +01:00 [DBG] Connection id "0HN4AHM19C2S7", Request id "0HN4AHM19C2S7:00000001": done reading request body.
2024-06-12 04:12:39.629 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'MyProject.DTOs.CreateProductRequest'
2024-06-12 04:12:39.631 +01:00 [DBG] Done attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest'.
2024-06-12 04:12:39.634 +01:00 [DBG] Done attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest'.
2024-06-12 04:12:39.639 +01:00 [DBG] Attempting to validate the bound parameter 'request' of type 'MyProject.DTOs.CreateProductRequest' ...
2024-06-12 04:12:39.651 +01:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'MyProject.DTOs.CreateProductRequest'.
2024-06-12 04:12:39.770 +01:00 [DBG] Entity Framework Core 8.0.6 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2024-06-12 04:12:39.815 +01:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Product.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 04:12:39.866 +01:00 [DBG] Context 'AppDbContext' started tracking 'Product' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 04:12:39.876 +01:00 [DBG] DetectChanges starting for 'AppDbContext'.
2024-06-12 04:12:39.901 +01:00 [DBG] DetectChanges completed for 'AppDbContext'.
2024-06-12 04:12:39.907 +01:00 [DBG] SaveChanges starting for 'AppDbContext'.
2024-06-12 04:12:39.909 +01:00 [DBG] DetectChanges starting for 'AppDbContext'.
2024-06-12 04:12:39.912 +01:00 [DBG] DetectChanges completed for 'AppDbContext'.
2024-06-12 04:12:40.017 +01:00 [DBG] Creating DbConnection.
2024-06-12 04:12:40.019 +01:00 [DBG] Created DbConnection. (1ms).
2024-06-12 04:12:40.022 +01:00 [DBG] Opening connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:12:40.025 +01:00 [DBG] Opened connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:12:40.029 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-06-12 04:12:40.030 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2024-06-12 04:12:40.033 +01:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2024-06-12 04:12:40.035 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?' (DbType = Decimal), @p2='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Products" ("Name", "Price", "TenantId")
VALUES (@p0, @p1, @p2)
RETURNING "Id";
2024-06-12 04:12:40.050 +01:00 [ERR] Failed executing DbCommand (15ms) [Parameters=[@p0='?', @p1='?' (DbType = Decimal), @p2='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Products" ("Name", "Price", "TenantId")
VALUES (@p0, @p1, @p2)
RETURNING "Id";
2024-06-12 04:12:40.056 +01:00 [DBG] Closing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:12:40.059 +01:00 [DBG] Closed connection to database 'userservice_db' on server 'tcp://localhost:5432' (2ms).
2024-06-12 04:12:40.074 +01:00 [ERR] An exception occurred in the database while saving changes for context type 'MyProject.Data.AppDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23502: null value in column "TenantId" of relation "Products" violates not-null constraint

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
  Exception data:
    Severity: ERROR
    SqlState: 23502
    MessageText: null value in column "TenantId" of relation "Products" violates not-null constraint
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: Products
    ColumnName: TenantId
    File: execMain.c
    Line: 1974
    Routine: ExecConstraints
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChanges(IList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(StateManager stateManager, Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<>c.<SaveChanges>b__112_0(DbContext _, ValueTuple`2 t)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23502: null value in column "TenantId" of relation "Products" violates not-null constraint

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
  Exception data:
    Severity: ERROR
    SqlState: 23502
    MessageText: null value in column "TenantId" of relation "Products" violates not-null constraint
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: Products
    ColumnName: TenantId
    File: execMain.c
    Line: 1974
    Routine: ExecConstraints
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChanges(IList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(StateManager stateManager, Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<>c.<SaveChanges>b__112_0(DbContext _, ValueTuple`2 t)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
2024-06-12 04:12:40.094 +01:00 [INF] Executed action MyProject.Controller.ProductsController.Post (MyProject) in 534.7973ms
2024-06-12 04:12:40.098 +01:00 [INF] Executed endpoint 'MyProject.Controller.ProductsController.Post (MyProject)'
2024-06-12 04:12:40.101 +01:00 [ERR] HTTP POST /api/product responded 500 in 592.5761 ms
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23502: null value in column "TenantId" of relation "Products" violates not-null constraint

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
  Exception data:
    Severity: ERROR
    SqlState: 23502
    MessageText: null value in column "TenantId" of relation "Products" violates not-null constraint
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: Products
    ColumnName: TenantId
    File: execMain.c
    Line: 1974
    Routine: ExecConstraints
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChanges(IList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(StateManager stateManager, Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<>c.<SaveChanges>b__112_0(DbContext _, ValueTuple`2 t)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges()
   at MyProject.Data.AppDbContext.SaveChanges() in C:\Users\ARthur\Desktop\projects\personal\MyProject\Data\AppDbContext.cs:line 36
   at MyProject.Repository.ProductService.CreateProduct(CreateProductRequest request) in C:\Users\ARthur\Desktop\projects\personal\MyProject\Repository\ProductService.cs:line 41
   at MyProject.Controller.ProductsController.Post(CreateProductRequest request) in C:\Users\ARthur\Desktop\projects\personal\MyProject\Controller\ProductsController.cs:line 34
   at lambda_method20(Closure, Object, Object[])
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.SyncActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeNextActionFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2024-06-12 04:12:40.137 +01:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23502: null value in column "TenantId" of relation "Products" violates not-null constraint

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
  Exception data:
    Severity: ERROR
    SqlState: 23502
    MessageText: null value in column "TenantId" of relation "Products" violates not-null constraint
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: Products
    ColumnName: TenantId
    File: execMain.c
    Line: 1974
    Routine: ExecConstraints
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChanges(IList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(StateManager stateManager, Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<>c.<SaveChanges>b__112_0(DbContext _, ValueTuple`2 t)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges()
   at MyProject.Data.AppDbContext.SaveChanges() in C:\Users\ARthur\Desktop\projects\personal\MyProject\Data\AppDbContext.cs:line 36
   at MyProject.Repository.ProductService.CreateProduct(CreateProductRequest request) in C:\Users\ARthur\Desktop\projects\personal\MyProject\Repository\ProductService.cs:line 41
   at MyProject.Controller.ProductsController.Post(CreateProductRequest request) in C:\Users\ARthur\Desktop\projects\personal\MyProject\Controller\ProductsController.cs:line 34
   at lambda_method20(Closure, Object, Object[])
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.SyncActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeNextActionFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at MyProject.Middleware.TenantResolver.InvokeAsync(HttpContext context, ICurrentTenantService currentTenantService) in C:\Users\ARthur\Desktop\projects\personal\MyProject\Middleware\TenantResolver.cs:line 30
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2024-06-12 04:12:40.169 +01:00 [DBG] Connection id "0HN4AHM19C2S7" completed keep alive response.
2024-06-12 04:12:40.175 +01:00 [DBG] 'AppDbContext' disposed.
2024-06-12 04:12:40.183 +01:00 [DBG] Disposing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:12:40.189 +01:00 [DBG] Disposed connection to database 'userservice_db' on server 'tcp://localhost:5432' (4ms).
2024-06-12 04:12:40.192 +01:00 [DBG] 'TenantDbContext' disposed.
2024-06-12 04:12:40.194 +01:00 [DBG] Disposing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:12:40.197 +01:00 [DBG] Disposed connection to database 'userservice_db' on server 'tcp://localhost:5432' (2ms).
2024-06-12 04:12:40.200 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5165/api/product - 500 null text/plain; charset=utf-8 3588.2653ms
2024-06-12 04:14:34.370 +01:00 [INF] Application is shutting down...
2024-06-12 04:14:34.372 +01:00 [DBG] Hosting stopping
2024-06-12 04:14:34.400 +01:00 [DBG] Connection id "0HN4AHM19C2S7" disconnecting.
2024-06-12 04:14:34.405 +01:00 [DBG] Connection id "0HN4AHM19C2S7" stopped.
2024-06-12 04:14:34.412 +01:00 [DBG] Connection id "0HN4AHM19C2S7" sending FIN because: "The Socket transport's send loop completed gracefully."
2024-06-12 04:14:34.446 +01:00 [DBG] Hosting stopped
2024-06-12 04:14:42.006 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2024-06-12 04:14:42.245 +01:00 [DBG] Hosting starting
2024-06-12 04:14:42.324 +01:00 [INF] Now listening on: http://localhost:5165
2024-06-12 04:14:42.326 +01:00 [DBG] Loaded hosting startup assembly MyProject
2024-06-12 04:14:42.329 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2024-06-12 04:14:42.331 +01:00 [INF] Hosting environment: Development
2024-06-12 04:14:42.332 +01:00 [INF] Content root path: C:\Users\ARthur\Desktop\projects\personal\MyProject
2024-06-12 04:14:42.334 +01:00 [DBG] Hosting started
2024-06-12 04:14:44.706 +01:00 [DBG] Connection id "0HN4AHN7FDAGM" accepted.
2024-06-12 04:14:44.709 +01:00 [DBG] Connection id "0HN4AHN7FDAGM" started.
2024-06-12 04:14:44.759 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5165/api/product - application/json 37
2024-06-12 04:14:44.772 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2024-06-12 04:14:44.803 +01:00 [DBG] 1 candidate(s) found for the request path '/api/product'
2024-06-12 04:14:44.810 +01:00 [DBG] Endpoint 'MyProject.Controller.ProductsController.Post (MyProject)' with route pattern 'api/product' is valid for the request path '/api/product'
2024-06-12 04:14:44.813 +01:00 [DBG] Request matched endpoint 'MyProject.Controller.ProductsController.Post (MyProject)'
2024-06-12 04:14:44.837 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2024-06-12 04:14:45.060 +01:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2024-06-12 04:14:45.859 +01:00 [DBG] Entity Framework Core 8.0.6 initialized 'TenantDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2024-06-12 04:14:45.929 +01:00 [DBG] Compiling query expression: 
'DbSet<Tenant>()
    .Where(x => x.Id == __tenant_0)
    .FirstOrDefault()'
2024-06-12 04:14:46.181 +01:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Tenant>(
    asyncEnumerable: new SingleQueryingEnumerable<Tenant>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Tenant.Id (string) Required PK AfterSave:Throw, 0], [Property: Tenant.Name (string) Required, 1] }
            SELECT TOP(1) t.Id, t.Name
            FROM Tenants AS t
            WHERE t.Id == @__tenant_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Tenant>, 
        MyProject.Data.TenantDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2024-06-12 04:14:46.241 +01:00 [DBG] Creating DbConnection.
2024-06-12 04:14:46.277 +01:00 [DBG] Created DbConnection. (34ms).
2024-06-12 04:14:46.285 +01:00 [DBG] Opening connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:14:46.543 +01:00 [DBG] Opened connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:14:46.592 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-06-12 04:14:46.607 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (7ms).
2024-06-12 04:14:46.623 +01:00 [DBG] Initialized DbCommand for 'ExecuteReader' (31ms).
2024-06-12 04:14:46.676 +01:00 [DBG] Executing DbCommand [Parameters=[@__tenant_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Name"
FROM "Tenants" AS t
WHERE t."Id" = @__tenant_0
LIMIT 1
2024-06-12 04:14:46.824 +01:00 [INF] Executed DbCommand (151ms) [Parameters=[@__tenant_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Name"
FROM "Tenants" AS t
WHERE t."Id" = @__tenant_0
LIMIT 1
2024-06-12 04:14:46.904 +01:00 [DBG] Context 'TenantDbContext' started tracking 'Tenant' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 04:14:46.929 +01:00 [DBG] Closing data reader to 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:14:46.943 +01:00 [DBG] A data reader for 'userservice_db' on server 'tcp://localhost:5432' is being disposed after spending 102ms reading results.
2024-06-12 04:14:46.951 +01:00 [DBG] Closing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:14:46.958 +01:00 [DBG] Closed connection to database 'userservice_db' on server 'tcp://localhost:5432' (8ms).
2024-06-12 04:14:46.960 +01:00 [INF] Tenant from header: Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpRequestHeaders
2024-06-12 04:14:46.961 +01:00 [INF] Tenant from header: beta
2024-06-12 04:14:46.964 +01:00 [WRN] Failed to determine the https port for redirect.
2024-06-12 04:14:46.967 +01:00 [INF] Executing endpoint 'MyProject.Controller.ProductsController.Post (MyProject)'
2024-06-12 04:14:46.987 +01:00 [INF] Route matched with {action = "Post", controller = "Products"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Post(MyProject.DTOs.CreateProductRequest) on controller MyProject.Controller.ProductsController (MyProject).
2024-06-12 04:14:46.992 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2024-06-12 04:14:46.994 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2024-06-12 04:14:46.997 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2024-06-12 04:14:47.001 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2024-06-12 04:14:47.003 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2024-06-12 04:14:47.008 +01:00 [DBG] Executing controller factory for controller MyProject.Controller.ProductsController (MyProject)
2024-06-12 04:14:47.014 +01:00 [DBG] Executed controller factory for controller MyProject.Controller.ProductsController (MyProject)
2024-06-12 04:14:47.026 +01:00 [DBG] Attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest' ...
2024-06-12 04:14:47.030 +01:00 [DBG] Attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest' using the name '' in request data ...
2024-06-12 04:14:47.037 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2024-06-12 04:14:47.063 +01:00 [DBG] Connection id "0HN4AHN7FDAGM", Request id "0HN4AHN7FDAGM:00000001": started reading request body.
2024-06-12 04:14:47.066 +01:00 [DBG] Connection id "0HN4AHN7FDAGM", Request id "0HN4AHN7FDAGM:00000001": done reading request body.
2024-06-12 04:14:47.078 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'MyProject.DTOs.CreateProductRequest'
2024-06-12 04:14:47.080 +01:00 [DBG] Done attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest'.
2024-06-12 04:14:47.084 +01:00 [DBG] Done attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest'.
2024-06-12 04:14:47.087 +01:00 [DBG] Attempting to validate the bound parameter 'request' of type 'MyProject.DTOs.CreateProductRequest' ...
2024-06-12 04:14:47.096 +01:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'MyProject.DTOs.CreateProductRequest'.
2024-06-12 04:14:47.169 +01:00 [DBG] Entity Framework Core 8.0.6 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2024-06-12 04:14:47.193 +01:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Product.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 04:14:47.224 +01:00 [DBG] Context 'AppDbContext' started tracking 'Product' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 04:14:47.228 +01:00 [DBG] SaveChanges starting for 'AppDbContext'.
2024-06-12 04:14:47.232 +01:00 [DBG] DetectChanges starting for 'AppDbContext'.
2024-06-12 04:14:47.254 +01:00 [DBG] DetectChanges completed for 'AppDbContext'.
2024-06-12 04:14:47.393 +01:00 [DBG] Creating DbConnection.
2024-06-12 04:14:47.394 +01:00 [DBG] Created DbConnection. (1ms).
2024-06-12 04:14:47.396 +01:00 [DBG] Opening connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:14:47.403 +01:00 [DBG] Opened connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:14:47.408 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-06-12 04:14:47.410 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2024-06-12 04:14:47.413 +01:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2024-06-12 04:14:47.419 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?' (DbType = Decimal), @p2='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Products" ("Name", "Price", "TenantId")
VALUES (@p0, @p1, @p2)
RETURNING "Id";
2024-06-12 04:14:47.434 +01:00 [INF] Executed DbCommand (15ms) [Parameters=[@p0='?', @p1='?' (DbType = Decimal), @p2='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Products" ("Name", "Price", "TenantId")
VALUES (@p0, @p1, @p2)
RETURNING "Id";
2024-06-12 04:14:47.457 +01:00 [DBG] The foreign key property 'Product.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2024-06-12 04:14:47.487 +01:00 [DBG] Closing data reader to 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:14:47.489 +01:00 [DBG] A data reader for 'userservice_db' on server 'tcp://localhost:5432' is being disposed after spending 52ms reading results.
2024-06-12 04:14:47.494 +01:00 [DBG] Closing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:14:47.496 +01:00 [DBG] Closed connection to database 'userservice_db' on server 'tcp://localhost:5432' (2ms).
2024-06-12 04:14:47.525 +01:00 [DBG] An entity of type 'Product' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 04:14:47.531 +01:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2024-06-12 04:14:47.542 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2024-06-12 04:14:47.547 +01:00 [DBG] No information found on request to perform content negotiation.
2024-06-12 04:14:47.550 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2024-06-12 04:14:47.552 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2024-06-12 04:14:47.556 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2024-06-12 04:14:47.560 +01:00 [INF] Executing OkObjectResult, writing value of type 'MyProject.Entities.Product'.
2024-06-12 04:14:47.600 +01:00 [INF] Executed action MyProject.Controller.ProductsController.Post (MyProject) in 588.6867ms
2024-06-12 04:14:47.604 +01:00 [INF] Executed endpoint 'MyProject.Controller.ProductsController.Post (MyProject)'
2024-06-12 04:14:47.610 +01:00 [INF] HTTP POST /api/product responded 200 in 643.5543 ms
2024-06-12 04:14:47.618 +01:00 [DBG] Connection id "0HN4AHN7FDAGM" completed keep alive response.
2024-06-12 04:14:47.626 +01:00 [DBG] 'AppDbContext' disposed.
2024-06-12 04:14:47.636 +01:00 [DBG] Disposing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:14:47.642 +01:00 [DBG] Disposed connection to database 'userservice_db' on server 'tcp://localhost:5432' (6ms).
2024-06-12 04:14:47.645 +01:00 [DBG] 'TenantDbContext' disposed.
2024-06-12 04:14:47.646 +01:00 [DBG] Disposing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:14:47.655 +01:00 [DBG] Disposed connection to database 'userservice_db' on server 'tcp://localhost:5432' (8ms).
2024-06-12 04:14:47.658 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5165/api/product - 200 null application/json; charset=utf-8 2899.5124ms
2024-06-12 04:16:58.918 +01:00 [DBG] Connection id "0HN4AHN7FDAGM" disconnecting.
2024-06-12 04:16:58.923 +01:00 [DBG] Connection id "0HN4AHN7FDAGM" stopped.
2024-06-12 04:16:58.928 +01:00 [DBG] Connection id "0HN4AHN7FDAGM" sending FIN because: "The Socket transport's send loop completed gracefully."
2024-06-12 04:23:31.208 +01:00 [INF] Application is shutting down...
2024-06-12 04:23:31.210 +01:00 [DBG] Hosting stopping
2024-06-12 04:23:31.239 +01:00 [DBG] Hosting stopped
2024-06-12 04:23:41.538 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2024-06-12 04:23:42.873 +01:00 [DBG] Hosting starting
2024-06-12 04:23:43.001 +01:00 [INF] Now listening on: http://localhost:5165
2024-06-12 04:23:43.004 +01:00 [DBG] Loaded hosting startup assembly MyProject
2024-06-12 04:23:43.008 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2024-06-12 04:23:43.014 +01:00 [INF] Hosting environment: Development
2024-06-12 04:23:43.017 +01:00 [INF] Content root path: C:\Users\ARthur\Desktop\projects\personal\MyProject
2024-06-12 04:23:43.021 +01:00 [DBG] Hosting started
2024-06-12 04:23:47.889 +01:00 [DBG] Connection id "0HN4AHS9BJDB6" accepted.
2024-06-12 04:23:47.897 +01:00 [DBG] Connection id "0HN4AHS9BJDB6" started.
2024-06-12 04:23:47.976 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5165/api/product - application/json 37
2024-06-12 04:23:47.999 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2024-06-12 04:23:48.349 +01:00 [DBG] 1 candidate(s) found for the request path '/api/product'
2024-06-12 04:23:48.542 +01:00 [DBG] Endpoint 'MyProject.Controller.ProductsController.Post (MyProject)' with route pattern 'api/product' is valid for the request path '/api/product'
2024-06-12 04:23:48.547 +01:00 [DBG] Request matched endpoint 'MyProject.Controller.ProductsController.Post (MyProject)'
2024-06-12 04:23:48.589 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2024-06-12 04:23:48.855 +01:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2024-06-12 04:23:50.229 +01:00 [DBG] Entity Framework Core 8.0.6 initialized 'TenantDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2024-06-12 04:23:50.379 +01:00 [DBG] Compiling query expression: 
'DbSet<Tenant>()
    .Where(x => x.Id == __tenant_0)
    .FirstOrDefault()'
2024-06-12 04:23:51.131 +01:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Tenant>(
    asyncEnumerable: new SingleQueryingEnumerable<Tenant>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Tenant.Id (string) Required PK AfterSave:Throw, 0], [Property: Tenant.Name (string) Required, 1] }
            SELECT TOP(1) t.Id, t.Name
            FROM Tenants AS t
            WHERE t.Id == @__tenant_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Tenant>, 
        MyProject.Data.TenantDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2024-06-12 04:23:51.450 +01:00 [DBG] Creating DbConnection.
2024-06-12 04:23:51.610 +01:00 [DBG] Created DbConnection. (156ms).
2024-06-12 04:23:51.650 +01:00 [DBG] Opening connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:23:52.072 +01:00 [DBG] Opened connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:23:52.093 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-06-12 04:23:52.116 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (22ms).
2024-06-12 04:23:52.137 +01:00 [DBG] Initialized DbCommand for 'ExecuteReader' (48ms).
2024-06-12 04:23:52.161 +01:00 [DBG] Executing DbCommand [Parameters=[@__tenant_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Name"
FROM "Tenants" AS t
WHERE t."Id" = @__tenant_0
LIMIT 1
2024-06-12 04:23:52.338 +01:00 [INF] Executed DbCommand (167ms) [Parameters=[@__tenant_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Name"
FROM "Tenants" AS t
WHERE t."Id" = @__tenant_0
LIMIT 1
2024-06-12 04:23:52.466 +01:00 [DBG] Context 'TenantDbContext' started tracking 'Tenant' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 04:23:52.515 +01:00 [DBG] Closing data reader to 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:23:52.542 +01:00 [DBG] A data reader for 'userservice_db' on server 'tcp://localhost:5432' is being disposed after spending 184ms reading results.
2024-06-12 04:23:52.554 +01:00 [DBG] Closing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:23:52.566 +01:00 [DBG] Closed connection to database 'userservice_db' on server 'tcp://localhost:5432' (13ms).
2024-06-12 04:23:52.573 +01:00 [INF] Tenant from header: MyProject.Entities.Tenant
2024-06-12 04:23:52.575 +01:00 [INF] Tenant from header: beta
2024-06-12 04:23:52.581 +01:00 [WRN] Failed to determine the https port for redirect.
2024-06-12 04:23:52.585 +01:00 [INF] Executing endpoint 'MyProject.Controller.ProductsController.Post (MyProject)'
2024-06-12 04:23:52.621 +01:00 [INF] Route matched with {action = "Post", controller = "Products"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Post(MyProject.DTOs.CreateProductRequest) on controller MyProject.Controller.ProductsController (MyProject).
2024-06-12 04:23:52.629 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2024-06-12 04:23:52.632 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2024-06-12 04:23:52.640 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2024-06-12 04:23:52.645 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2024-06-12 04:23:52.648 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2024-06-12 04:23:52.656 +01:00 [DBG] Executing controller factory for controller MyProject.Controller.ProductsController (MyProject)
2024-06-12 04:23:52.665 +01:00 [DBG] Executed controller factory for controller MyProject.Controller.ProductsController (MyProject)
2024-06-12 04:23:52.681 +01:00 [DBG] Attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest' ...
2024-06-12 04:23:52.690 +01:00 [DBG] Attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest' using the name '' in request data ...
2024-06-12 04:23:52.696 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2024-06-12 04:23:52.746 +01:00 [DBG] Connection id "0HN4AHS9BJDB6", Request id "0HN4AHS9BJDB6:00000001": started reading request body.
2024-06-12 04:23:52.749 +01:00 [DBG] Connection id "0HN4AHS9BJDB6", Request id "0HN4AHS9BJDB6:00000001": done reading request body.
2024-06-12 04:23:52.765 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'MyProject.DTOs.CreateProductRequest'
2024-06-12 04:23:52.771 +01:00 [DBG] Done attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest'.
2024-06-12 04:23:52.774 +01:00 [DBG] Done attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest'.
2024-06-12 04:23:52.777 +01:00 [DBG] Attempting to validate the bound parameter 'request' of type 'MyProject.DTOs.CreateProductRequest' ...
2024-06-12 04:23:52.796 +01:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'MyProject.DTOs.CreateProductRequest'.
2024-06-12 04:23:52.936 +01:00 [DBG] Entity Framework Core 8.0.6 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2024-06-12 04:23:52.983 +01:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Product.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 04:23:53.049 +01:00 [DBG] Context 'AppDbContext' started tracking 'Product' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 04:23:53.061 +01:00 [DBG] DetectChanges starting for 'AppDbContext'.
2024-06-12 04:23:53.095 +01:00 [DBG] DetectChanges completed for 'AppDbContext'.
2024-06-12 04:23:53.107 +01:00 [DBG] SaveChanges starting for 'AppDbContext'.
2024-06-12 04:23:53.110 +01:00 [DBG] DetectChanges starting for 'AppDbContext'.
2024-06-12 04:23:53.113 +01:00 [DBG] DetectChanges completed for 'AppDbContext'.
2024-06-12 04:23:53.303 +01:00 [DBG] Creating DbConnection.
2024-06-12 04:23:53.306 +01:00 [DBG] Created DbConnection. (3ms).
2024-06-12 04:23:53.311 +01:00 [DBG] Opening connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:23:53.315 +01:00 [DBG] Opened connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:23:53.325 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-06-12 04:23:53.327 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2024-06-12 04:23:53.331 +01:00 [DBG] Initialized DbCommand for 'ExecuteReader' (6ms).
2024-06-12 04:23:53.337 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?' (DbType = Decimal), @p2='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Products" ("Name", "Price", "TenantId")
VALUES (@p0, @p1, @p2)
RETURNING "Id";
2024-06-12 04:23:53.359 +01:00 [INF] Executed DbCommand (22ms) [Parameters=[@p0='?', @p1='?' (DbType = Decimal), @p2='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Products" ("Name", "Price", "TenantId")
VALUES (@p0, @p1, @p2)
RETURNING "Id";
2024-06-12 04:23:53.392 +01:00 [DBG] The foreign key property 'Product.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2024-06-12 04:23:53.407 +01:00 [DBG] Closing data reader to 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:23:53.411 +01:00 [DBG] A data reader for 'userservice_db' on server 'tcp://localhost:5432' is being disposed after spending 47ms reading results.
2024-06-12 04:23:53.417 +01:00 [DBG] Closing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:23:53.421 +01:00 [DBG] Closed connection to database 'userservice_db' on server 'tcp://localhost:5432' (4ms).
2024-06-12 04:23:53.447 +01:00 [DBG] An entity of type 'Product' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 04:23:53.455 +01:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2024-06-12 04:23:53.462 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2024-06-12 04:23:53.470 +01:00 [DBG] No information found on request to perform content negotiation.
2024-06-12 04:23:53.472 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2024-06-12 04:23:53.475 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2024-06-12 04:23:53.479 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2024-06-12 04:23:53.484 +01:00 [INF] Executing OkObjectResult, writing value of type 'MyProject.Entities.Product'.
2024-06-12 04:23:53.529 +01:00 [INF] Executed action MyProject.Controller.ProductsController.Post (MyProject) in 869.6005ms
2024-06-12 04:23:53.534 +01:00 [INF] Executed endpoint 'MyProject.Controller.ProductsController.Post (MyProject)'
2024-06-12 04:23:53.541 +01:00 [INF] HTTP POST /api/product responded 200 in 958.4782 ms
2024-06-12 04:23:53.552 +01:00 [DBG] Connection id "0HN4AHS9BJDB6" completed keep alive response.
2024-06-12 04:23:53.560 +01:00 [DBG] 'AppDbContext' disposed.
2024-06-12 04:23:53.575 +01:00 [DBG] Disposing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:23:53.581 +01:00 [DBG] Disposed connection to database 'userservice_db' on server 'tcp://localhost:5432' (6ms).
2024-06-12 04:23:53.588 +01:00 [DBG] 'TenantDbContext' disposed.
2024-06-12 04:23:53.591 +01:00 [DBG] Disposing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:23:53.594 +01:00 [DBG] Disposed connection to database 'userservice_db' on server 'tcp://localhost:5432' (3ms).
2024-06-12 04:23:53.599 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5165/api/product - 200 null application/json; charset=utf-8 5629.0547ms
2024-06-12 04:26:04.226 +01:00 [DBG] Connection id "0HN4AHS9BJDB6" disconnecting.
2024-06-12 04:26:04.230 +01:00 [DBG] Connection id "0HN4AHS9BJDB6" stopped.
2024-06-12 04:26:04.233 +01:00 [DBG] Connection id "0HN4AHS9BJDB6" sending FIN because: "The Socket transport's send loop completed gracefully."
2024-06-12 04:26:08.083 +01:00 [INF] Application is shutting down...
2024-06-12 04:26:08.086 +01:00 [DBG] Hosting stopping
2024-06-12 04:26:08.101 +01:00 [DBG] Hosting stopped
2024-06-12 04:26:54.000 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2024-06-12 04:26:54.225 +01:00 [DBG] Hosting starting
2024-06-12 04:26:54.339 +01:00 [INF] Now listening on: http://localhost:5165
2024-06-12 04:26:54.345 +01:00 [DBG] Loaded hosting startup assembly MyProject
2024-06-12 04:26:54.350 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2024-06-12 04:26:54.355 +01:00 [INF] Hosting environment: Development
2024-06-12 04:26:54.357 +01:00 [INF] Content root path: C:\Users\ARthur\Desktop\projects\personal\MyProject
2024-06-12 04:26:54.359 +01:00 [DBG] Hosting started
2024-06-12 04:27:00.885 +01:00 [DBG] Connection id "0HN4AHU2S55K6" accepted.
2024-06-12 04:27:01.344 +01:00 [DBG] Connection id "0HN4AHU2S55K6" started.
2024-06-12 04:27:01.442 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5165/api/product - application/json 37
2024-06-12 04:27:01.465 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2024-06-12 04:27:01.534 +01:00 [DBG] 1 candidate(s) found for the request path '/api/product'
2024-06-12 04:27:01.546 +01:00 [DBG] Endpoint 'MyProject.Controller.ProductsController.Get (MyProject)' with route pattern 'api/product' is valid for the request path '/api/product'
2024-06-12 04:27:01.553 +01:00 [DBG] Request matched endpoint 'MyProject.Controller.ProductsController.Get (MyProject)'
2024-06-12 04:27:01.634 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2024-06-12 04:27:01.886 +01:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2024-06-12 04:27:03.012 +01:00 [DBG] Entity Framework Core 8.0.6 initialized 'TenantDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2024-06-12 04:27:03.127 +01:00 [DBG] Compiling query expression: 
'DbSet<Tenant>()
    .Where(x => x.Id == __tenant_0)
    .FirstOrDefault()'
2024-06-12 04:27:03.680 +01:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Tenant>(
    asyncEnumerable: new SingleQueryingEnumerable<Tenant>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Tenant.Id (string) Required PK AfterSave:Throw, 0], [Property: Tenant.Name (string) Required, 1] }
            SELECT TOP(1) t.Id, t.Name
            FROM Tenants AS t
            WHERE t.Id == @__tenant_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Tenant>, 
        MyProject.Data.TenantDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2024-06-12 04:27:03.913 +01:00 [DBG] Creating DbConnection.
2024-06-12 04:27:03.991 +01:00 [DBG] Created DbConnection. (76ms).
2024-06-12 04:27:04.008 +01:00 [DBG] Opening connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:27:04.429 +01:00 [DBG] Opened connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:27:04.440 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-06-12 04:27:04.454 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (10ms).
2024-06-12 04:27:04.466 +01:00 [DBG] Initialized DbCommand for 'ExecuteReader' (27ms).
2024-06-12 04:27:04.488 +01:00 [DBG] Executing DbCommand [Parameters=[@__tenant_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Name"
FROM "Tenants" AS t
WHERE t."Id" = @__tenant_0
LIMIT 1
2024-06-12 04:27:04.617 +01:00 [INF] Executed DbCommand (132ms) [Parameters=[@__tenant_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Name"
FROM "Tenants" AS t
WHERE t."Id" = @__tenant_0
LIMIT 1
2024-06-12 04:27:04.741 +01:00 [DBG] Context 'TenantDbContext' started tracking 'Tenant' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 04:27:04.793 +01:00 [DBG] Closing data reader to 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:27:04.815 +01:00 [DBG] A data reader for 'userservice_db' on server 'tcp://localhost:5432' is being disposed after spending 181ms reading results.
2024-06-12 04:27:04.826 +01:00 [DBG] Closing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:27:04.840 +01:00 [DBG] Closed connection to database 'userservice_db' on server 'tcp://localhost:5432' (13ms).
2024-06-12 04:27:04.847 +01:00 [INF] Tenant from header: MyProject.Entities.Tenant
2024-06-12 04:27:04.848 +01:00 [INF] Tenant from header: beta
2024-06-12 04:27:04.853 +01:00 [WRN] Failed to determine the https port for redirect.
2024-06-12 04:27:04.857 +01:00 [INF] Executing endpoint 'MyProject.Controller.ProductsController.Get (MyProject)'
2024-06-12 04:27:04.882 +01:00 [INF] Route matched with {action = "Get", controller = "Products"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Get() on controller MyProject.Controller.ProductsController (MyProject).
2024-06-12 04:27:04.889 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2024-06-12 04:27:04.896 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2024-06-12 04:27:04.902 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2024-06-12 04:27:04.906 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2024-06-12 04:27:04.913 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2024-06-12 04:27:04.919 +01:00 [DBG] Executing controller factory for controller MyProject.Controller.ProductsController (MyProject)
2024-06-12 04:27:04.928 +01:00 [DBG] Executed controller factory for controller MyProject.Controller.ProductsController (MyProject)
2024-06-12 04:27:05.022 +01:00 [DBG] Entity Framework Core 8.0.6 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2024-06-12 04:27:05.033 +01:00 [DBG] Compiling query expression: 
'DbSet<Product>()'
2024-06-12 04:27:05.054 +01:00 [DBG] Generated query execution expression: 
'queryContext => 
{
    queryContext.AddParameter(
        name: "__ef_filter__CurrentTenantId_0", 
        value: (object)Invoke(queryContext => ((AppDbContext)queryContext.Context).CurrentTenantId, queryContext));
    return new SingleQueryingEnumerable<Product>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Product.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Product.Name (string) Required, 1], [Property: Product.Price (decimal) Required, 2], [Property: Product.TenantId (string) Required, 3] }
            SELECT p.Id, p.Name, p.Price, p.TenantId
            FROM Products AS p
            WHERE p.TenantId == @__ef_filter__CurrentTenantId_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Product>, 
        MyProject.Data.AppDbContext, 
        False, 
        False, 
        True
    );
}'
2024-06-12 04:27:05.068 +01:00 [DBG] Creating DbConnection.
2024-06-12 04:27:05.070 +01:00 [DBG] Created DbConnection. (2ms).
2024-06-12 04:27:05.073 +01:00 [DBG] Opening connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:27:05.081 +01:00 [DBG] Opened connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:27:05.084 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-06-12 04:27:05.086 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2024-06-12 04:27:05.089 +01:00 [DBG] Initialized DbCommand for 'ExecuteReader' (5ms).
2024-06-12 04:27:05.094 +01:00 [DBG] Executing DbCommand [Parameters=[@__ef_filter__CurrentTenantId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT p."Id", p."Name", p."Price", p."TenantId"
FROM "Products" AS p
WHERE p."TenantId" = @__ef_filter__CurrentTenantId_0
2024-06-12 04:27:05.105 +01:00 [INF] Executed DbCommand (11ms) [Parameters=[@__ef_filter__CurrentTenantId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT p."Id", p."Name", p."Price", p."TenantId"
FROM "Products" AS p
WHERE p."TenantId" = @__ef_filter__CurrentTenantId_0
2024-06-12 04:27:05.134 +01:00 [DBG] Context 'AppDbContext' started tracking 'Product' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 04:27:05.155 +01:00 [DBG] Context 'AppDbContext' started tracking 'Product' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 04:27:05.160 +01:00 [DBG] Closing data reader to 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:27:05.163 +01:00 [DBG] A data reader for 'userservice_db' on server 'tcp://localhost:5432' is being disposed after spending 53ms reading results.
2024-06-12 04:27:05.167 +01:00 [DBG] Closing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:27:05.170 +01:00 [DBG] Closed connection to database 'userservice_db' on server 'tcp://localhost:5432' (2ms).
2024-06-12 04:27:05.177 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2024-06-12 04:27:05.184 +01:00 [DBG] No information found on request to perform content negotiation.
2024-06-12 04:27:05.186 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2024-06-12 04:27:05.187 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2024-06-12 04:27:05.190 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2024-06-12 04:27:05.194 +01:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[MyProject.Entities.Product, MyProject, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2024-06-12 04:27:05.266 +01:00 [INF] Executed action MyProject.Controller.ProductsController.Get (MyProject) in 341.9033ms
2024-06-12 04:27:05.270 +01:00 [INF] Executed endpoint 'MyProject.Controller.ProductsController.Get (MyProject)'
2024-06-12 04:27:05.278 +01:00 [INF] HTTP GET /api/product responded 200 in 421.2467 ms
2024-06-12 04:27:05.288 +01:00 [DBG] Connection id "0HN4AHU2S55K6" completed keep alive response.
2024-06-12 04:27:05.297 +01:00 [DBG] 'AppDbContext' disposed.
2024-06-12 04:27:05.314 +01:00 [DBG] Disposing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:27:05.330 +01:00 [DBG] Disposed connection to database 'userservice_db' on server 'tcp://localhost:5432' (17ms).
2024-06-12 04:27:05.337 +01:00 [DBG] 'TenantDbContext' disposed.
2024-06-12 04:27:05.339 +01:00 [DBG] Disposing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:27:05.349 +01:00 [DBG] Disposed connection to database 'userservice_db' on server 'tcp://localhost:5432' (9ms).
2024-06-12 04:27:05.354 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5165/api/product - 200 null application/json; charset=utf-8 3914.6757ms
2024-06-12 04:27:05.367 +01:00 [DBG] Connection id "0HN4AHU2S55K6", Request id "0HN4AHU2S55K6:00000001": started reading request body.
2024-06-12 04:27:05.371 +01:00 [DBG] Connection id "0HN4AHU2S55K6", Request id "0HN4AHU2S55K6:00000001": done reading request body.
2024-06-12 04:27:41.702 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5165/api/product - application/json 37
2024-06-12 04:27:41.709 +01:00 [DBG] 1 candidate(s) found for the request path '/api/product'
2024-06-12 04:27:41.713 +01:00 [DBG] Endpoint 'MyProject.Controller.ProductsController.Post (MyProject)' with route pattern 'api/product' is valid for the request path '/api/product'
2024-06-12 04:27:41.720 +01:00 [DBG] Request matched endpoint 'MyProject.Controller.ProductsController.Post (MyProject)'
2024-06-12 04:27:41.725 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2024-06-12 04:27:41.868 +01:00 [DBG] Entity Framework Core 8.0.6 initialized 'TenantDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2024-06-12 04:27:41.889 +01:00 [DBG] Creating DbConnection.
2024-06-12 04:27:41.891 +01:00 [DBG] Created DbConnection. (2ms).
2024-06-12 04:27:41.894 +01:00 [DBG] Opening connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:27:41.902 +01:00 [DBG] Opened connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:27:41.906 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-06-12 04:27:41.908 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2024-06-12 04:27:41.911 +01:00 [DBG] Initialized DbCommand for 'ExecuteReader' (5ms).
2024-06-12 04:27:41.919 +01:00 [DBG] Executing DbCommand [Parameters=[@__tenant_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Name"
FROM "Tenants" AS t
WHERE t."Id" = @__tenant_0
LIMIT 1
2024-06-12 04:27:41.937 +01:00 [INF] Executed DbCommand (18ms) [Parameters=[@__tenant_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Name"
FROM "Tenants" AS t
WHERE t."Id" = @__tenant_0
LIMIT 1
2024-06-12 04:27:41.942 +01:00 [DBG] Context 'TenantDbContext' started tracking 'Tenant' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 04:27:41.948 +01:00 [DBG] Closing data reader to 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:27:41.957 +01:00 [DBG] A data reader for 'userservice_db' on server 'tcp://localhost:5432' is being disposed after spending 15ms reading results.
2024-06-12 04:27:41.959 +01:00 [DBG] Closing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:27:41.962 +01:00 [DBG] Closed connection to database 'userservice_db' on server 'tcp://localhost:5432' (2ms).
2024-06-12 04:27:41.969 +01:00 [INF] Tenant from header: MyProject.Entities.Tenant
2024-06-12 04:27:41.971 +01:00 [INF] Tenant from header: beta
2024-06-12 04:27:41.974 +01:00 [INF] Executing endpoint 'MyProject.Controller.ProductsController.Post (MyProject)'
2024-06-12 04:27:41.994 +01:00 [INF] Route matched with {action = "Post", controller = "Products"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Post(MyProject.DTOs.CreateProductRequest) on controller MyProject.Controller.ProductsController (MyProject).
2024-06-12 04:27:42.002 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2024-06-12 04:27:42.006 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2024-06-12 04:27:42.009 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2024-06-12 04:27:42.017 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2024-06-12 04:27:42.021 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2024-06-12 04:27:42.024 +01:00 [DBG] Executing controller factory for controller MyProject.Controller.ProductsController (MyProject)
2024-06-12 04:27:42.027 +01:00 [DBG] Executed controller factory for controller MyProject.Controller.ProductsController (MyProject)
2024-06-12 04:27:42.045 +01:00 [DBG] Attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest' ...
2024-06-12 04:27:42.066 +01:00 [DBG] Attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest' using the name '' in request data ...
2024-06-12 04:27:42.072 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2024-06-12 04:27:42.152 +01:00 [DBG] Connection id "0HN4AHU2S55K6", Request id "0HN4AHU2S55K6:00000002": started reading request body.
2024-06-12 04:27:42.218 +01:00 [DBG] Connection id "0HN4AHU2S55K6", Request id "0HN4AHU2S55K6:00000002": done reading request body.
2024-06-12 04:27:42.233 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'MyProject.DTOs.CreateProductRequest'
2024-06-12 04:27:42.236 +01:00 [DBG] Done attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest'.
2024-06-12 04:27:42.237 +01:00 [DBG] Done attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest'.
2024-06-12 04:27:42.239 +01:00 [DBG] Attempting to validate the bound parameter 'request' of type 'MyProject.DTOs.CreateProductRequest' ...
2024-06-12 04:27:42.261 +01:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'MyProject.DTOs.CreateProductRequest'.
2024-06-12 04:27:42.273 +01:00 [DBG] Entity Framework Core 8.0.6 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2024-06-12 04:27:42.322 +01:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Product.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 04:27:42.349 +01:00 [DBG] Context 'AppDbContext' started tracking 'Product' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 04:27:42.358 +01:00 [DBG] DetectChanges starting for 'AppDbContext'.
2024-06-12 04:27:42.407 +01:00 [DBG] DetectChanges completed for 'AppDbContext'.
2024-06-12 04:27:42.418 +01:00 [DBG] SaveChanges starting for 'AppDbContext'.
2024-06-12 04:27:42.421 +01:00 [DBG] DetectChanges starting for 'AppDbContext'.
2024-06-12 04:27:42.422 +01:00 [DBG] DetectChanges completed for 'AppDbContext'.
2024-06-12 04:27:42.592 +01:00 [DBG] Creating DbConnection.
2024-06-12 04:27:42.871 +01:00 [DBG] Created DbConnection. (279ms).
2024-06-12 04:27:42.885 +01:00 [DBG] Opening connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:27:42.888 +01:00 [DBG] Opened connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:27:42.893 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-06-12 04:27:42.897 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (4ms).
2024-06-12 04:27:42.902 +01:00 [DBG] Initialized DbCommand for 'ExecuteReader' (9ms).
2024-06-12 04:27:42.905 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?' (DbType = Decimal), @p2='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Products" ("Name", "Price", "TenantId")
VALUES (@p0, @p1, @p2)
RETURNING "Id";
2024-06-12 04:27:42.920 +01:00 [INF] Executed DbCommand (15ms) [Parameters=[@p0='?', @p1='?' (DbType = Decimal), @p2='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Products" ("Name", "Price", "TenantId")
VALUES (@p0, @p1, @p2)
RETURNING "Id";
2024-06-12 04:27:42.945 +01:00 [DBG] The foreign key property 'Product.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2024-06-12 04:27:42.963 +01:00 [DBG] Closing data reader to 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:27:42.999 +01:00 [DBG] A data reader for 'userservice_db' on server 'tcp://localhost:5432' is being disposed after spending 74ms reading results.
2024-06-12 04:27:43.003 +01:00 [DBG] Closing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:27:43.024 +01:00 [DBG] Closed connection to database 'userservice_db' on server 'tcp://localhost:5432' (20ms).
2024-06-12 04:27:43.059 +01:00 [DBG] An entity of type 'Product' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 04:27:43.187 +01:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2024-06-12 04:27:43.578 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2024-06-12 04:27:43.727 +01:00 [DBG] No information found on request to perform content negotiation.
2024-06-12 04:27:43.732 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2024-06-12 04:27:43.749 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2024-06-12 04:27:43.795 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2024-06-12 04:27:43.801 +01:00 [INF] Executing OkObjectResult, writing value of type 'MyProject.Entities.Product'.
2024-06-12 04:27:43.826 +01:00 [INF] Executed action MyProject.Controller.ProductsController.Post (MyProject) in 1801.9811ms
2024-06-12 04:27:43.893 +01:00 [INF] Executed endpoint 'MyProject.Controller.ProductsController.Post (MyProject)'
2024-06-12 04:27:43.898 +01:00 [INF] HTTP POST /api/product responded 200 in 1923.5151 ms
2024-06-12 04:27:43.903 +01:00 [DBG] Connection id "0HN4AHU2S55K6" completed keep alive response.
2024-06-12 04:27:43.937 +01:00 [DBG] 'AppDbContext' disposed.
2024-06-12 04:27:43.972 +01:00 [DBG] Disposing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:27:43.998 +01:00 [DBG] Disposed connection to database 'userservice_db' on server 'tcp://localhost:5432' (25ms).
2024-06-12 04:27:43.999 +01:00 [DBG] 'TenantDbContext' disposed.
2024-06-12 04:27:44.001 +01:00 [DBG] Disposing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:27:44.002 +01:00 [DBG] Disposed connection to database 'userservice_db' on server 'tcp://localhost:5432' (1ms).
2024-06-12 04:27:44.004 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5165/api/product - 200 null application/json; charset=utf-8 2301.9236ms
2024-06-12 04:29:54.870 +01:00 [DBG] Connection id "0HN4AHU2S55K6" disconnecting.
2024-06-12 04:29:54.882 +01:00 [DBG] Connection id "0HN4AHU2S55K6" stopped.
2024-06-12 04:29:54.893 +01:00 [DBG] Connection id "0HN4AHU2S55K6" sending FIN because: "The Socket transport's send loop completed gracefully."
2024-06-12 04:32:46.707 +01:00 [INF] Application is shutting down...
2024-06-12 04:32:46.710 +01:00 [DBG] Hosting stopping
2024-06-12 04:32:46.724 +01:00 [DBG] Hosting stopped
2024-06-12 04:32:57.276 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2024-06-12 04:32:57.459 +01:00 [DBG] Hosting starting
2024-06-12 04:32:57.549 +01:00 [INF] Now listening on: http://localhost:5165
2024-06-12 04:32:57.552 +01:00 [DBG] Loaded hosting startup assembly MyProject
2024-06-12 04:32:57.555 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2024-06-12 04:32:57.558 +01:00 [INF] Hosting environment: Development
2024-06-12 04:32:57.560 +01:00 [INF] Content root path: C:\Users\ARthur\Desktop\projects\personal\MyProject
2024-06-12 04:32:57.563 +01:00 [DBG] Hosting started
2024-06-12 04:33:10.964 +01:00 [DBG] Connection id "0HN4AI1H5G6Q6" accepted.
2024-06-12 04:33:10.970 +01:00 [DBG] Connection id "0HN4AI1H5G6Q6" started.
2024-06-12 04:33:11.058 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5165/api/product - application/json 37
2024-06-12 04:33:11.121 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2024-06-12 04:33:11.181 +01:00 [DBG] 1 candidate(s) found for the request path '/api/product'
2024-06-12 04:33:11.214 +01:00 [DBG] Endpoint 'MyProject.Controller.ProductsController.Post (MyProject)' with route pattern 'api/product' is valid for the request path '/api/product'
2024-06-12 04:33:11.223 +01:00 [DBG] Request matched endpoint 'MyProject.Controller.ProductsController.Post (MyProject)'
2024-06-12 04:33:11.270 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2024-06-12 04:33:11.593 +01:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2024-06-12 04:33:13.258 +01:00 [DBG] Entity Framework Core 8.0.6 initialized 'TenantDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2024-06-12 04:33:13.401 +01:00 [DBG] Compiling query expression: 
'DbSet<Tenant>()
    .Where(x => x.Id == __tenant_0)
    .FirstOrDefault()'
2024-06-12 04:33:13.912 +01:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Tenant>(
    asyncEnumerable: new SingleQueryingEnumerable<Tenant>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Tenant.Id (string) Required PK AfterSave:Throw, 0], [Property: Tenant.Name (string) Required, 1] }
            SELECT TOP(1) t.Id, t.Name
            FROM Tenants AS t
            WHERE t.Id == @__tenant_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Tenant>, 
        MyProject.Data.TenantDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2024-06-12 04:33:14.060 +01:00 [DBG] Creating DbConnection.
2024-06-12 04:33:14.107 +01:00 [DBG] Created DbConnection. (45ms).
2024-06-12 04:33:14.114 +01:00 [DBG] Opening connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:33:14.403 +01:00 [DBG] Opened connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:33:14.412 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-06-12 04:33:14.422 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (6ms).
2024-06-12 04:33:14.432 +01:00 [DBG] Initialized DbCommand for 'ExecuteReader' (20ms).
2024-06-12 04:33:14.446 +01:00 [DBG] Executing DbCommand [Parameters=[@__tenant_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Name"
FROM "Tenants" AS t
WHERE t."Id" = @__tenant_0
LIMIT 1
2024-06-12 04:33:14.547 +01:00 [INF] Executed DbCommand (101ms) [Parameters=[@__tenant_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Name"
FROM "Tenants" AS t
WHERE t."Id" = @__tenant_0
LIMIT 1
2024-06-12 04:33:14.619 +01:00 [DBG] Context 'TenantDbContext' started tracking 'Tenant' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 04:33:14.648 +01:00 [DBG] Closing data reader to 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:33:14.665 +01:00 [DBG] A data reader for 'userservice_db' on server 'tcp://localhost:5432' is being disposed after spending 104ms reading results.
2024-06-12 04:33:14.675 +01:00 [DBG] Closing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:33:14.684 +01:00 [DBG] Closed connection to database 'userservice_db' on server 'tcp://localhost:5432' (10ms).
2024-06-12 04:33:14.690 +01:00 [INF] Tenant from header: MyProject.Entities.Tenant
2024-06-12 04:33:14.692 +01:00 [INF] Tenant from header: beta
2024-06-12 04:33:14.695 +01:00 [INF] Tenant from header inside: beta
2024-06-12 04:33:14.699 +01:00 [WRN] Failed to determine the https port for redirect.
2024-06-12 04:33:14.703 +01:00 [INF] Executing endpoint 'MyProject.Controller.ProductsController.Post (MyProject)'
2024-06-12 04:33:14.728 +01:00 [INF] Route matched with {action = "Post", controller = "Products"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Post(MyProject.DTOs.CreateProductRequest) on controller MyProject.Controller.ProductsController (MyProject).
2024-06-12 04:33:14.734 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2024-06-12 04:33:14.738 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2024-06-12 04:33:14.745 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2024-06-12 04:33:14.750 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2024-06-12 04:33:14.753 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2024-06-12 04:33:14.759 +01:00 [DBG] Executing controller factory for controller MyProject.Controller.ProductsController (MyProject)
2024-06-12 04:33:14.767 +01:00 [DBG] Executed controller factory for controller MyProject.Controller.ProductsController (MyProject)
2024-06-12 04:33:14.779 +01:00 [DBG] Attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest' ...
2024-06-12 04:33:14.786 +01:00 [DBG] Attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest' using the name '' in request data ...
2024-06-12 04:33:14.795 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2024-06-12 04:33:14.837 +01:00 [DBG] Connection id "0HN4AI1H5G6Q6", Request id "0HN4AI1H5G6Q6:00000001": started reading request body.
2024-06-12 04:33:14.840 +01:00 [DBG] Connection id "0HN4AI1H5G6Q6", Request id "0HN4AI1H5G6Q6:00000001": done reading request body.
2024-06-12 04:33:14.856 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'MyProject.DTOs.CreateProductRequest'
2024-06-12 04:33:14.860 +01:00 [DBG] Done attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest'.
2024-06-12 04:33:14.862 +01:00 [DBG] Done attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest'.
2024-06-12 04:33:14.864 +01:00 [DBG] Attempting to validate the bound parameter 'request' of type 'MyProject.DTOs.CreateProductRequest' ...
2024-06-12 04:33:14.881 +01:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'MyProject.DTOs.CreateProductRequest'.
2024-06-12 04:33:15.000 +01:00 [DBG] Entity Framework Core 8.0.6 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2024-06-12 04:33:15.048 +01:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Product.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 04:33:15.101 +01:00 [DBG] Context 'AppDbContext' started tracking 'Product' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 04:33:15.110 +01:00 [DBG] DetectChanges starting for 'AppDbContext'.
2024-06-12 04:33:15.139 +01:00 [DBG] DetectChanges completed for 'AppDbContext'.
2024-06-12 04:33:15.145 +01:00 [DBG] SaveChanges starting for 'AppDbContext'.
2024-06-12 04:33:15.149 +01:00 [DBG] DetectChanges starting for 'AppDbContext'.
2024-06-12 04:33:15.151 +01:00 [DBG] DetectChanges completed for 'AppDbContext'.
2024-06-12 04:33:15.290 +01:00 [DBG] Creating DbConnection.
2024-06-12 04:33:15.292 +01:00 [DBG] Created DbConnection. (1ms).
2024-06-12 04:33:15.296 +01:00 [DBG] Opening connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:33:15.300 +01:00 [DBG] Opened connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:33:15.307 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-06-12 04:33:15.310 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2024-06-12 04:33:15.314 +01:00 [DBG] Initialized DbCommand for 'ExecuteReader' (6ms).
2024-06-12 04:33:15.317 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?' (DbType = Decimal), @p2='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Products" ("Name", "Price", "TenantId")
VALUES (@p0, @p1, @p2)
RETURNING "Id";
2024-06-12 04:33:15.342 +01:00 [INF] Executed DbCommand (25ms) [Parameters=[@p0='?', @p1='?' (DbType = Decimal), @p2='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Products" ("Name", "Price", "TenantId")
VALUES (@p0, @p1, @p2)
RETURNING "Id";
2024-06-12 04:33:15.376 +01:00 [DBG] The foreign key property 'Product.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2024-06-12 04:33:15.550 +01:00 [DBG] Closing data reader to 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:33:15.553 +01:00 [DBG] A data reader for 'userservice_db' on server 'tcp://localhost:5432' is being disposed after spending 205ms reading results.
2024-06-12 04:33:15.562 +01:00 [DBG] Closing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:33:15.565 +01:00 [DBG] Closed connection to database 'userservice_db' on server 'tcp://localhost:5432' (3ms).
2024-06-12 04:33:15.592 +01:00 [DBG] An entity of type 'Product' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 04:33:15.597 +01:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2024-06-12 04:33:15.602 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2024-06-12 04:33:15.611 +01:00 [DBG] No information found on request to perform content negotiation.
2024-06-12 04:33:15.613 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2024-06-12 04:33:15.615 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2024-06-12 04:33:15.618 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2024-06-12 04:33:15.621 +01:00 [INF] Executing OkObjectResult, writing value of type 'MyProject.Entities.Product'.
2024-06-12 04:33:15.665 +01:00 [INF] Executed action MyProject.Controller.ProductsController.Post (MyProject) in 901.5702ms
2024-06-12 04:33:15.668 +01:00 [INF] Executed endpoint 'MyProject.Controller.ProductsController.Post (MyProject)'
2024-06-12 04:33:15.676 +01:00 [INF] HTTP POST /api/product responded 200 in 973.1005 ms
2024-06-12 04:33:15.685 +01:00 [DBG] Connection id "0HN4AI1H5G6Q6" completed keep alive response.
2024-06-12 04:33:15.695 +01:00 [DBG] 'AppDbContext' disposed.
2024-06-12 04:33:15.708 +01:00 [DBG] Disposing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:33:15.714 +01:00 [DBG] Disposed connection to database 'userservice_db' on server 'tcp://localhost:5432' (8ms).
2024-06-12 04:33:15.718 +01:00 [DBG] 'TenantDbContext' disposed.
2024-06-12 04:33:15.720 +01:00 [DBG] Disposing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:33:15.725 +01:00 [DBG] Disposed connection to database 'userservice_db' on server 'tcp://localhost:5432' (4ms).
2024-06-12 04:33:15.729 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5165/api/product - 200 null application/json; charset=utf-8 4677.492ms
2024-06-12 04:35:27.376 +01:00 [DBG] Connection id "0HN4AI1H5G6Q6" disconnecting.
2024-06-12 04:35:27.386 +01:00 [DBG] Connection id "0HN4AI1H5G6Q6" stopped.
2024-06-12 04:35:27.405 +01:00 [DBG] Connection id "0HN4AI1H5G6Q6" sending FIN because: "The Socket transport's send loop completed gracefully."
2024-06-12 04:36:59.218 +01:00 [INF] Application is shutting down...
2024-06-12 04:36:59.228 +01:00 [DBG] Hosting stopping
2024-06-12 04:36:59.269 +01:00 [DBG] Hosting stopped
2024-06-12 04:37:07.847 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2024-06-12 04:37:08.157 +01:00 [DBG] Hosting starting
2024-06-12 04:37:08.342 +01:00 [INF] Now listening on: http://localhost:5165
2024-06-12 04:37:08.711 +01:00 [DBG] Loaded hosting startup assembly MyProject
2024-06-12 04:37:08.717 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2024-06-12 04:37:08.719 +01:00 [INF] Hosting environment: Development
2024-06-12 04:37:08.721 +01:00 [INF] Content root path: C:\Users\ARthur\Desktop\projects\personal\MyProject
2024-06-12 04:37:08.722 +01:00 [DBG] Hosting started
2024-06-12 04:37:20.753 +01:00 [DBG] Connection id "0HN4AI3RJLTJ0" accepted.
2024-06-12 04:37:20.757 +01:00 [DBG] Connection id "0HN4AI3RJLTJ0" started.
2024-06-12 04:37:20.812 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5165/api/product - application/json 37
2024-06-12 04:37:20.828 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2024-06-12 04:37:20.869 +01:00 [DBG] 1 candidate(s) found for the request path '/api/product'
2024-06-12 04:37:20.880 +01:00 [DBG] Endpoint 'MyProject.Controller.ProductsController.Post (MyProject)' with route pattern 'api/product' is valid for the request path '/api/product'
2024-06-12 04:37:20.884 +01:00 [DBG] Request matched endpoint 'MyProject.Controller.ProductsController.Post (MyProject)'
2024-06-12 04:37:20.914 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2024-06-12 04:37:21.091 +01:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2024-06-12 04:37:22.024 +01:00 [DBG] Entity Framework Core 8.0.6 initialized 'TenantDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2024-06-12 04:37:22.146 +01:00 [DBG] Compiling query expression: 
'DbSet<Tenant>()
    .Where(x => x.Id == __tenant_0)
    .FirstOrDefault()'
2024-06-12 04:37:22.911 +01:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Tenant>(
    asyncEnumerable: new SingleQueryingEnumerable<Tenant>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Tenant.Id (string) Required PK AfterSave:Throw, 0], [Property: Tenant.Name (string) Required, 1] }
            SELECT TOP(1) t.Id, t.Name
            FROM Tenants AS t
            WHERE t.Id == @__tenant_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Tenant>, 
        MyProject.Data.TenantDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2024-06-12 04:37:23.028 +01:00 [DBG] Creating DbConnection.
2024-06-12 04:37:23.074 +01:00 [DBG] Created DbConnection. (42ms).
2024-06-12 04:37:23.082 +01:00 [DBG] Opening connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:37:23.321 +01:00 [DBG] Opened connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:37:23.329 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-06-12 04:37:23.343 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (7ms).
2024-06-12 04:37:23.353 +01:00 [DBG] Initialized DbCommand for 'ExecuteReader' (23ms).
2024-06-12 04:37:23.369 +01:00 [DBG] Executing DbCommand [Parameters=[@__tenant_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Name"
FROM "Tenants" AS t
WHERE t."Id" = @__tenant_0
LIMIT 1
2024-06-12 04:37:23.475 +01:00 [INF] Executed DbCommand (107ms) [Parameters=[@__tenant_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Name"
FROM "Tenants" AS t
WHERE t."Id" = @__tenant_0
LIMIT 1
2024-06-12 04:37:23.557 +01:00 [DBG] Context 'TenantDbContext' started tracking 'Tenant' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 04:37:23.598 +01:00 [DBG] Closing data reader to 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:37:23.617 +01:00 [DBG] A data reader for 'userservice_db' on server 'tcp://localhost:5432' is being disposed after spending 129ms reading results.
2024-06-12 04:37:23.627 +01:00 [DBG] Closing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:37:23.638 +01:00 [DBG] Closed connection to database 'userservice_db' on server 'tcp://localhost:5432' (10ms).
2024-06-12 04:37:23.647 +01:00 [WRN] Failed to determine the https port for redirect.
2024-06-12 04:37:23.651 +01:00 [INF] Executing endpoint 'MyProject.Controller.ProductsController.Post (MyProject)'
2024-06-12 04:37:23.680 +01:00 [INF] Route matched with {action = "Post", controller = "Products"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Post(MyProject.DTOs.CreateProductRequest) on controller MyProject.Controller.ProductsController (MyProject).
2024-06-12 04:37:23.688 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2024-06-12 04:37:23.692 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2024-06-12 04:37:23.697 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2024-06-12 04:37:23.702 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2024-06-12 04:37:23.704 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2024-06-12 04:37:23.712 +01:00 [DBG] Executing controller factory for controller MyProject.Controller.ProductsController (MyProject)
2024-06-12 04:37:23.721 +01:00 [DBG] Executed controller factory for controller MyProject.Controller.ProductsController (MyProject)
2024-06-12 04:37:23.730 +01:00 [DBG] Attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest' ...
2024-06-12 04:37:23.739 +01:00 [DBG] Attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest' using the name '' in request data ...
2024-06-12 04:37:23.745 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2024-06-12 04:37:23.786 +01:00 [DBG] Connection id "0HN4AI3RJLTJ0", Request id "0HN4AI3RJLTJ0:00000001": started reading request body.
2024-06-12 04:37:23.789 +01:00 [DBG] Connection id "0HN4AI3RJLTJ0", Request id "0HN4AI3RJLTJ0:00000001": done reading request body.
2024-06-12 04:37:23.805 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'MyProject.DTOs.CreateProductRequest'
2024-06-12 04:37:23.809 +01:00 [DBG] Done attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest'.
2024-06-12 04:37:23.812 +01:00 [DBG] Done attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest'.
2024-06-12 04:37:23.815 +01:00 [DBG] Attempting to validate the bound parameter 'request' of type 'MyProject.DTOs.CreateProductRequest' ...
2024-06-12 04:37:23.829 +01:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'MyProject.DTOs.CreateProductRequest'.
2024-06-12 04:37:23.931 +01:00 [DBG] Entity Framework Core 8.0.6 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2024-06-12 04:37:23.967 +01:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Product.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 04:37:24.030 +01:00 [DBG] Context 'AppDbContext' started tracking 'Product' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 04:37:24.040 +01:00 [INF] Tenant from header context: beta
2024-06-12 04:37:24.047 +01:00 [DBG] DetectChanges starting for 'AppDbContext'.
2024-06-12 04:37:24.128 +01:00 [DBG] DetectChanges completed for 'AppDbContext'.
2024-06-12 04:37:24.139 +01:00 [DBG] SaveChanges starting for 'AppDbContext'.
2024-06-12 04:37:24.141 +01:00 [DBG] DetectChanges starting for 'AppDbContext'.
2024-06-12 04:37:24.143 +01:00 [DBG] DetectChanges completed for 'AppDbContext'.
2024-06-12 04:37:24.330 +01:00 [DBG] Creating DbConnection.
2024-06-12 04:37:24.332 +01:00 [DBG] Created DbConnection. (2ms).
2024-06-12 04:37:24.339 +01:00 [DBG] Opening connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:37:24.343 +01:00 [DBG] Opened connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:37:24.349 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-06-12 04:37:24.353 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2024-06-12 04:37:24.357 +01:00 [DBG] Initialized DbCommand for 'ExecuteReader' (8ms).
2024-06-12 04:37:24.361 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?' (DbType = Decimal), @p2='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Products" ("Name", "Price", "TenantId")
VALUES (@p0, @p1, @p2)
RETURNING "Id";
2024-06-12 04:37:24.380 +01:00 [INF] Executed DbCommand (20ms) [Parameters=[@p0='?', @p1='?' (DbType = Decimal), @p2='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Products" ("Name", "Price", "TenantId")
VALUES (@p0, @p1, @p2)
RETURNING "Id";
2024-06-12 04:37:24.407 +01:00 [DBG] The foreign key property 'Product.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2024-06-12 04:37:24.419 +01:00 [DBG] Closing data reader to 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:37:24.423 +01:00 [DBG] A data reader for 'userservice_db' on server 'tcp://localhost:5432' is being disposed after spending 35ms reading results.
2024-06-12 04:37:24.428 +01:00 [DBG] Closing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:37:24.431 +01:00 [DBG] Closed connection to database 'userservice_db' on server 'tcp://localhost:5432' (3ms).
2024-06-12 04:37:24.458 +01:00 [DBG] An entity of type 'Product' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 04:37:24.462 +01:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2024-06-12 04:37:24.470 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2024-06-12 04:37:24.477 +01:00 [DBG] No information found on request to perform content negotiation.
2024-06-12 04:37:24.479 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2024-06-12 04:37:24.481 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2024-06-12 04:37:24.485 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2024-06-12 04:37:24.488 +01:00 [INF] Executing OkObjectResult, writing value of type 'MyProject.Entities.Product'.
2024-06-12 04:37:24.529 +01:00 [INF] Executed action MyProject.Controller.ProductsController.Post (MyProject) in 813.6597ms
2024-06-12 04:37:24.533 +01:00 [INF] Executed endpoint 'MyProject.Controller.ProductsController.Post (MyProject)'
2024-06-12 04:37:24.540 +01:00 [INF] HTTP POST /api/product responded 200 in 889.6463 ms
2024-06-12 04:37:24.549 +01:00 [DBG] Connection id "0HN4AI3RJLTJ0" completed keep alive response.
2024-06-12 04:37:24.559 +01:00 [DBG] 'AppDbContext' disposed.
2024-06-12 04:37:24.569 +01:00 [DBG] Disposing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:37:24.575 +01:00 [DBG] Disposed connection to database 'userservice_db' on server 'tcp://localhost:5432' (5ms).
2024-06-12 04:37:24.579 +01:00 [DBG] 'TenantDbContext' disposed.
2024-06-12 04:37:24.582 +01:00 [DBG] Disposing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:37:24.585 +01:00 [DBG] Disposed connection to database 'userservice_db' on server 'tcp://localhost:5432' (3ms).
2024-06-12 04:37:24.590 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5165/api/product - 200 null application/json; charset=utf-8 3780.7967ms
2024-06-12 04:39:35.657 +01:00 [DBG] Connection id "0HN4AI3RJLTJ0" disconnecting.
2024-06-12 04:39:35.701 +01:00 [DBG] Connection id "0HN4AI3RJLTJ0" stopped.
2024-06-12 04:39:35.711 +01:00 [DBG] Connection id "0HN4AI3RJLTJ0" sending FIN because: "The Socket transport's send loop completed gracefully."
2024-06-12 04:41:34.013 +01:00 [INF] Application is shutting down...
2024-06-12 04:41:34.016 +01:00 [DBG] Hosting stopping
2024-06-12 04:41:34.040 +01:00 [DBG] Hosting stopped
2024-06-12 04:41:45.595 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2024-06-12 04:41:46.630 +01:00 [DBG] Hosting starting
2024-06-12 04:41:46.750 +01:00 [INF] Now listening on: http://localhost:5165
2024-06-12 04:41:47.277 +01:00 [DBG] Loaded hosting startup assembly MyProject
2024-06-12 04:41:47.557 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2024-06-12 04:41:47.758 +01:00 [INF] Hosting environment: Development
2024-06-12 04:41:47.761 +01:00 [INF] Content root path: C:\Users\ARthur\Desktop\projects\personal\MyProject
2024-06-12 04:41:47.763 +01:00 [DBG] Hosting started
2024-06-12 04:41:54.894 +01:00 [DBG] Connection id "0HN4AI6DA3051" accepted.
2024-06-12 04:41:54.900 +01:00 [DBG] Connection id "0HN4AI6DA3051" started.
2024-06-12 04:41:54.959 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5165/api/product - application/json 37
2024-06-12 04:41:54.976 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2024-06-12 04:41:55.038 +01:00 [DBG] 1 candidate(s) found for the request path '/api/product'
2024-06-12 04:41:55.217 +01:00 [DBG] Endpoint 'MyProject.Controller.ProductsController.Post (MyProject)' with route pattern 'api/product' is valid for the request path '/api/product'
2024-06-12 04:41:55.221 +01:00 [DBG] Request matched endpoint 'MyProject.Controller.ProductsController.Post (MyProject)'
2024-06-12 04:41:55.258 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2024-06-12 04:41:55.501 +01:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2024-06-12 04:41:56.965 +01:00 [DBG] Entity Framework Core 8.0.6 initialized 'TenantDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2024-06-12 04:41:57.089 +01:00 [DBG] Compiling query expression: 
'DbSet<Tenant>()
    .Where(x => x.Id == __tenant_0)
    .FirstOrDefault()'
2024-06-12 04:41:57.654 +01:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Tenant>(
    asyncEnumerable: new SingleQueryingEnumerable<Tenant>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Tenant.Id (string) Required PK AfterSave:Throw, 0], [Property: Tenant.Name (string) Required, 1] }
            SELECT TOP(1) t.Id, t.Name
            FROM Tenants AS t
            WHERE t.Id == @__tenant_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Tenant>, 
        MyProject.Data.TenantDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2024-06-12 04:41:57.744 +01:00 [DBG] Creating DbConnection.
2024-06-12 04:41:57.805 +01:00 [DBG] Created DbConnection. (59ms).
2024-06-12 04:41:57.817 +01:00 [DBG] Opening connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:41:58.132 +01:00 [DBG] Opened connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:41:58.142 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-06-12 04:41:58.155 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (9ms).
2024-06-12 04:41:58.165 +01:00 [DBG] Initialized DbCommand for 'ExecuteReader' (24ms).
2024-06-12 04:41:58.181 +01:00 [DBG] Executing DbCommand [Parameters=[@__tenant_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Name"
FROM "Tenants" AS t
WHERE t."Id" = @__tenant_0
LIMIT 1
2024-06-12 04:41:58.288 +01:00 [INF] Executed DbCommand (107ms) [Parameters=[@__tenant_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Name"
FROM "Tenants" AS t
WHERE t."Id" = @__tenant_0
LIMIT 1
2024-06-12 04:41:58.363 +01:00 [DBG] Context 'TenantDbContext' started tracking 'Tenant' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 04:41:58.397 +01:00 [DBG] Closing data reader to 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:41:58.415 +01:00 [DBG] A data reader for 'userservice_db' on server 'tcp://localhost:5432' is being disposed after spending 111ms reading results.
2024-06-12 04:41:58.424 +01:00 [DBG] Closing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:41:58.435 +01:00 [DBG] Closed connection to database 'userservice_db' on server 'tcp://localhost:5432' (11ms).
2024-06-12 04:41:58.444 +01:00 [WRN] Failed to determine the https port for redirect.
2024-06-12 04:41:58.447 +01:00 [INF] Executing endpoint 'MyProject.Controller.ProductsController.Post (MyProject)'
2024-06-12 04:41:58.471 +01:00 [INF] Route matched with {action = "Post", controller = "Products"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Post(MyProject.DTOs.CreateProductRequest) on controller MyProject.Controller.ProductsController (MyProject).
2024-06-12 04:41:58.479 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2024-06-12 04:41:58.483 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2024-06-12 04:41:58.488 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2024-06-12 04:41:58.491 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2024-06-12 04:41:58.494 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2024-06-12 04:41:58.502 +01:00 [DBG] Executing controller factory for controller MyProject.Controller.ProductsController (MyProject)
2024-06-12 04:41:58.515 +01:00 [DBG] Executed controller factory for controller MyProject.Controller.ProductsController (MyProject)
2024-06-12 04:41:58.533 +01:00 [DBG] Attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest' ...
2024-06-12 04:41:58.538 +01:00 [DBG] Attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest' using the name '' in request data ...
2024-06-12 04:41:58.546 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2024-06-12 04:41:58.577 +01:00 [DBG] Connection id "0HN4AI6DA3051", Request id "0HN4AI6DA3051:00000001": started reading request body.
2024-06-12 04:41:58.581 +01:00 [DBG] Connection id "0HN4AI6DA3051", Request id "0HN4AI6DA3051:00000001": done reading request body.
2024-06-12 04:41:58.593 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'MyProject.DTOs.CreateProductRequest'
2024-06-12 04:41:58.597 +01:00 [DBG] Done attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest'.
2024-06-12 04:41:58.601 +01:00 [DBG] Done attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest'.
2024-06-12 04:41:58.604 +01:00 [DBG] Attempting to validate the bound parameter 'request' of type 'MyProject.DTOs.CreateProductRequest' ...
2024-06-12 04:41:58.621 +01:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'MyProject.DTOs.CreateProductRequest'.
2024-06-12 04:41:58.770 +01:00 [DBG] Entity Framework Core 8.0.6 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2024-06-12 04:41:58.805 +01:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Product.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 04:41:58.851 +01:00 [DBG] Context 'AppDbContext' started tracking 'Product' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 04:41:58.857 +01:00 [INF] Tenant from header context: beta
2024-06-12 04:41:58.871 +01:00 [DBG] DetectChanges starting for 'AppDbContext'.
2024-06-12 04:41:58.923 +01:00 [DBG] DetectChanges completed for 'AppDbContext'.
2024-06-12 04:41:58.941 +01:00 [DBG] SaveChanges starting for 'AppDbContext'.
2024-06-12 04:41:58.947 +01:00 [DBG] DetectChanges starting for 'AppDbContext'.
2024-06-12 04:41:58.950 +01:00 [DBG] DetectChanges completed for 'AppDbContext'.
2024-06-12 04:41:59.121 +01:00 [DBG] Creating DbConnection.
2024-06-12 04:41:59.129 +01:00 [DBG] Created DbConnection. (8ms).
2024-06-12 04:41:59.135 +01:00 [DBG] Opening connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:41:59.145 +01:00 [DBG] Opened connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:41:59.152 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-06-12 04:41:59.154 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2024-06-12 04:41:59.157 +01:00 [DBG] Initialized DbCommand for 'ExecuteReader' (5ms).
2024-06-12 04:41:59.165 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?' (DbType = Decimal), @p2='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Products" ("Name", "Price", "TenantId")
VALUES (@p0, @p1, @p2)
RETURNING "Id";
2024-06-12 04:41:59.195 +01:00 [ERR] Failed executing DbCommand (29ms) [Parameters=[@p0='?', @p1='?' (DbType = Decimal), @p2='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Products" ("Name", "Price", "TenantId")
VALUES (@p0, @p1, @p2)
RETURNING "Id";
2024-06-12 04:41:59.209 +01:00 [DBG] Closing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:41:59.218 +01:00 [DBG] Closed connection to database 'userservice_db' on server 'tcp://localhost:5432' (9ms).
2024-06-12 04:41:59.250 +01:00 [ERR] An exception occurred in the database while saving changes for context type 'MyProject.Data.AppDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23502: null value in column "TenantId" of relation "Products" violates not-null constraint

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
  Exception data:
    Severity: ERROR
    SqlState: 23502
    MessageText: null value in column "TenantId" of relation "Products" violates not-null constraint
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: Products
    ColumnName: TenantId
    File: execMain.c
    Line: 1974
    Routine: ExecConstraints
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChanges(IList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(StateManager stateManager, Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<>c.<SaveChanges>b__112_0(DbContext _, ValueTuple`2 t)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23502: null value in column "TenantId" of relation "Products" violates not-null constraint

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
  Exception data:
    Severity: ERROR
    SqlState: 23502
    MessageText: null value in column "TenantId" of relation "Products" violates not-null constraint
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: Products
    ColumnName: TenantId
    File: execMain.c
    Line: 1974
    Routine: ExecConstraints
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChanges(IList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(StateManager stateManager, Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<>c.<SaveChanges>b__112_0(DbContext _, ValueTuple`2 t)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
2024-06-12 04:41:59.307 +01:00 [INF] Executed action MyProject.Controller.ProductsController.Post (MyProject) in 801.7704ms
2024-06-12 04:41:59.330 +01:00 [INF] Executed endpoint 'MyProject.Controller.ProductsController.Post (MyProject)'
2024-06-12 04:41:59.337 +01:00 [ERR] HTTP POST /api/product responded 500 in 891.8236 ms
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23502: null value in column "TenantId" of relation "Products" violates not-null constraint

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
  Exception data:
    Severity: ERROR
    SqlState: 23502
    MessageText: null value in column "TenantId" of relation "Products" violates not-null constraint
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: Products
    ColumnName: TenantId
    File: execMain.c
    Line: 1974
    Routine: ExecConstraints
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChanges(IList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(StateManager stateManager, Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<>c.<SaveChanges>b__112_0(DbContext _, ValueTuple`2 t)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges()
   at MyProject.Data.AppDbContext.SaveChanges() in C:\Users\ARthur\Desktop\projects\personal\MyProject\Data\AppDbContext.cs:line 42
   at MyProject.Repository.ProductService.CreateProduct(CreateProductRequest request) in C:\Users\ARthur\Desktop\projects\personal\MyProject\Repository\ProductService.cs:line 42
   at MyProject.Controller.ProductsController.Post(CreateProductRequest request) in C:\Users\ARthur\Desktop\projects\personal\MyProject\Controller\ProductsController.cs:line 34
   at lambda_method20(Closure, Object, Object[])
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.SyncActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeNextActionFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2024-06-12 04:41:59.433 +01:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23502: null value in column "TenantId" of relation "Products" violates not-null constraint

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
  Exception data:
    Severity: ERROR
    SqlState: 23502
    MessageText: null value in column "TenantId" of relation "Products" violates not-null constraint
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: Products
    ColumnName: TenantId
    File: execMain.c
    Line: 1974
    Routine: ExecConstraints
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChanges(IList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(StateManager stateManager, Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<>c.<SaveChanges>b__112_0(DbContext _, ValueTuple`2 t)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges()
   at MyProject.Data.AppDbContext.SaveChanges() in C:\Users\ARthur\Desktop\projects\personal\MyProject\Data\AppDbContext.cs:line 42
   at MyProject.Repository.ProductService.CreateProduct(CreateProductRequest request) in C:\Users\ARthur\Desktop\projects\personal\MyProject\Repository\ProductService.cs:line 42
   at MyProject.Controller.ProductsController.Post(CreateProductRequest request) in C:\Users\ARthur\Desktop\projects\personal\MyProject\Controller\ProductsController.cs:line 34
   at lambda_method20(Closure, Object, Object[])
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.SyncActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeNextActionFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at MyProject.Middleware.TenantResolver.InvokeAsync(HttpContext context, ICurrentTenantService currentTenantService) in C:\Users\ARthur\Desktop\projects\personal\MyProject\Middleware\TenantResolver.cs:line 28
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2024-06-12 04:41:59.480 +01:00 [DBG] Connection id "0HN4AI6DA3051" completed keep alive response.
2024-06-12 04:41:59.487 +01:00 [DBG] 'AppDbContext' disposed.
2024-06-12 04:41:59.502 +01:00 [DBG] Disposing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:41:59.508 +01:00 [DBG] Disposed connection to database 'userservice_db' on server 'tcp://localhost:5432' (5ms).
2024-06-12 04:41:59.515 +01:00 [DBG] 'TenantDbContext' disposed.
2024-06-12 04:41:59.517 +01:00 [DBG] Disposing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:41:59.520 +01:00 [DBG] Disposed connection to database 'userservice_db' on server 'tcp://localhost:5432' (2ms).
2024-06-12 04:41:59.529 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5165/api/product - 500 null text/plain; charset=utf-8 4566.7704ms
2024-06-12 04:44:10.147 +01:00 [DBG] Connection id "0HN4AI6DA3051" disconnecting.
2024-06-12 04:44:10.156 +01:00 [DBG] Connection id "0HN4AI6DA3051" stopped.
2024-06-12 04:44:10.161 +01:00 [DBG] Connection id "0HN4AI6DA3051" sending FIN because: "The Socket transport's send loop completed gracefully."
2024-06-12 04:46:09.124 +01:00 [INF] Application is shutting down...
2024-06-12 04:46:09.133 +01:00 [DBG] Hosting stopping
2024-06-12 04:46:09.164 +01:00 [DBG] Hosting stopped
2024-06-12 04:46:18.711 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2024-06-12 04:46:19.028 +01:00 [DBG] Hosting starting
2024-06-12 04:46:19.522 +01:00 [INF] Now listening on: http://localhost:5165
2024-06-12 04:46:19.569 +01:00 [DBG] Loaded hosting startup assembly MyProject
2024-06-12 04:46:19.573 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2024-06-12 04:46:19.576 +01:00 [INF] Hosting environment: Development
2024-06-12 04:46:19.583 +01:00 [INF] Content root path: C:\Users\ARthur\Desktop\projects\personal\MyProject
2024-06-12 04:46:19.586 +01:00 [DBG] Hosting started
2024-06-12 04:46:25.031 +01:00 [DBG] Connection id "0HN4AI8TQA95I" accepted.
2024-06-12 04:46:25.035 +01:00 [DBG] Connection id "0HN4AI8TQA95I" started.
2024-06-12 04:46:25.122 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5165/api/product - application/json 37
2024-06-12 04:46:25.153 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2024-06-12 04:46:25.211 +01:00 [DBG] 1 candidate(s) found for the request path '/api/product'
2024-06-12 04:46:25.221 +01:00 [DBG] Endpoint 'MyProject.Controller.ProductsController.Post (MyProject)' with route pattern 'api/product' is valid for the request path '/api/product'
2024-06-12 04:46:25.228 +01:00 [DBG] Request matched endpoint 'MyProject.Controller.ProductsController.Post (MyProject)'
2024-06-12 04:46:25.315 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2024-06-12 04:46:25.617 +01:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2024-06-12 04:46:26.992 +01:00 [DBG] Entity Framework Core 8.0.6 initialized 'TenantDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2024-06-12 04:46:27.154 +01:00 [DBG] Compiling query expression: 
'DbSet<Tenant>()
    .Where(x => x.Id == __tenant_0)
    .FirstOrDefault()'
2024-06-12 04:46:27.843 +01:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Tenant>(
    asyncEnumerable: new SingleQueryingEnumerable<Tenant>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Tenant.Id (string) Required PK AfterSave:Throw, 0], [Property: Tenant.Name (string) Required, 1] }
            SELECT TOP(1) t.Id, t.Name
            FROM Tenants AS t
            WHERE t.Id == @__tenant_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Tenant>, 
        MyProject.Data.TenantDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2024-06-12 04:46:28.115 +01:00 [DBG] Creating DbConnection.
2024-06-12 04:46:28.202 +01:00 [DBG] Created DbConnection. (79ms).
2024-06-12 04:46:28.258 +01:00 [DBG] Opening connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:46:28.681 +01:00 [DBG] Opened connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:46:28.697 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-06-12 04:46:28.716 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (12ms).
2024-06-12 04:46:28.731 +01:00 [DBG] Initialized DbCommand for 'ExecuteReader' (35ms).
2024-06-12 04:46:28.751 +01:00 [DBG] Executing DbCommand [Parameters=[@__tenant_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Name"
FROM "Tenants" AS t
WHERE t."Id" = @__tenant_0
LIMIT 1
2024-06-12 04:46:28.868 +01:00 [INF] Executed DbCommand (122ms) [Parameters=[@__tenant_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Name"
FROM "Tenants" AS t
WHERE t."Id" = @__tenant_0
LIMIT 1
2024-06-12 04:46:28.942 +01:00 [DBG] Context 'TenantDbContext' started tracking 'Tenant' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 04:46:28.986 +01:00 [DBG] Closing data reader to 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:46:29.016 +01:00 [DBG] A data reader for 'userservice_db' on server 'tcp://localhost:5432' is being disposed after spending 136ms reading results.
2024-06-12 04:46:29.035 +01:00 [DBG] Closing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:46:29.050 +01:00 [DBG] Closed connection to database 'userservice_db' on server 'tcp://localhost:5432' (14ms).
2024-06-12 04:46:29.062 +01:00 [WRN] Failed to determine the https port for redirect.
2024-06-12 04:46:29.065 +01:00 [INF] Executing endpoint 'MyProject.Controller.ProductsController.Post (MyProject)'
2024-06-12 04:46:29.099 +01:00 [INF] Route matched with {action = "Post", controller = "Products"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Post(MyProject.DTOs.CreateProductRequest) on controller MyProject.Controller.ProductsController (MyProject).
2024-06-12 04:46:29.108 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2024-06-12 04:46:29.111 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2024-06-12 04:46:29.117 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2024-06-12 04:46:29.123 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2024-06-12 04:46:29.127 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2024-06-12 04:46:29.133 +01:00 [DBG] Executing controller factory for controller MyProject.Controller.ProductsController (MyProject)
2024-06-12 04:46:29.143 +01:00 [DBG] Executed controller factory for controller MyProject.Controller.ProductsController (MyProject)
2024-06-12 04:46:29.161 +01:00 [DBG] Attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest' ...
2024-06-12 04:46:29.169 +01:00 [DBG] Attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest' using the name '' in request data ...
2024-06-12 04:46:29.179 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2024-06-12 04:46:29.224 +01:00 [DBG] Connection id "0HN4AI8TQA95I", Request id "0HN4AI8TQA95I:00000001": started reading request body.
2024-06-12 04:46:29.228 +01:00 [DBG] Connection id "0HN4AI8TQA95I", Request id "0HN4AI8TQA95I:00000001": done reading request body.
2024-06-12 04:46:29.245 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'MyProject.DTOs.CreateProductRequest'
2024-06-12 04:46:29.248 +01:00 [DBG] Done attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest'.
2024-06-12 04:46:29.251 +01:00 [DBG] Done attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest'.
2024-06-12 04:46:29.257 +01:00 [DBG] Attempting to validate the bound parameter 'request' of type 'MyProject.DTOs.CreateProductRequest' ...
2024-06-12 04:46:29.273 +01:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'MyProject.DTOs.CreateProductRequest'.
2024-06-12 04:46:29.388 +01:00 [DBG] Entity Framework Core 8.0.6 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2024-06-12 04:46:29.428 +01:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Product.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 04:46:29.490 +01:00 [DBG] Context 'AppDbContext' started tracking 'Product' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 04:46:29.502 +01:00 [DBG] DetectChanges starting for 'AppDbContext'.
2024-06-12 04:46:29.541 +01:00 [DBG] DetectChanges completed for 'AppDbContext'.
2024-06-12 04:46:29.551 +01:00 [DBG] SaveChanges starting for 'AppDbContext'.
2024-06-12 04:46:29.556 +01:00 [DBG] DetectChanges starting for 'AppDbContext'.
2024-06-12 04:46:29.558 +01:00 [DBG] DetectChanges completed for 'AppDbContext'.
2024-06-12 04:46:29.744 +01:00 [DBG] Creating DbConnection.
2024-06-12 04:46:30.097 +01:00 [DBG] Created DbConnection. (352ms).
2024-06-12 04:46:30.118 +01:00 [DBG] Opening connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:46:30.127 +01:00 [DBG] Opened connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:46:30.133 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-06-12 04:46:30.136 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2024-06-12 04:46:30.142 +01:00 [DBG] Initialized DbCommand for 'ExecuteReader' (9ms).
2024-06-12 04:46:30.146 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?' (DbType = Decimal), @p2='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Products" ("Name", "Price", "TenantId")
VALUES (@p0, @p1, @p2)
RETURNING "Id";
2024-06-12 04:46:30.176 +01:00 [ERR] Failed executing DbCommand (28ms) [Parameters=[@p0='?', @p1='?' (DbType = Decimal), @p2='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Products" ("Name", "Price", "TenantId")
VALUES (@p0, @p1, @p2)
RETURNING "Id";
2024-06-12 04:46:30.186 +01:00 [DBG] Closing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:46:30.190 +01:00 [DBG] Closed connection to database 'userservice_db' on server 'tcp://localhost:5432' (4ms).
2024-06-12 04:46:30.215 +01:00 [ERR] An exception occurred in the database while saving changes for context type 'MyProject.Data.AppDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23502: null value in column "TenantId" of relation "Products" violates not-null constraint

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
  Exception data:
    Severity: ERROR
    SqlState: 23502
    MessageText: null value in column "TenantId" of relation "Products" violates not-null constraint
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: Products
    ColumnName: TenantId
    File: execMain.c
    Line: 1974
    Routine: ExecConstraints
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChanges(IList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(StateManager stateManager, Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<>c.<SaveChanges>b__112_0(DbContext _, ValueTuple`2 t)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23502: null value in column "TenantId" of relation "Products" violates not-null constraint

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
  Exception data:
    Severity: ERROR
    SqlState: 23502
    MessageText: null value in column "TenantId" of relation "Products" violates not-null constraint
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: Products
    ColumnName: TenantId
    File: execMain.c
    Line: 1974
    Routine: ExecConstraints
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChanges(IList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(StateManager stateManager, Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<>c.<SaveChanges>b__112_0(DbContext _, ValueTuple`2 t)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
2024-06-12 04:46:30.249 +01:00 [INF] Executed action MyProject.Controller.ProductsController.Post (MyProject) in 1114.2948ms
2024-06-12 04:46:30.257 +01:00 [INF] Executed endpoint 'MyProject.Controller.ProductsController.Post (MyProject)'
2024-06-12 04:46:30.261 +01:00 [ERR] HTTP POST /api/product responded 500 in 1200.0067 ms
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23502: null value in column "TenantId" of relation "Products" violates not-null constraint

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
  Exception data:
    Severity: ERROR
    SqlState: 23502
    MessageText: null value in column "TenantId" of relation "Products" violates not-null constraint
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: Products
    ColumnName: TenantId
    File: execMain.c
    Line: 1974
    Routine: ExecConstraints
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChanges(IList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(StateManager stateManager, Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<>c.<SaveChanges>b__112_0(DbContext _, ValueTuple`2 t)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges()
   at MyProject.Data.AppDbContext.SaveChanges() in C:\Users\ARthur\Desktop\projects\personal\MyProject\Data\AppDbContext.cs:line 60
   at MyProject.Repository.ProductService.CreateProduct(CreateProductRequest request) in C:\Users\ARthur\Desktop\projects\personal\MyProject\Repository\ProductService.cs:line 42
   at MyProject.Controller.ProductsController.Post(CreateProductRequest request) in C:\Users\ARthur\Desktop\projects\personal\MyProject\Controller\ProductsController.cs:line 34
   at lambda_method20(Closure, Object, Object[])
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.SyncActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeNextActionFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2024-06-12 04:46:30.324 +01:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23502: null value in column "TenantId" of relation "Products" violates not-null constraint

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult()
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(CommandBehavior behavior)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
  Exception data:
    Severity: ERROR
    SqlState: 23502
    MessageText: null value in column "TenantId" of relation "Products" violates not-null constraint
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: Products
    ColumnName: TenantId
    File: execMain.c
    Line: 1974
    Routine: ExecConstraints
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChanges(IList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(StateManager stateManager, Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<>c.<SaveChanges>b__112_0(DbContext _, ValueTuple`2 t)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges()
   at MyProject.Data.AppDbContext.SaveChanges() in C:\Users\ARthur\Desktop\projects\personal\MyProject\Data\AppDbContext.cs:line 60
   at MyProject.Repository.ProductService.CreateProduct(CreateProductRequest request) in C:\Users\ARthur\Desktop\projects\personal\MyProject\Repository\ProductService.cs:line 42
   at MyProject.Controller.ProductsController.Post(CreateProductRequest request) in C:\Users\ARthur\Desktop\projects\personal\MyProject\Controller\ProductsController.cs:line 34
   at lambda_method20(Closure, Object, Object[])
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.SyncActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeNextActionFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at MyProject.Middleware.TenantResolver.InvokeAsync(HttpContext context, ICurrentTenantService currentTenantService) in C:\Users\ARthur\Desktop\projects\personal\MyProject\Middleware\TenantResolver.cs:line 28
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2024-06-12 04:46:30.379 +01:00 [DBG] Connection id "0HN4AI8TQA95I" completed keep alive response.
2024-06-12 04:46:30.812 +01:00 [DBG] 'AppDbContext' disposed.
2024-06-12 04:46:31.212 +01:00 [DBG] Disposing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:46:31.231 +01:00 [DBG] Disposed connection to database 'userservice_db' on server 'tcp://localhost:5432' (19ms).
2024-06-12 04:46:31.234 +01:00 [DBG] 'TenantDbContext' disposed.
2024-06-12 04:46:31.239 +01:00 [DBG] Disposing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:46:31.241 +01:00 [DBG] Disposed connection to database 'userservice_db' on server 'tcp://localhost:5432' (1ms).
2024-06-12 04:46:31.247 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5165/api/product - 500 null text/plain; charset=utf-8 6140.0672ms
2024-06-12 04:48:42.145 +01:00 [DBG] Connection id "0HN4AI8TQA95I" disconnecting.
2024-06-12 04:48:42.148 +01:00 [DBG] Connection id "0HN4AI8TQA95I" stopped.
2024-06-12 04:48:42.151 +01:00 [DBG] Connection id "0HN4AI8TQA95I" sending FIN because: "The Socket transport's send loop completed gracefully."
2024-06-12 04:56:04.256 +01:00 [INF] Application is shutting down...
2024-06-12 04:56:04.271 +01:00 [DBG] Hosting stopping
2024-06-12 04:56:04.300 +01:00 [DBG] Hosting stopped
2024-06-12 04:56:15.693 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2024-06-12 04:56:15.952 +01:00 [DBG] Hosting starting
2024-06-12 04:56:16.571 +01:00 [INF] Now listening on: http://localhost:5165
2024-06-12 04:56:16.776 +01:00 [DBG] Loaded hosting startup assembly MyProject
2024-06-12 04:56:16.779 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2024-06-12 04:56:16.781 +01:00 [INF] Hosting environment: Development
2024-06-12 04:56:16.784 +01:00 [INF] Content root path: C:\Users\ARthur\Desktop\projects\personal\MyProject
2024-06-12 04:56:16.787 +01:00 [DBG] Hosting started
2024-06-12 04:56:20.407 +01:00 [DBG] Connection id "0HN4AIEF88N6R" accepted.
2024-06-12 04:56:20.415 +01:00 [DBG] Connection id "0HN4AIEF88N6R" started.
2024-06-12 04:56:20.527 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5165/api/product - application/json 37
2024-06-12 04:56:20.626 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2024-06-12 04:56:20.691 +01:00 [DBG] 1 candidate(s) found for the request path '/api/product'
2024-06-12 04:56:20.704 +01:00 [DBG] Endpoint 'MyProject.Controller.ProductsController.Post (MyProject)' with route pattern 'api/product' is valid for the request path '/api/product'
2024-06-12 04:56:20.710 +01:00 [DBG] Request matched endpoint 'MyProject.Controller.ProductsController.Post (MyProject)'
2024-06-12 04:56:20.749 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2024-06-12 04:56:21.102 +01:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2024-06-12 04:56:23.546 +01:00 [DBG] Entity Framework Core 8.0.6 initialized 'TenantDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2024-06-12 04:56:23.665 +01:00 [DBG] Compiling query expression: 
'DbSet<Tenant>()
    .Where(x => x.Id == __tenant_0)
    .FirstOrDefault()'
2024-06-12 04:56:24.139 +01:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Tenant>(
    asyncEnumerable: new SingleQueryingEnumerable<Tenant>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Tenant.Id (string) Required PK AfterSave:Throw, 0], [Property: Tenant.Name (string) Required, 1] }
            SELECT TOP(1) t.Id, t.Name
            FROM Tenants AS t
            WHERE t.Id == @__tenant_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Tenant>, 
        MyProject.Data.TenantDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2024-06-12 04:56:24.224 +01:00 [DBG] Creating DbConnection.
2024-06-12 04:56:24.280 +01:00 [DBG] Created DbConnection. (51ms).
2024-06-12 04:56:24.291 +01:00 [DBG] Opening connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:56:24.645 +01:00 [DBG] Opened connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:56:24.657 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-06-12 04:56:24.672 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (7ms).
2024-06-12 04:56:24.683 +01:00 [DBG] Initialized DbCommand for 'ExecuteReader' (26ms).
2024-06-12 04:56:24.705 +01:00 [DBG] Executing DbCommand [Parameters=[@__tenant_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Name"
FROM "Tenants" AS t
WHERE t."Id" = @__tenant_0
LIMIT 1
2024-06-12 04:56:24.870 +01:00 [INF] Executed DbCommand (166ms) [Parameters=[@__tenant_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Name"
FROM "Tenants" AS t
WHERE t."Id" = @__tenant_0
LIMIT 1
2024-06-12 04:56:24.969 +01:00 [DBG] Context 'TenantDbContext' started tracking 'Tenant' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 04:56:25.012 +01:00 [DBG] Closing data reader to 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:56:25.041 +01:00 [DBG] A data reader for 'userservice_db' on server 'tcp://localhost:5432' is being disposed after spending 153ms reading results.
2024-06-12 04:56:25.053 +01:00 [DBG] Closing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:56:25.068 +01:00 [DBG] Closed connection to database 'userservice_db' on server 'tcp://localhost:5432' (11ms).
2024-06-12 04:56:25.605 +01:00 [WRN] Failed to determine the https port for redirect.
2024-06-12 04:56:25.710 +01:00 [INF] Executing endpoint 'MyProject.Controller.ProductsController.Post (MyProject)'
2024-06-12 04:56:25.985 +01:00 [INF] Route matched with {action = "Post", controller = "Products"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Post(MyProject.DTOs.CreateProductRequest) on controller MyProject.Controller.ProductsController (MyProject).
2024-06-12 04:56:26.035 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2024-06-12 04:56:26.039 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2024-06-12 04:56:26.044 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2024-06-12 04:56:26.051 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2024-06-12 04:56:26.055 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2024-06-12 04:56:26.062 +01:00 [DBG] Executing controller factory for controller MyProject.Controller.ProductsController (MyProject)
2024-06-12 04:56:26.075 +01:00 [DBG] Executed controller factory for controller MyProject.Controller.ProductsController (MyProject)
2024-06-12 04:56:26.090 +01:00 [DBG] Attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest' ...
2024-06-12 04:56:26.100 +01:00 [DBG] Attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest' using the name '' in request data ...
2024-06-12 04:56:26.106 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2024-06-12 04:56:26.142 +01:00 [DBG] Connection id "0HN4AIEF88N6R", Request id "0HN4AIEF88N6R:00000001": started reading request body.
2024-06-12 04:56:26.145 +01:00 [DBG] Connection id "0HN4AIEF88N6R", Request id "0HN4AIEF88N6R:00000001": done reading request body.
2024-06-12 04:56:26.161 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'MyProject.DTOs.CreateProductRequest'
2024-06-12 04:56:26.166 +01:00 [DBG] Done attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest'.
2024-06-12 04:56:26.170 +01:00 [DBG] Done attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest'.
2024-06-12 04:56:26.173 +01:00 [DBG] Attempting to validate the bound parameter 'request' of type 'MyProject.DTOs.CreateProductRequest' ...
2024-06-12 04:56:26.190 +01:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'MyProject.DTOs.CreateProductRequest'.
2024-06-12 04:56:26.355 +01:00 [DBG] Entity Framework Core 8.0.6 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2024-06-12 04:56:26.565 +01:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Product.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 04:56:26.626 +01:00 [DBG] Context 'AppDbContext' started tracking 'Product' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 04:56:26.643 +01:00 [DBG] SaveChanges starting for 'AppDbContext'.
2024-06-12 04:56:26.653 +01:00 [DBG] DetectChanges starting for 'AppDbContext'.
2024-06-12 04:56:26.686 +01:00 [DBG] DetectChanges completed for 'AppDbContext'.
2024-06-12 04:56:26.894 +01:00 [DBG] Creating DbConnection.
2024-06-12 04:56:26.920 +01:00 [DBG] Created DbConnection. (25ms).
2024-06-12 04:56:26.921 +01:00 [DBG] Opening connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:56:26.924 +01:00 [DBG] Opened connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:56:26.929 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-06-12 04:56:26.934 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (5ms).
2024-06-12 04:56:26.936 +01:00 [DBG] Initialized DbCommand for 'ExecuteReader' (7ms).
2024-06-12 04:56:26.938 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?' (DbType = Decimal), @p2='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Products" ("Name", "Price", "TenantId")
VALUES (@p0, @p1, @p2)
RETURNING "Id";
2024-06-12 04:56:26.974 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2024-06-12 04:56:26.982 +01:00 [ERR] Failed executing DbCommand (40ms) [Parameters=[@p0='?', @p1='?' (DbType = Decimal), @p2='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Products" ("Name", "Price", "TenantId")
VALUES (@p0, @p1, @p2)
RETURNING "Id";
2024-06-12 04:56:26.993 +01:00 [DBG] No information found on request to perform content negotiation.
2024-06-12 04:56:27.008 +01:00 [DBG] Closing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:56:27.009 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2024-06-12 04:56:27.011 +01:00 [DBG] Closed connection to database 'userservice_db' on server 'tcp://localhost:5432' (2ms).
2024-06-12 04:56:27.015 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2024-06-12 04:56:27.057 +01:00 [ERR] An exception occurred in the database while saving changes for context type 'MyProject.Data.AppDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23502: null value in column "TenantId" of relation "Products" violates not-null constraint

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23502
    MessageText: null value in column "TenantId" of relation "Products" violates not-null constraint
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: Products
    ColumnName: TenantId
    File: execMain.c
    Line: 1974
    Routine: ExecConstraints
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23502: null value in column "TenantId" of relation "Products" violates not-null constraint

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23502
    MessageText: null value in column "TenantId" of relation "Products" violates not-null constraint
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: Products
    ColumnName: TenantId
    File: execMain.c
    Line: 1974
    Routine: ExecConstraints
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2024-06-12 04:56:27.060 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2024-06-12 04:56:27.096 +01:00 [INF] Executing OkObjectResult, writing value of type 'System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1+AsyncStateMachineBox`1[[MyProject.Entities.Product, MyProject, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[MyProject.Repository.ProductService+<CreateProduct>d__4, MyProject, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2024-06-12 04:56:27.144 +01:00 [INF] Executed action MyProject.Controller.ProductsController.Post (MyProject) in 1061.8748ms
2024-06-12 04:56:27.156 +01:00 [INF] Executed endpoint 'MyProject.Controller.ProductsController.Post (MyProject)'
2024-06-12 04:56:27.161 +01:00 [ERR] HTTP POST /api/product responded 500 in 1556.1851 ms
System.InvalidOperationException: The type 'System.Threading.ExecutionContext&' of property 'Context' on type 'System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1+AsyncStateMachineBox`1[MyProject.Entities.Product,MyProject.Repository.ProductService+<CreateProduct>d__4]' is invalid for serialization or deserialization because it is a pointer type, is a ref struct, or contains generic parameters that have not been replaced by specific types.
   at System.Text.Json.ThrowHelper.ThrowInvalidOperationException_CannotSerializeInvalidType(Type typeToConvert, Type declaringType, MemberInfo memberInfo)
   at System.Text.Json.Serialization.Metadata.DefaultJsonTypeInfoResolver.CreatePropertyInfo(JsonTypeInfo typeInfo, Type typeToConvert, MemberInfo memberInfo, JsonSerializerOptions options, Boolean shouldCheckForRequiredKeyword, Boolean hasJsonIncludeAttribute)
   at System.Text.Json.Serialization.Metadata.DefaultJsonTypeInfoResolver.AddMembersDeclaredBySuperType(JsonTypeInfo typeInfo, Type currentType, Boolean constructorHasSetsRequiredMembersAttribute, PropertyHierarchyResolutionState& state)
   at System.Text.Json.Serialization.Metadata.DefaultJsonTypeInfoResolver.PopulateProperties(JsonTypeInfo typeInfo)
   at System.Text.Json.Serialization.Metadata.DefaultJsonTypeInfoResolver.CreateTypeInfoCore(Type type, JsonConverter converter, JsonSerializerOptions options)
   at System.Text.Json.Serialization.Metadata.DefaultJsonTypeInfoResolver.GetTypeInfo(Type type, JsonSerializerOptions options)
   at System.Text.Json.JsonSerializerOptions.GetTypeInfoNoCaching(Type type)
   at System.Text.Json.JsonSerializerOptions.CachingContext.CreateCacheEntry(Type type, CachingContext context)
--- End of stack trace from previous location ---
   at System.Text.Json.JsonSerializerOptions.GetTypeInfoInternal(Type type, Boolean ensureConfigured, Nullable`1 ensureNotNull, Boolean resolveIfMutable, Boolean fallBackToNearestAncestorType)
   at System.Text.Json.JsonSerializerOptions.GetTypeInfo(Type type)
   at Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter.WriteResponseBodyAsync(OutputFormatterWriteContext context, Encoding selectedEncoding)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResultFilterAsync>g__Awaited|30_0[TFilter,TFilterAsync](ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2024-06-12 04:56:27.195 +01:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The type 'System.Threading.ExecutionContext&' of property 'Context' on type 'System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1+AsyncStateMachineBox`1[MyProject.Entities.Product,MyProject.Repository.ProductService+<CreateProduct>d__4]' is invalid for serialization or deserialization because it is a pointer type, is a ref struct, or contains generic parameters that have not been replaced by specific types.
   at System.Text.Json.ThrowHelper.ThrowInvalidOperationException_CannotSerializeInvalidType(Type typeToConvert, Type declaringType, MemberInfo memberInfo)
   at System.Text.Json.Serialization.Metadata.DefaultJsonTypeInfoResolver.CreatePropertyInfo(JsonTypeInfo typeInfo, Type typeToConvert, MemberInfo memberInfo, JsonSerializerOptions options, Boolean shouldCheckForRequiredKeyword, Boolean hasJsonIncludeAttribute)
   at System.Text.Json.Serialization.Metadata.DefaultJsonTypeInfoResolver.AddMembersDeclaredBySuperType(JsonTypeInfo typeInfo, Type currentType, Boolean constructorHasSetsRequiredMembersAttribute, PropertyHierarchyResolutionState& state)
   at System.Text.Json.Serialization.Metadata.DefaultJsonTypeInfoResolver.PopulateProperties(JsonTypeInfo typeInfo)
   at System.Text.Json.Serialization.Metadata.DefaultJsonTypeInfoResolver.CreateTypeInfoCore(Type type, JsonConverter converter, JsonSerializerOptions options)
   at System.Text.Json.Serialization.Metadata.DefaultJsonTypeInfoResolver.GetTypeInfo(Type type, JsonSerializerOptions options)
   at System.Text.Json.JsonSerializerOptions.GetTypeInfoNoCaching(Type type)
   at System.Text.Json.JsonSerializerOptions.CachingContext.CreateCacheEntry(Type type, CachingContext context)
--- End of stack trace from previous location ---
   at System.Text.Json.JsonSerializerOptions.GetTypeInfoInternal(Type type, Boolean ensureConfigured, Nullable`1 ensureNotNull, Boolean resolveIfMutable, Boolean fallBackToNearestAncestorType)
   at System.Text.Json.JsonSerializerOptions.GetTypeInfo(Type type)
   at Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter.WriteResponseBodyAsync(OutputFormatterWriteContext context, Encoding selectedEncoding)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResultFilterAsync>g__Awaited|30_0[TFilter,TFilterAsync](ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at MyProject.Middleware.TenantResolver.InvokeAsync(HttpContext context, ICurrentTenantService currentTenantService) in C:\Users\ARthur\Desktop\projects\personal\MyProject\Middleware\TenantResolver.cs:line 28
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2024-06-12 04:56:27.270 +01:00 [DBG] Connection id "0HN4AIEF88N6R" completed keep alive response.
2024-06-12 04:56:27.277 +01:00 [DBG] 'AppDbContext' disposed.
2024-06-12 04:56:27.295 +01:00 [DBG] Disposing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:56:27.310 +01:00 [DBG] Disposed connection to database 'userservice_db' on server 'tcp://localhost:5432' (16ms).
2024-06-12 04:56:27.317 +01:00 [DBG] 'TenantDbContext' disposed.
2024-06-12 04:56:27.319 +01:00 [DBG] Disposing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 04:56:27.325 +01:00 [DBG] Disposed connection to database 'userservice_db' on server 'tcp://localhost:5432' (6ms).
2024-06-12 04:56:27.333 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5165/api/product - 500 null text/plain; charset=utf-8 6819.5376ms
2024-06-12 04:58:38.079 +01:00 [DBG] Connection id "0HN4AIEF88N6R" disconnecting.
2024-06-12 04:58:38.093 +01:00 [DBG] Connection id "0HN4AIEF88N6R" stopped.
2024-06-12 04:58:38.099 +01:00 [DBG] Connection id "0HN4AIEF88N6R" sending FIN because: "The Socket transport's send loop completed gracefully."
2024-06-12 05:01:55.791 +01:00 [INF] Application is shutting down...
2024-06-12 05:01:55.801 +01:00 [DBG] Hosting stopping
2024-06-12 05:01:55.837 +01:00 [DBG] Hosting stopped
2024-06-12 05:02:05.548 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2024-06-12 05:02:05.736 +01:00 [DBG] Hosting starting
2024-06-12 05:02:05.812 +01:00 [INF] Now listening on: http://localhost:5165
2024-06-12 05:02:05.814 +01:00 [DBG] Loaded hosting startup assembly MyProject
2024-06-12 05:02:05.816 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2024-06-12 05:02:05.819 +01:00 [INF] Hosting environment: Development
2024-06-12 05:02:05.821 +01:00 [INF] Content root path: C:\Users\ARthur\Desktop\projects\personal\MyProject
2024-06-12 05:02:05.823 +01:00 [DBG] Hosting started
2024-06-12 05:02:15.098 +01:00 [DBG] Connection id "0HN4AIHOURKJE" accepted.
2024-06-12 05:02:15.140 +01:00 [DBG] Connection id "0HN4AIHOURKJE" started.
2024-06-12 05:02:15.230 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5165/api/product - application/json 37
2024-06-12 05:02:15.249 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2024-06-12 05:02:15.309 +01:00 [DBG] 1 candidate(s) found for the request path '/api/product'
2024-06-12 05:02:15.331 +01:00 [DBG] Endpoint 'MyProject.Controller.ProductsController.Post (MyProject)' with route pattern 'api/product' is valid for the request path '/api/product'
2024-06-12 05:02:15.350 +01:00 [DBG] Request matched endpoint 'MyProject.Controller.ProductsController.Post (MyProject)'
2024-06-12 05:02:15.399 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2024-06-12 05:02:15.713 +01:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2024-06-12 05:02:16.699 +01:00 [DBG] Entity Framework Core 8.0.6 initialized 'TenantDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2024-06-12 05:02:16.921 +01:00 [DBG] Compiling query expression: 
'DbSet<Tenant>()
    .Where(x => x.Id == __tenant_0)
    .FirstOrDefault()'
2024-06-12 05:02:17.396 +01:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Tenant>(
    asyncEnumerable: new SingleQueryingEnumerable<Tenant>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Tenant.Id (string) Required PK AfterSave:Throw, 0], [Property: Tenant.Name (string) Required, 1] }
            SELECT TOP(1) t.Id, t.Name
            FROM Tenants AS t
            WHERE t.Id == @__tenant_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Tenant>, 
        MyProject.Data.TenantDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2024-06-12 05:02:17.492 +01:00 [DBG] Creating DbConnection.
2024-06-12 05:02:17.570 +01:00 [DBG] Created DbConnection. (73ms).
2024-06-12 05:02:17.591 +01:00 [DBG] Opening connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 05:02:18.126 +01:00 [DBG] Opened connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 05:02:18.145 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-06-12 05:02:18.180 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (26ms).
2024-06-12 05:02:18.203 +01:00 [DBG] Initialized DbCommand for 'ExecuteReader' (61ms).
2024-06-12 05:02:18.263 +01:00 [DBG] Executing DbCommand [Parameters=[@__tenant_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Name"
FROM "Tenants" AS t
WHERE t."Id" = @__tenant_0
LIMIT 1
2024-06-12 05:02:18.435 +01:00 [INF] Executed DbCommand (186ms) [Parameters=[@__tenant_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Name"
FROM "Tenants" AS t
WHERE t."Id" = @__tenant_0
LIMIT 1
2024-06-12 05:02:18.502 +01:00 [DBG] Context 'TenantDbContext' started tracking 'Tenant' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 05:02:18.534 +01:00 [DBG] Closing data reader to 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 05:02:18.552 +01:00 [DBG] A data reader for 'userservice_db' on server 'tcp://localhost:5432' is being disposed after spending 105ms reading results.
2024-06-12 05:02:18.562 +01:00 [DBG] Closing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 05:02:18.572 +01:00 [DBG] Closed connection to database 'userservice_db' on server 'tcp://localhost:5432' (10ms).
2024-06-12 05:02:18.579 +01:00 [WRN] Failed to determine the https port for redirect.
2024-06-12 05:02:18.582 +01:00 [INF] Executing endpoint 'MyProject.Controller.ProductsController.Post (MyProject)'
2024-06-12 05:02:18.610 +01:00 [INF] Route matched with {action = "Post", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Post(MyProject.DTOs.CreateProductRequest) on controller MyProject.Controller.ProductsController (MyProject).
2024-06-12 05:02:18.619 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2024-06-12 05:02:18.623 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2024-06-12 05:02:18.632 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2024-06-12 05:02:18.637 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2024-06-12 05:02:18.640 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2024-06-12 05:02:18.648 +01:00 [DBG] Executing controller factory for controller MyProject.Controller.ProductsController (MyProject)
2024-06-12 05:02:18.655 +01:00 [DBG] Executed controller factory for controller MyProject.Controller.ProductsController (MyProject)
2024-06-12 05:02:18.666 +01:00 [DBG] Attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest' ...
2024-06-12 05:02:18.671 +01:00 [DBG] Attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest' using the name '' in request data ...
2024-06-12 05:02:18.677 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2024-06-12 05:02:18.707 +01:00 [DBG] Connection id "0HN4AIHOURKJE", Request id "0HN4AIHOURKJE:00000001": started reading request body.
2024-06-12 05:02:18.712 +01:00 [DBG] Connection id "0HN4AIHOURKJE", Request id "0HN4AIHOURKJE:00000001": done reading request body.
2024-06-12 05:02:18.723 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'MyProject.DTOs.CreateProductRequest'
2024-06-12 05:02:18.727 +01:00 [DBG] Done attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest'.
2024-06-12 05:02:18.731 +01:00 [DBG] Done attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest'.
2024-06-12 05:02:18.734 +01:00 [DBG] Attempting to validate the bound parameter 'request' of type 'MyProject.DTOs.CreateProductRequest' ...
2024-06-12 05:02:18.748 +01:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'MyProject.DTOs.CreateProductRequest'.
2024-06-12 05:02:18.843 +01:00 [DBG] Entity Framework Core 8.0.6 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2024-06-12 05:02:18.887 +01:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Product.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 05:02:18.936 +01:00 [DBG] Context 'AppDbContext' started tracking 'Product' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 05:02:18.947 +01:00 [DBG] SaveChanges starting for 'AppDbContext'.
2024-06-12 05:02:18.956 +01:00 [DBG] DetectChanges starting for 'AppDbContext'.
2024-06-12 05:02:18.985 +01:00 [DBG] DetectChanges completed for 'AppDbContext'.
2024-06-12 05:02:19.171 +01:00 [DBG] Creating DbConnection.
2024-06-12 05:02:19.172 +01:00 [DBG] Created DbConnection. (1ms).
2024-06-12 05:02:19.179 +01:00 [DBG] Opening connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 05:02:19.183 +01:00 [DBG] Opened connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 05:02:19.189 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-06-12 05:02:19.195 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (5ms).
2024-06-12 05:02:19.199 +01:00 [DBG] Initialized DbCommand for 'ExecuteReader' (10ms).
2024-06-12 05:02:19.202 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?' (DbType = Decimal), @p2='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Products" ("Name", "Price", "TenantId")
VALUES (@p0, @p1, @p2)
RETURNING "Id";
2024-06-12 05:02:19.246 +01:00 [ERR] Failed executing DbCommand (43ms) [Parameters=[@p0='?', @p1='?' (DbType = Decimal), @p2='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Products" ("Name", "Price", "TenantId")
VALUES (@p0, @p1, @p2)
RETURNING "Id";
2024-06-12 05:02:19.260 +01:00 [DBG] Closing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 05:02:19.263 +01:00 [DBG] Closed connection to database 'userservice_db' on server 'tcp://localhost:5432' (3ms).
2024-06-12 05:02:19.297 +01:00 [ERR] An exception occurred in the database while saving changes for context type 'MyProject.Data.AppDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23502: null value in column "TenantId" of relation "Products" violates not-null constraint

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23502
    MessageText: null value in column "TenantId" of relation "Products" violates not-null constraint
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: Products
    ColumnName: TenantId
    File: execMain.c
    Line: 1974
    Routine: ExecConstraints
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23502: null value in column "TenantId" of relation "Products" violates not-null constraint

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23502
    MessageText: null value in column "TenantId" of relation "Products" violates not-null constraint
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: Products
    ColumnName: TenantId
    File: execMain.c
    Line: 1974
    Routine: ExecConstraints
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2024-06-12 05:02:19.343 +01:00 [INF] Executed action MyProject.Controller.ProductsController.Post (MyProject) in 687.9785ms
2024-06-12 05:02:19.349 +01:00 [INF] Executed endpoint 'MyProject.Controller.ProductsController.Post (MyProject)'
2024-06-12 05:02:19.355 +01:00 [ERR] HTTP POST /api/product responded 500 in 774.3047 ms
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23502: null value in column "TenantId" of relation "Products" violates not-null constraint

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23502
    MessageText: null value in column "TenantId" of relation "Products" violates not-null constraint
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: Products
    ColumnName: TenantId
    File: execMain.c
    Line: 1974
    Routine: ExecConstraints
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at MyProject.Repository.ProductService.CreateProduct(CreateProductRequest request) in C:\Users\ARthur\Desktop\projects\personal\MyProject\Repository\ProductService.cs:line 42
   at MyProject.Controller.ProductsController.Post(CreateProductRequest request) in C:\Users\ARthur\Desktop\projects\personal\MyProject\Controller\ProductsController.cs:line 34
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2024-06-12 05:02:19.419 +01:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23502: null value in column "TenantId" of relation "Products" violates not-null constraint

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23502
    MessageText: null value in column "TenantId" of relation "Products" violates not-null constraint
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: Products
    ColumnName: TenantId
    File: execMain.c
    Line: 1974
    Routine: ExecConstraints
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at MyProject.Repository.ProductService.CreateProduct(CreateProductRequest request) in C:\Users\ARthur\Desktop\projects\personal\MyProject\Repository\ProductService.cs:line 42
   at MyProject.Controller.ProductsController.Post(CreateProductRequest request) in C:\Users\ARthur\Desktop\projects\personal\MyProject\Controller\ProductsController.cs:line 34
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at MyProject.Middleware.TenantResolver.InvokeAsync(HttpContext context, ICurrentTenantService currentTenantService) in C:\Users\ARthur\Desktop\projects\personal\MyProject\Middleware\TenantResolver.cs:line 28
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2024-06-12 05:02:19.496 +01:00 [DBG] Connection id "0HN4AIHOURKJE" completed keep alive response.
2024-06-12 05:02:19.982 +01:00 [DBG] 'AppDbContext' disposed.
2024-06-12 05:02:19.996 +01:00 [DBG] Disposing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 05:02:20.003 +01:00 [DBG] Disposed connection to database 'userservice_db' on server 'tcp://localhost:5432' (7ms).
2024-06-12 05:02:20.009 +01:00 [DBG] 'TenantDbContext' disposed.
2024-06-12 05:02:20.011 +01:00 [DBG] Disposing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 05:02:20.013 +01:00 [DBG] Disposed connection to database 'userservice_db' on server 'tcp://localhost:5432' (1ms).
2024-06-12 05:02:20.018 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5165/api/product - 500 null text/plain; charset=utf-8 4791.4513ms
2024-06-12 05:04:31.337 +01:00 [DBG] Connection id "0HN4AIHOURKJE" disconnecting.
2024-06-12 05:04:31.343 +01:00 [DBG] Connection id "0HN4AIHOURKJE" stopped.
2024-06-12 05:04:31.354 +01:00 [DBG] Connection id "0HN4AIHOURKJE" sending FIN because: "The Socket transport's send loop completed gracefully."
2024-06-12 05:04:48.601 +01:00 [INF] Application is shutting down...
2024-06-12 05:04:48.604 +01:00 [DBG] Hosting stopping
2024-06-12 05:04:48.618 +01:00 [DBG] Hosting stopped
2024-06-12 05:04:57.808 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2024-06-12 05:04:58.191 +01:00 [DBG] Hosting starting
2024-06-12 05:04:58.401 +01:00 [INF] Now listening on: http://localhost:5165
2024-06-12 05:04:58.417 +01:00 [DBG] Loaded hosting startup assembly MyProject
2024-06-12 05:04:58.418 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2024-06-12 05:04:58.421 +01:00 [INF] Hosting environment: Development
2024-06-12 05:04:58.422 +01:00 [INF] Content root path: C:\Users\ARthur\Desktop\projects\personal\MyProject
2024-06-12 05:04:58.424 +01:00 [DBG] Hosting started
2024-06-12 05:05:19.165 +01:00 [DBG] Connection id "0HN4AIJFQ8IQS" accepted.
2024-06-12 05:05:19.169 +01:00 [DBG] Connection id "0HN4AIJFQ8IQS" started.
2024-06-12 05:05:19.222 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5165/api/product - application/json 37
2024-06-12 05:05:19.236 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2024-06-12 05:05:19.273 +01:00 [DBG] 1 candidate(s) found for the request path '/api/product'
2024-06-12 05:05:19.284 +01:00 [DBG] Endpoint 'MyProject.Controller.ProductsController.Post (MyProject)' with route pattern 'api/product' is valid for the request path '/api/product'
2024-06-12 05:05:19.288 +01:00 [DBG] Request matched endpoint 'MyProject.Controller.ProductsController.Post (MyProject)'
2024-06-12 05:05:19.314 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2024-06-12 05:05:19.506 +01:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2024-06-12 05:05:21.053 +01:00 [DBG] Entity Framework Core 8.0.6 initialized 'TenantDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2024-06-12 05:05:21.204 +01:00 [DBG] Compiling query expression: 
'DbSet<Tenant>()
    .Where(x => x.Id == __tenant_0)
    .FirstOrDefault()'
2024-06-12 05:05:21.730 +01:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Tenant>(
    asyncEnumerable: new SingleQueryingEnumerable<Tenant>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Tenant.Id (string) Required PK AfterSave:Throw, 0], [Property: Tenant.Name (string) Required, 1] }
            SELECT TOP(1) t.Id, t.Name
            FROM Tenants AS t
            WHERE t.Id == @__tenant_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Tenant>, 
        MyProject.Data.TenantDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2024-06-12 05:05:21.806 +01:00 [DBG] Creating DbConnection.
2024-06-12 05:05:21.862 +01:00 [DBG] Created DbConnection. (49ms).
2024-06-12 05:05:21.872 +01:00 [DBG] Opening connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 05:05:22.263 +01:00 [DBG] Opened connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 05:05:22.286 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-06-12 05:05:22.312 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (16ms).
2024-06-12 05:05:22.327 +01:00 [DBG] Initialized DbCommand for 'ExecuteReader' (41ms).
2024-06-12 05:05:22.350 +01:00 [DBG] Executing DbCommand [Parameters=[@__tenant_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Name"
FROM "Tenants" AS t
WHERE t."Id" = @__tenant_0
LIMIT 1
2024-06-12 05:05:22.567 +01:00 [INF] Executed DbCommand (207ms) [Parameters=[@__tenant_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Name"
FROM "Tenants" AS t
WHERE t."Id" = @__tenant_0
LIMIT 1
2024-06-12 05:05:22.770 +01:00 [DBG] Context 'TenantDbContext' started tracking 'Tenant' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 05:05:22.828 +01:00 [DBG] Closing data reader to 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 05:05:22.854 +01:00 [DBG] A data reader for 'userservice_db' on server 'tcp://localhost:5432' is being disposed after spending 181ms reading results.
2024-06-12 05:05:22.869 +01:00 [DBG] Closing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 05:05:22.885 +01:00 [DBG] Closed connection to database 'userservice_db' on server 'tcp://localhost:5432' (15ms).
2024-06-12 05:05:22.893 +01:00 [WRN] Failed to determine the https port for redirect.
2024-06-12 05:05:22.896 +01:00 [INF] Executing endpoint 'MyProject.Controller.ProductsController.Post (MyProject)'
2024-06-12 05:05:22.925 +01:00 [INF] Route matched with {action = "Post", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Post(MyProject.DTOs.CreateProductRequest) on controller MyProject.Controller.ProductsController (MyProject).
2024-06-12 05:05:22.931 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2024-06-12 05:05:22.935 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2024-06-12 05:05:22.939 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2024-06-12 05:05:22.944 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2024-06-12 05:05:22.948 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2024-06-12 05:05:22.952 +01:00 [DBG] Executing controller factory for controller MyProject.Controller.ProductsController (MyProject)
2024-06-12 05:05:22.962 +01:00 [DBG] Executed controller factory for controller MyProject.Controller.ProductsController (MyProject)
2024-06-12 05:05:22.970 +01:00 [DBG] Attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest' ...
2024-06-12 05:05:22.977 +01:00 [DBG] Attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest' using the name '' in request data ...
2024-06-12 05:05:22.982 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2024-06-12 05:05:23.017 +01:00 [DBG] Connection id "0HN4AIJFQ8IQS", Request id "0HN4AIJFQ8IQS:00000001": started reading request body.
2024-06-12 05:05:23.021 +01:00 [DBG] Connection id "0HN4AIJFQ8IQS", Request id "0HN4AIJFQ8IQS:00000001": done reading request body.
2024-06-12 05:05:23.033 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'MyProject.DTOs.CreateProductRequest'
2024-06-12 05:05:23.036 +01:00 [DBG] Done attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest'.
2024-06-12 05:05:23.039 +01:00 [DBG] Done attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest'.
2024-06-12 05:05:23.042 +01:00 [DBG] Attempting to validate the bound parameter 'request' of type 'MyProject.DTOs.CreateProductRequest' ...
2024-06-12 05:05:23.054 +01:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'MyProject.DTOs.CreateProductRequest'.
2024-06-12 05:05:23.169 +01:00 [DBG] Entity Framework Core 8.0.6 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2024-06-12 05:05:23.228 +01:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Product.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 05:05:23.270 +01:00 [DBG] Context 'AppDbContext' started tracking 'Product' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 05:05:23.278 +01:00 [INF] Tenant from header context: beta
2024-06-12 05:05:23.283 +01:00 [DBG] DetectChanges starting for 'AppDbContext'.
2024-06-12 05:05:23.305 +01:00 [DBG] DetectChanges completed for 'AppDbContext'.
2024-06-12 05:05:23.314 +01:00 [DBG] SaveChanges starting for 'AppDbContext'.
2024-06-12 05:05:23.319 +01:00 [DBG] DetectChanges starting for 'AppDbContext'.
2024-06-12 05:05:23.322 +01:00 [DBG] DetectChanges completed for 'AppDbContext'.
2024-06-12 05:05:23.438 +01:00 [DBG] Creating DbConnection.
2024-06-12 05:05:23.445 +01:00 [DBG] Created DbConnection. (7ms).
2024-06-12 05:05:23.448 +01:00 [DBG] Opening connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 05:05:23.451 +01:00 [DBG] Opened connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 05:05:23.461 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-06-12 05:05:23.468 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (7ms).
2024-06-12 05:05:23.479 +01:00 [DBG] Initialized DbCommand for 'ExecuteReader' (18ms).
2024-06-12 05:05:23.485 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?' (DbType = Decimal), @p2='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Products" ("Name", "Price", "TenantId")
VALUES (@p0, @p1, @p2)
RETURNING "Id";
2024-06-12 05:05:23.531 +01:00 [ERR] Failed executing DbCommand (44ms) [Parameters=[@p0='?', @p1='?' (DbType = Decimal), @p2='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Products" ("Name", "Price", "TenantId")
VALUES (@p0, @p1, @p2)
RETURNING "Id";
2024-06-12 05:05:23.562 +01:00 [DBG] Closing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 05:05:23.565 +01:00 [DBG] Closed connection to database 'userservice_db' on server 'tcp://localhost:5432' (2ms).
2024-06-12 05:05:23.605 +01:00 [ERR] An exception occurred in the database while saving changes for context type 'MyProject.Data.AppDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23502: null value in column "TenantId" of relation "Products" violates not-null constraint

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23502
    MessageText: null value in column "TenantId" of relation "Products" violates not-null constraint
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: Products
    ColumnName: TenantId
    File: execMain.c
    Line: 1974
    Routine: ExecConstraints
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23502: null value in column "TenantId" of relation "Products" violates not-null constraint

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23502
    MessageText: null value in column "TenantId" of relation "Products" violates not-null constraint
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: Products
    ColumnName: TenantId
    File: execMain.c
    Line: 1974
    Routine: ExecConstraints
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2024-06-12 05:05:23.664 +01:00 [INF] Executed action MyProject.Controller.ProductsController.Post (MyProject) in 703.5839ms
2024-06-12 05:05:23.846 +01:00 [INF] Executed endpoint 'MyProject.Controller.ProductsController.Post (MyProject)'
2024-06-12 05:05:23.854 +01:00 [ERR] HTTP POST /api/product responded 500 in 961.1808 ms
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23502: null value in column "TenantId" of relation "Products" violates not-null constraint

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23502
    MessageText: null value in column "TenantId" of relation "Products" violates not-null constraint
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: Products
    ColumnName: TenantId
    File: execMain.c
    Line: 1974
    Routine: ExecConstraints
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at MyProject.Data.AppDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\ARthur\Desktop\projects\personal\MyProject\Data\AppDbContext.cs:line 62
   at MyProject.Repository.ProductService.CreateProduct(CreateProductRequest request) in C:\Users\ARthur\Desktop\projects\personal\MyProject\Repository\ProductService.cs:line 42
   at MyProject.Controller.ProductsController.Post(CreateProductRequest request) in C:\Users\ARthur\Desktop\projects\personal\MyProject\Controller\ProductsController.cs:line 34
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2024-06-12 05:05:23.966 +01:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23502: null value in column "TenantId" of relation "Products" violates not-null constraint

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23502
    MessageText: null value in column "TenantId" of relation "Products" violates not-null constraint
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: Products
    ColumnName: TenantId
    File: execMain.c
    Line: 1974
    Routine: ExecConstraints
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at MyProject.Data.AppDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\ARthur\Desktop\projects\personal\MyProject\Data\AppDbContext.cs:line 62
   at MyProject.Repository.ProductService.CreateProduct(CreateProductRequest request) in C:\Users\ARthur\Desktop\projects\personal\MyProject\Repository\ProductService.cs:line 42
   at MyProject.Controller.ProductsController.Post(CreateProductRequest request) in C:\Users\ARthur\Desktop\projects\personal\MyProject\Controller\ProductsController.cs:line 34
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at MyProject.Middleware.TenantResolver.InvokeAsync(HttpContext context, ICurrentTenantService currentTenantService) in C:\Users\ARthur\Desktop\projects\personal\MyProject\Middleware\TenantResolver.cs:line 28
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2024-06-12 05:05:24.030 +01:00 [DBG] Connection id "0HN4AIJFQ8IQS" completed keep alive response.
2024-06-12 05:05:24.042 +01:00 [DBG] 'AppDbContext' disposed.
2024-06-12 05:05:24.054 +01:00 [DBG] Disposing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 05:05:24.066 +01:00 [DBG] Disposed connection to database 'userservice_db' on server 'tcp://localhost:5432' (10ms).
2024-06-12 05:05:24.070 +01:00 [DBG] 'TenantDbContext' disposed.
2024-06-12 05:05:24.075 +01:00 [DBG] Disposing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 05:05:24.083 +01:00 [DBG] Disposed connection to database 'userservice_db' on server 'tcp://localhost:5432' (7ms).
2024-06-12 05:05:24.086 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5165/api/product - 500 null text/plain; charset=utf-8 4865.8518ms
2024-06-12 05:07:34.695 +01:00 [DBG] Connection id "0HN4AIJFQ8IQS" disconnecting.
2024-06-12 05:07:34.703 +01:00 [DBG] Connection id "0HN4AIJFQ8IQS" stopped.
2024-06-12 05:07:34.709 +01:00 [DBG] Connection id "0HN4AIJFQ8IQS" sending FIN because: "The Socket transport's send loop completed gracefully."
2024-06-12 05:12:16.450 +01:00 [INF] Application is shutting down...
2024-06-12 05:12:16.453 +01:00 [DBG] Hosting stopping
2024-06-12 05:12:16.464 +01:00 [DBG] Hosting stopped
2024-06-12 05:12:24.051 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2024-06-12 05:12:24.173 +01:00 [DBG] Hosting starting
2024-06-12 05:12:24.248 +01:00 [INF] Now listening on: http://localhost:5165
2024-06-12 05:12:24.264 +01:00 [DBG] Loaded hosting startup assembly MyProject
2024-06-12 05:12:24.267 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2024-06-12 05:12:24.269 +01:00 [INF] Hosting environment: Development
2024-06-12 05:12:24.271 +01:00 [INF] Content root path: C:\Users\ARthur\Desktop\projects\personal\MyProject
2024-06-12 05:12:24.273 +01:00 [DBG] Hosting started
2024-06-12 05:12:50.247 +01:00 [DBG] Connection id "0HN4AINM83THR" accepted.
2024-06-12 05:12:50.251 +01:00 [DBG] Connection id "0HN4AINM83THR" started.
2024-06-12 05:12:50.287 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5165/api/product - application/json 37
2024-06-12 05:12:50.300 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2024-06-12 05:12:50.331 +01:00 [DBG] 1 candidate(s) found for the request path '/api/product'
2024-06-12 05:12:50.336 +01:00 [DBG] Endpoint 'MyProject.Controller.ProductsController.Post (MyProject)' with route pattern 'api/product' is valid for the request path '/api/product'
2024-06-12 05:12:50.342 +01:00 [DBG] Request matched endpoint 'MyProject.Controller.ProductsController.Post (MyProject)'
2024-06-12 05:12:50.361 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2024-06-12 05:12:50.470 +01:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2024-06-12 05:12:51.207 +01:00 [DBG] Entity Framework Core 8.0.6 initialized 'TenantDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2024-06-12 05:12:51.280 +01:00 [DBG] Compiling query expression: 
'DbSet<Tenant>()
    .Where(x => x.Id == __tenant_0)
    .FirstOrDefault()'
2024-06-12 05:12:51.608 +01:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Tenant>(
    asyncEnumerable: new SingleQueryingEnumerable<Tenant>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Tenant.Id (string) Required PK AfterSave:Throw, 0], [Property: Tenant.Name (string) Required, 1] }
            SELECT TOP(1) t.Id, t.Name
            FROM Tenants AS t
            WHERE t.Id == @__tenant_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Tenant>, 
        MyProject.Data.TenantDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2024-06-12 05:12:51.661 +01:00 [DBG] Creating DbConnection.
2024-06-12 05:12:51.726 +01:00 [DBG] Created DbConnection. (58ms).
2024-06-12 05:12:51.746 +01:00 [DBG] Opening connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 05:12:52.099 +01:00 [DBG] Opened connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 05:12:52.120 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-06-12 05:12:52.137 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (11ms).
2024-06-12 05:12:52.149 +01:00 [DBG] Initialized DbCommand for 'ExecuteReader' (29ms).
2024-06-12 05:12:52.167 +01:00 [DBG] Executing DbCommand [Parameters=[@__tenant_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Name"
FROM "Tenants" AS t
WHERE t."Id" = @__tenant_0
LIMIT 1
2024-06-12 05:12:52.252 +01:00 [INF] Executed DbCommand (92ms) [Parameters=[@__tenant_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Name"
FROM "Tenants" AS t
WHERE t."Id" = @__tenant_0
LIMIT 1
2024-06-12 05:12:52.305 +01:00 [DBG] Context 'TenantDbContext' started tracking 'Tenant' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 05:12:52.333 +01:00 [DBG] Closing data reader to 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 05:12:52.349 +01:00 [DBG] A data reader for 'userservice_db' on server 'tcp://localhost:5432' is being disposed after spending 86ms reading results.
2024-06-12 05:12:52.358 +01:00 [DBG] Closing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 05:12:52.366 +01:00 [DBG] Closed connection to database 'userservice_db' on server 'tcp://localhost:5432' (8ms).
2024-06-12 05:12:52.373 +01:00 [WRN] Failed to determine the https port for redirect.
2024-06-12 05:12:52.376 +01:00 [INF] Executing endpoint 'MyProject.Controller.ProductsController.Post (MyProject)'
2024-06-12 05:12:52.408 +01:00 [INF] Route matched with {action = "Post", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Post(MyProject.DTOs.CreateProductRequest) on controller MyProject.Controller.ProductsController (MyProject).
2024-06-12 05:12:52.415 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2024-06-12 05:12:52.418 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2024-06-12 05:12:52.425 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2024-06-12 05:12:52.428 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2024-06-12 05:12:52.430 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2024-06-12 05:12:52.435 +01:00 [DBG] Executing controller factory for controller MyProject.Controller.ProductsController (MyProject)
2024-06-12 05:12:52.443 +01:00 [DBG] Executed controller factory for controller MyProject.Controller.ProductsController (MyProject)
2024-06-12 05:12:52.452 +01:00 [DBG] Attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest' ...
2024-06-12 05:12:52.460 +01:00 [DBG] Attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest' using the name '' in request data ...
2024-06-12 05:12:52.465 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2024-06-12 05:12:52.499 +01:00 [DBG] Connection id "0HN4AINM83THR", Request id "0HN4AINM83THR:00000001": started reading request body.
2024-06-12 05:12:52.502 +01:00 [DBG] Connection id "0HN4AINM83THR", Request id "0HN4AINM83THR:00000001": done reading request body.
2024-06-12 05:12:52.515 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'MyProject.DTOs.CreateProductRequest'
2024-06-12 05:12:52.517 +01:00 [DBG] Done attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest'.
2024-06-12 05:12:52.520 +01:00 [DBG] Done attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest'.
2024-06-12 05:12:52.524 +01:00 [DBG] Attempting to validate the bound parameter 'request' of type 'MyProject.DTOs.CreateProductRequest' ...
2024-06-12 05:12:52.545 +01:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'MyProject.DTOs.CreateProductRequest'.
2024-06-12 05:12:52.614 +01:00 [DBG] Entity Framework Core 8.0.6 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2024-06-12 05:12:52.659 +01:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Product.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 05:12:52.704 +01:00 [DBG] Context 'AppDbContext' started tracking 'Product' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 05:12:52.712 +01:00 [INF] Tenant from header context: beta
2024-06-12 05:12:52.718 +01:00 [DBG] DetectChanges starting for 'AppDbContext'.
2024-06-12 05:12:52.739 +01:00 [DBG] DetectChanges completed for 'AppDbContext'.
2024-06-12 05:12:52.747 +01:00 [INF] Entity state: Added
2024-06-12 05:12:52.753 +01:00 [DBG] SaveChanges starting for 'AppDbContext'.
2024-06-12 05:12:52.758 +01:00 [DBG] DetectChanges starting for 'AppDbContext'.
2024-06-12 05:12:52.761 +01:00 [DBG] DetectChanges completed for 'AppDbContext'.
2024-06-12 05:12:52.863 +01:00 [DBG] Creating DbConnection.
2024-06-12 05:12:52.865 +01:00 [DBG] Created DbConnection. (1ms).
2024-06-12 05:12:52.867 +01:00 [DBG] Opening connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 05:12:52.873 +01:00 [DBG] Opened connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 05:12:52.878 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-06-12 05:12:52.880 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2024-06-12 05:12:52.882 +01:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2024-06-12 05:12:52.884 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?' (DbType = Decimal), @p2='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Products" ("Name", "Price", "TenantId")
VALUES (@p0, @p1, @p2)
RETURNING "Id";
2024-06-12 05:12:52.912 +01:00 [ERR] Failed executing DbCommand (26ms) [Parameters=[@p0='?', @p1='?' (DbType = Decimal), @p2='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Products" ("Name", "Price", "TenantId")
VALUES (@p0, @p1, @p2)
RETURNING "Id";
2024-06-12 05:12:52.926 +01:00 [DBG] Closing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 05:12:52.929 +01:00 [DBG] Closed connection to database 'userservice_db' on server 'tcp://localhost:5432' (2ms).
2024-06-12 05:12:52.952 +01:00 [ERR] An exception occurred in the database while saving changes for context type 'MyProject.Data.AppDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23502: null value in column "TenantId" of relation "Products" violates not-null constraint

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23502
    MessageText: null value in column "TenantId" of relation "Products" violates not-null constraint
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: Products
    ColumnName: TenantId
    File: execMain.c
    Line: 1974
    Routine: ExecConstraints
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23502: null value in column "TenantId" of relation "Products" violates not-null constraint

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23502
    MessageText: null value in column "TenantId" of relation "Products" violates not-null constraint
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: Products
    ColumnName: TenantId
    File: execMain.c
    Line: 1974
    Routine: ExecConstraints
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2024-06-12 05:12:52.977 +01:00 [ERR] Error saving changes
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23502: null value in column "TenantId" of relation "Products" violates not-null constraint

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23502
    MessageText: null value in column "TenantId" of relation "Products" violates not-null constraint
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: Products
    ColumnName: TenantId
    File: execMain.c
    Line: 1974
    Routine: ExecConstraints
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at MyProject.Data.AppDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\ARthur\Desktop\projects\personal\MyProject\Data\AppDbContext.cs:line 65
2024-06-12 05:12:53.017 +01:00 [INF] Executed action MyProject.Controller.ProductsController.Post (MyProject) in 578.7875ms
2024-06-12 05:12:53.023 +01:00 [INF] Executed endpoint 'MyProject.Controller.ProductsController.Post (MyProject)'
2024-06-12 05:12:53.028 +01:00 [ERR] HTTP POST /api/product responded 500 in 654.9502 ms
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23502: null value in column "TenantId" of relation "Products" violates not-null constraint

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23502
    MessageText: null value in column "TenantId" of relation "Products" violates not-null constraint
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: Products
    ColumnName: TenantId
    File: execMain.c
    Line: 1974
    Routine: ExecConstraints
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at MyProject.Data.AppDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\ARthur\Desktop\projects\personal\MyProject\Data\AppDbContext.cs:line 65
   at MyProject.Repository.ProductService.CreateProduct(CreateProductRequest request) in C:\Users\ARthur\Desktop\projects\personal\MyProject\Repository\ProductService.cs:line 42
   at MyProject.Controller.ProductsController.Post(CreateProductRequest request) in C:\Users\ARthur\Desktop\projects\personal\MyProject\Controller\ProductsController.cs:line 34
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2024-06-12 05:12:53.061 +01:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23502: null value in column "TenantId" of relation "Products" violates not-null constraint

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23502
    MessageText: null value in column "TenantId" of relation "Products" violates not-null constraint
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: Products
    ColumnName: TenantId
    File: execMain.c
    Line: 1974
    Routine: ExecConstraints
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at MyProject.Data.AppDbContext.SaveChangesAsync(CancellationToken cancellationToken) in C:\Users\ARthur\Desktop\projects\personal\MyProject\Data\AppDbContext.cs:line 65
   at MyProject.Repository.ProductService.CreateProduct(CreateProductRequest request) in C:\Users\ARthur\Desktop\projects\personal\MyProject\Repository\ProductService.cs:line 42
   at MyProject.Controller.ProductsController.Post(CreateProductRequest request) in C:\Users\ARthur\Desktop\projects\personal\MyProject\Controller\ProductsController.cs:line 34
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at MyProject.Middleware.TenantResolver.InvokeAsync(HttpContext context, ICurrentTenantService currentTenantService) in C:\Users\ARthur\Desktop\projects\personal\MyProject\Middleware\TenantResolver.cs:line 28
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2024-06-12 05:12:53.118 +01:00 [DBG] Connection id "0HN4AINM83THR" completed keep alive response.
2024-06-12 05:12:53.279 +01:00 [DBG] 'AppDbContext' disposed.
2024-06-12 05:12:53.296 +01:00 [DBG] Disposing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 05:12:53.301 +01:00 [DBG] Disposed connection to database 'userservice_db' on server 'tcp://localhost:5432' (7ms).
2024-06-12 05:12:53.306 +01:00 [DBG] 'TenantDbContext' disposed.
2024-06-12 05:12:53.308 +01:00 [DBG] Disposing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 05:12:53.310 +01:00 [DBG] Disposed connection to database 'userservice_db' on server 'tcp://localhost:5432' (1ms).
2024-06-12 05:12:53.313 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5165/api/product - 500 null text/plain; charset=utf-8 3026.3674ms
2024-06-12 05:15:03.552 +01:00 [DBG] Connection id "0HN4AINM83THR" disconnecting.
2024-06-12 05:15:03.556 +01:00 [DBG] Connection id "0HN4AINM83THR" stopped.
2024-06-12 05:15:03.559 +01:00 [DBG] Connection id "0HN4AINM83THR" sending FIN because: "The Socket transport's send loop completed gracefully."
2024-06-12 06:53:11.521 +01:00 [INF] Application is shutting down...
2024-06-12 06:53:11.526 +01:00 [DBG] Hosting stopping
2024-06-12 06:53:11.538 +01:00 [DBG] Hosting stopped
2024-06-12 07:41:02.517 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2024-06-12 07:41:02.900 +01:00 [DBG] Hosting starting
2024-06-12 07:41:03.012 +01:00 [INF] Now listening on: http://localhost:5165
2024-06-12 07:41:03.025 +01:00 [DBG] Loaded hosting startup assembly MyProject
2024-06-12 07:41:03.029 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2024-06-12 07:41:03.035 +01:00 [INF] Hosting environment: Development
2024-06-12 07:41:03.037 +01:00 [INF] Content root path: C:\Users\ARthur\Desktop\projects\personal\MyProject
2024-06-12 07:41:03.040 +01:00 [DBG] Hosting started
2024-06-12 07:42:08.072 +01:00 [DBG] Connection id "0HN4ALB3SJ2B3" accepted.
2024-06-12 07:42:08.076 +01:00 [DBG] Connection id "0HN4ALB3SJ2B3" started.
2024-06-12 07:42:08.136 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5165/api/product - application/json 37
2024-06-12 07:42:08.153 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2024-06-12 07:42:08.208 +01:00 [DBG] 1 candidate(s) found for the request path '/api/product'
2024-06-12 07:42:08.239 +01:00 [DBG] Endpoint 'MyProject.Controller.ProductsController.Get (MyProject)' with route pattern 'api/product' is valid for the request path '/api/product'
2024-06-12 07:42:08.249 +01:00 [DBG] Request matched endpoint 'MyProject.Controller.ProductsController.Get (MyProject)'
2024-06-12 07:42:08.314 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2024-06-12 07:42:08.646 +01:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2024-06-12 07:42:10.151 +01:00 [DBG] Entity Framework Core 8.0.6 initialized 'TenantDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2024-06-12 07:42:10.311 +01:00 [DBG] Compiling query expression: 
'DbSet<Tenant>()
    .Where(x => x.Id == __tenant_0)
    .FirstOrDefault()'
2024-06-12 07:42:10.811 +01:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Tenant>(
    asyncEnumerable: new SingleQueryingEnumerable<Tenant>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Tenant.Id (string) Required PK AfterSave:Throw, 0], [Property: Tenant.Name (string) Required, 1] }
            SELECT TOP(1) t.Id, t.Name
            FROM Tenants AS t
            WHERE t.Id == @__tenant_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Tenant>, 
        MyProject.Data.TenantDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2024-06-12 07:42:10.979 +01:00 [DBG] Creating DbConnection.
2024-06-12 07:42:11.071 +01:00 [DBG] Created DbConnection. (90ms).
2024-06-12 07:42:11.087 +01:00 [DBG] Opening connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 07:42:11.455 +01:00 [DBG] Opened connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 07:42:11.467 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-06-12 07:42:11.482 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (9ms).
2024-06-12 07:42:11.500 +01:00 [DBG] Initialized DbCommand for 'ExecuteReader' (33ms).
2024-06-12 07:42:11.519 +01:00 [DBG] Executing DbCommand [Parameters=[@__tenant_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Name"
FROM "Tenants" AS t
WHERE t."Id" = @__tenant_0
LIMIT 1
2024-06-12 07:42:11.640 +01:00 [INF] Executed DbCommand (126ms) [Parameters=[@__tenant_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Name"
FROM "Tenants" AS t
WHERE t."Id" = @__tenant_0
LIMIT 1
2024-06-12 07:42:11.737 +01:00 [DBG] Context 'TenantDbContext' started tracking 'Tenant' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 07:42:11.780 +01:00 [DBG] Closing data reader to 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 07:42:11.804 +01:00 [DBG] A data reader for 'userservice_db' on server 'tcp://localhost:5432' is being disposed after spending 149ms reading results.
2024-06-12 07:42:11.834 +01:00 [DBG] Closing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 07:42:11.850 +01:00 [DBG] Closed connection to database 'userservice_db' on server 'tcp://localhost:5432' (15ms).
2024-06-12 07:42:11.886 +01:00 [WRN] Failed to determine the https port for redirect.
2024-06-12 07:42:11.900 +01:00 [INF] Executing endpoint 'MyProject.Controller.ProductsController.Get (MyProject)'
2024-06-12 07:42:11.932 +01:00 [INF] Route matched with {action = "Get", controller = "Products"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Get() on controller MyProject.Controller.ProductsController (MyProject).
2024-06-12 07:42:11.940 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2024-06-12 07:42:11.948 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2024-06-12 07:42:11.953 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2024-06-12 07:42:11.964 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2024-06-12 07:42:11.967 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2024-06-12 07:42:11.972 +01:00 [DBG] Executing controller factory for controller MyProject.Controller.ProductsController (MyProject)
2024-06-12 07:42:11.986 +01:00 [DBG] Executed controller factory for controller MyProject.Controller.ProductsController (MyProject)
2024-06-12 07:42:12.502 +01:00 [DBG] Entity Framework Core 8.0.6 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2024-06-12 07:42:12.524 +01:00 [DBG] Compiling query expression: 
'DbSet<Product>()'
2024-06-12 07:42:12.553 +01:00 [DBG] Generated query execution expression: 
'queryContext => 
{
    queryContext.AddParameter(
        name: "__ef_filter__CurrentTenantId_0", 
        value: (object)Invoke(queryContext => ((AppDbContext)queryContext.Context).CurrentTenantId, queryContext));
    return new SingleQueryingEnumerable<Product>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Product.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Product.Name (string) Required, 1], [Property: Product.Price (decimal) Required, 2], [Property: Product.TenantId (string) Required, 3] }
            SELECT p.Id, p.Name, p.Price, p.TenantId
            FROM Products AS p
            WHERE p.TenantId == @__ef_filter__CurrentTenantId_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Product>, 
        MyProject.Data.AppDbContext, 
        False, 
        False, 
        True
    );
}'
2024-06-12 07:42:12.568 +01:00 [DBG] Creating DbConnection.
2024-06-12 07:42:12.571 +01:00 [DBG] Created DbConnection. (2ms).
2024-06-12 07:42:12.577 +01:00 [DBG] Opening connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 07:42:12.583 +01:00 [DBG] Opened connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 07:42:12.586 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-06-12 07:42:12.589 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2024-06-12 07:42:12.597 +01:00 [DBG] Initialized DbCommand for 'ExecuteReader' (10ms).
2024-06-12 07:42:12.602 +01:00 [DBG] Executing DbCommand [Parameters=[@__ef_filter__CurrentTenantId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT p."Id", p."Name", p."Price", p."TenantId"
FROM "Products" AS p
WHERE p."TenantId" = @__ef_filter__CurrentTenantId_0
2024-06-12 07:42:12.617 +01:00 [INF] Executed DbCommand (16ms) [Parameters=[@__ef_filter__CurrentTenantId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT p."Id", p."Name", p."Price", p."TenantId"
FROM "Products" AS p
WHERE p."TenantId" = @__ef_filter__CurrentTenantId_0
2024-06-12 07:42:12.660 +01:00 [DBG] Context 'AppDbContext' started tracking 'Product' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 07:42:12.687 +01:00 [DBG] Context 'AppDbContext' started tracking 'Product' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 07:42:12.698 +01:00 [DBG] Context 'AppDbContext' started tracking 'Product' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 07:42:12.701 +01:00 [DBG] Context 'AppDbContext' started tracking 'Product' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 07:42:12.704 +01:00 [DBG] Context 'AppDbContext' started tracking 'Product' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 07:42:12.714 +01:00 [DBG] Closing data reader to 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 07:42:12.717 +01:00 [DBG] A data reader for 'userservice_db' on server 'tcp://localhost:5432' is being disposed after spending 95ms reading results.
2024-06-12 07:42:12.722 +01:00 [DBG] Closing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 07:42:12.743 +01:00 [DBG] Closed connection to database 'userservice_db' on server 'tcp://localhost:5432' (20ms).
2024-06-12 07:42:12.750 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2024-06-12 07:42:12.760 +01:00 [DBG] No information found on request to perform content negotiation.
2024-06-12 07:42:12.762 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2024-06-12 07:42:12.764 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2024-06-12 07:42:12.767 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2024-06-12 07:42:12.771 +01:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[MyProject.Entities.Product, MyProject, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2024-06-12 07:42:12.846 +01:00 [INF] Executed action MyProject.Controller.ProductsController.Get (MyProject) in 871.7415ms
2024-06-12 07:42:12.850 +01:00 [INF] Executed endpoint 'MyProject.Controller.ProductsController.Get (MyProject)'
2024-06-12 07:42:12.855 +01:00 [INF] HTTP GET /api/product responded 200 in 968.6114 ms
2024-06-12 07:42:12.865 +01:00 [DBG] Connection id "0HN4ALB3SJ2B3" completed keep alive response.
2024-06-12 07:42:12.877 +01:00 [DBG] 'AppDbContext' disposed.
2024-06-12 07:42:12.889 +01:00 [DBG] Disposing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 07:42:12.900 +01:00 [DBG] Disposed connection to database 'userservice_db' on server 'tcp://localhost:5432' (11ms).
2024-06-12 07:42:12.904 +01:00 [DBG] 'TenantDbContext' disposed.
2024-06-12 07:42:12.910 +01:00 [DBG] Disposing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 07:42:12.913 +01:00 [DBG] Disposed connection to database 'userservice_db' on server 'tcp://localhost:5432' (3ms).
2024-06-12 07:42:12.921 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5165/api/product - 200 null application/json; charset=utf-8 4786.2547ms
2024-06-12 07:42:12.933 +01:00 [DBG] Connection id "0HN4ALB3SJ2B3", Request id "0HN4ALB3SJ2B3:00000001": started reading request body.
2024-06-12 07:42:12.936 +01:00 [DBG] Connection id "0HN4ALB3SJ2B3", Request id "0HN4ALB3SJ2B3:00000001": done reading request body.
2024-06-12 07:43:22.699 +01:00 [INF] Application is shutting down...
2024-06-12 07:43:22.701 +01:00 [DBG] Hosting stopping
2024-06-12 07:43:22.712 +01:00 [DBG] Connection id "0HN4ALB3SJ2B3" disconnecting.
2024-06-12 07:43:22.716 +01:00 [DBG] Connection id "0HN4ALB3SJ2B3" stopped.
2024-06-12 07:43:22.718 +01:00 [DBG] Connection id "0HN4ALB3SJ2B3" sending FIN because: "The Socket transport's send loop completed gracefully."
2024-06-12 07:43:22.728 +01:00 [DBG] Hosting stopped
2024-06-12 07:43:43.503 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2024-06-12 07:43:43.925 +01:00 [DBG] Hosting starting
2024-06-12 07:43:44.324 +01:00 [INF] Now listening on: http://localhost:5165
2024-06-12 07:43:44.343 +01:00 [DBG] Loaded hosting startup assembly MyProject
2024-06-12 07:43:44.345 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2024-06-12 07:43:44.354 +01:00 [INF] Hosting environment: Development
2024-06-12 07:43:44.358 +01:00 [INF] Content root path: C:\Users\ARthur\Desktop\projects\personal\MyProject
2024-06-12 07:43:44.361 +01:00 [DBG] Hosting started
2024-06-12 07:43:47.647 +01:00 [DBG] Connection id "0HN4ALC1I6V75" accepted.
2024-06-12 07:43:47.652 +01:00 [DBG] Connection id "0HN4ALC1I6V75" started.
2024-06-12 07:43:47.733 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5165/api/product - application/json 37
2024-06-12 07:43:47.757 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2024-06-12 07:43:47.851 +01:00 [DBG] 1 candidate(s) found for the request path '/api/product'
2024-06-12 07:43:48.014 +01:00 [DBG] Endpoint 'MyProject.Controller.ProductsController.Get (MyProject)' with route pattern 'api/product' is valid for the request path '/api/product'
2024-06-12 07:43:48.148 +01:00 [DBG] Request matched endpoint 'MyProject.Controller.ProductsController.Get (MyProject)'
2024-06-12 07:43:48.211 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2024-06-12 07:43:48.503 +01:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2024-06-12 07:43:49.965 +01:00 [DBG] Entity Framework Core 8.0.6 initialized 'TenantDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2024-06-12 07:43:50.066 +01:00 [DBG] Compiling query expression: 
'DbSet<Tenant>()
    .Where(x => x.Id == __tenant_0)
    .FirstOrDefault()'
2024-06-12 07:43:50.663 +01:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Tenant>(
    asyncEnumerable: new SingleQueryingEnumerable<Tenant>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Tenant.Id (string) Required PK AfterSave:Throw, 0], [Property: Tenant.Name (string) Required, 1] }
            SELECT TOP(1) t.Id, t.Name
            FROM Tenants AS t
            WHERE t.Id == @__tenant_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Tenant>, 
        MyProject.Data.TenantDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2024-06-12 07:43:51.065 +01:00 [DBG] Creating DbConnection.
2024-06-12 07:43:51.219 +01:00 [DBG] Created DbConnection. (137ms).
2024-06-12 07:43:51.236 +01:00 [DBG] Opening connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 07:43:51.634 +01:00 [DBG] Opened connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 07:43:51.652 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-06-12 07:43:51.670 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (9ms).
2024-06-12 07:43:51.686 +01:00 [DBG] Initialized DbCommand for 'ExecuteReader' (35ms).
2024-06-12 07:43:51.705 +01:00 [DBG] Executing DbCommand [Parameters=[@__tenant_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Name"
FROM "Tenants" AS t
WHERE t."Id" = @__tenant_0
LIMIT 1
2024-06-12 07:43:51.863 +01:00 [INF] Executed DbCommand (153ms) [Parameters=[@__tenant_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Name"
FROM "Tenants" AS t
WHERE t."Id" = @__tenant_0
LIMIT 1
2024-06-12 07:43:51.988 +01:00 [DBG] Context 'TenantDbContext' started tracking 'Tenant' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 07:43:52.040 +01:00 [DBG] Closing data reader to 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 07:43:52.069 +01:00 [DBG] A data reader for 'userservice_db' on server 'tcp://localhost:5432' is being disposed after spending 188ms reading results.
2024-06-12 07:43:52.081 +01:00 [DBG] Closing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 07:43:52.096 +01:00 [DBG] Closed connection to database 'userservice_db' on server 'tcp://localhost:5432' (13ms).
2024-06-12 07:43:52.104 +01:00 [WRN] Failed to determine the https port for redirect.
2024-06-12 07:43:52.107 +01:00 [INF] Executing endpoint 'MyProject.Controller.ProductsController.Get (MyProject)'
2024-06-12 07:43:52.136 +01:00 [INF] Route matched with {action = "Get", controller = "Products"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Get() on controller MyProject.Controller.ProductsController (MyProject).
2024-06-12 07:43:52.141 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2024-06-12 07:43:52.150 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2024-06-12 07:43:52.154 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2024-06-12 07:43:52.157 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2024-06-12 07:43:52.167 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2024-06-12 07:43:52.172 +01:00 [DBG] Executing controller factory for controller MyProject.Controller.ProductsController (MyProject)
2024-06-12 07:43:52.186 +01:00 [DBG] Executed controller factory for controller MyProject.Controller.ProductsController (MyProject)
2024-06-12 07:43:52.335 +01:00 [DBG] Entity Framework Core 8.0.6 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2024-06-12 07:43:52.346 +01:00 [DBG] Compiling query expression: 
'DbSet<Product>()'
2024-06-12 07:43:52.362 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Product>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Product.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Product.Name (string) Required, 1], [Property: Product.Price (decimal) Required, 2], [Property: Product.TenantId (string) Required, 3] }
        SELECT p.Id, p.Name, p.Price, p.TenantId
        FROM Products AS p), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Product>, 
    MyProject.Data.AppDbContext, 
    False, 
    False, 
    True
)'
2024-06-12 07:43:52.383 +01:00 [DBG] Creating DbConnection.
2024-06-12 07:43:52.386 +01:00 [DBG] Created DbConnection. (2ms).
2024-06-12 07:43:52.389 +01:00 [DBG] Opening connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 07:43:52.397 +01:00 [DBG] Opened connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 07:43:52.400 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-06-12 07:43:52.402 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2024-06-12 07:43:52.405 +01:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2024-06-12 07:43:52.413 +01:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT p."Id", p."Name", p."Price", p."TenantId"
FROM "Products" AS p
2024-06-12 07:43:52.421 +01:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT p."Id", p."Name", p."Price", p."TenantId"
FROM "Products" AS p
2024-06-12 07:43:52.456 +01:00 [DBG] Context 'AppDbContext' started tracking 'Product' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 07:43:52.487 +01:00 [DBG] Context 'AppDbContext' started tracking 'Product' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 07:43:52.489 +01:00 [DBG] Context 'AppDbContext' started tracking 'Product' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 07:43:52.491 +01:00 [DBG] Context 'AppDbContext' started tracking 'Product' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 07:43:52.498 +01:00 [DBG] Context 'AppDbContext' started tracking 'Product' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 07:43:52.504 +01:00 [DBG] Closing data reader to 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 07:43:52.507 +01:00 [DBG] A data reader for 'userservice_db' on server 'tcp://localhost:5432' is being disposed after spending 78ms reading results.
2024-06-12 07:43:52.516 +01:00 [DBG] Closing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 07:43:52.521 +01:00 [DBG] Closed connection to database 'userservice_db' on server 'tcp://localhost:5432' (4ms).
2024-06-12 07:43:52.532 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2024-06-12 07:43:52.540 +01:00 [DBG] No information found on request to perform content negotiation.
2024-06-12 07:43:52.545 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2024-06-12 07:43:52.547 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2024-06-12 07:43:52.551 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2024-06-12 07:43:52.555 +01:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[MyProject.Entities.Product, MyProject, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2024-06-12 07:43:52.659 +01:00 [INF] Executed action MyProject.Controller.ProductsController.Get (MyProject) in 481.0733ms
2024-06-12 07:43:52.668 +01:00 [INF] Executed endpoint 'MyProject.Controller.ProductsController.Get (MyProject)'
2024-06-12 07:43:52.678 +01:00 [INF] HTTP GET /api/product responded 200 in 568.0212 ms
2024-06-12 07:43:52.688 +01:00 [DBG] Connection id "0HN4ALC1I6V75" completed keep alive response.
2024-06-12 07:43:52.703 +01:00 [DBG] 'AppDbContext' disposed.
2024-06-12 07:43:52.720 +01:00 [DBG] Disposing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 07:43:52.731 +01:00 [DBG] Disposed connection to database 'userservice_db' on server 'tcp://localhost:5432' (10ms).
2024-06-12 07:43:52.736 +01:00 [DBG] 'TenantDbContext' disposed.
2024-06-12 07:43:52.738 +01:00 [DBG] Disposing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 07:43:52.745 +01:00 [DBG] Disposed connection to database 'userservice_db' on server 'tcp://localhost:5432' (6ms).
2024-06-12 07:43:52.750 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5165/api/product - 200 null application/json; charset=utf-8 5021.3847ms
2024-06-12 07:43:52.764 +01:00 [DBG] Connection id "0HN4ALC1I6V75", Request id "0HN4ALC1I6V75:00000001": started reading request body.
2024-06-12 07:43:52.767 +01:00 [DBG] Connection id "0HN4ALC1I6V75", Request id "0HN4ALC1I6V75:00000001": done reading request body.
2024-06-12 07:46:03.479 +01:00 [DBG] Connection id "0HN4ALC1I6V75" disconnecting.
2024-06-12 07:46:03.486 +01:00 [DBG] Connection id "0HN4ALC1I6V75" stopped.
2024-06-12 07:46:03.497 +01:00 [DBG] Connection id "0HN4ALC1I6V75" sending FIN because: "The Socket transport's send loop completed gracefully."
2024-06-12 07:49:58.903 +01:00 [INF] Application is shutting down...
2024-06-12 07:49:58.907 +01:00 [DBG] Hosting stopping
2024-06-12 07:49:58.937 +01:00 [DBG] Hosting stopped
2024-06-12 07:52:19.089 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2024-06-12 07:52:19.488 +01:00 [DBG] Hosting starting
2024-06-12 07:52:19.845 +01:00 [INF] Now listening on: http://localhost:5165
2024-06-12 07:52:19.846 +01:00 [DBG] Loaded hosting startup assembly MyProject
2024-06-12 07:52:19.846 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2024-06-12 07:52:19.847 +01:00 [INF] Hosting environment: Development
2024-06-12 07:52:19.847 +01:00 [INF] Content root path: C:\Users\ARthur\Desktop\projects\personal\MyProject
2024-06-12 07:52:19.848 +01:00 [DBG] Hosting started
2024-06-12 07:52:20.676 +01:00 [DBG] Connection id "0HN4ALGQEQE4S" accepted.
2024-06-12 07:52:20.692 +01:00 [DBG] Connection id "0HN4ALGQEQE4S" started.
2024-06-12 07:52:20.861 +01:00 [DBG] Connection id "0HN4ALGQEQE4T" accepted.
2024-06-12 07:52:20.868 +01:00 [DBG] Connection id "0HN4ALGQEQE4T" started.
2024-06-12 07:52:21.000 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5165/swagger - null null
2024-06-12 07:52:21.014 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2024-06-12 07:52:21.068 +01:00 [DBG] No candidates found for the request path '/swagger'
2024-06-12 07:52:21.070 +01:00 [DBG] Request did not match any endpoints
2024-06-12 07:52:21.180 +01:00 [DBG] Connection id "0HN4ALGQEQE4T" completed keep alive response.
2024-06-12 07:52:21.184 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5165/swagger - 301 0 null 187.1563ms
2024-06-12 07:52:21.224 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5165/swagger/index.html - null null
2024-06-12 07:52:21.224 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2024-06-12 07:52:21.224 +01:00 [DBG] Request did not match any endpoints
2024-06-12 07:52:21.438 +01:00 [DBG] Connection id "0HN4ALGQEQE4T" completed keep alive response.
2024-06-12 07:52:21.438 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5165/swagger/index.html - 200 null text/html;charset=utf-8 214.7416ms
2024-06-12 07:52:21.543 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5165/swagger/swagger-ui.css - null null
2024-06-12 07:52:21.544 +01:00 [DBG] No candidates found for the request path '/swagger/swagger-ui.css'
2024-06-12 07:52:21.546 +01:00 [DBG] Connection id "0HN4ALGQEQE4U" accepted.
2024-06-12 07:52:21.546 +01:00 [DBG] Request did not match any endpoints
2024-06-12 07:52:21.550 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5165/swagger/swagger-ui-bundle.js - null null
2024-06-12 07:52:21.550 +01:00 [DBG] No candidates found for the request path '/swagger/swagger-ui-bundle.js'
2024-06-12 07:52:21.550 +01:00 [DBG] Request did not match any endpoints
2024-06-12 07:52:21.584 +01:00 [DBG] Connection id "0HN4ALGQEQE4U" started.
2024-06-12 07:52:21.585 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5165/swagger/swagger-ui-standalone-preset.js - null null
2024-06-12 07:52:21.585 +01:00 [DBG] No candidates found for the request path '/swagger/swagger-ui-standalone-preset.js'
2024-06-12 07:52:21.585 +01:00 [DBG] Request did not match any endpoints
2024-06-12 07:52:21.719 +01:00 [INF] Sending file. Request path: '/swagger-ui.css'. Physical path: 'N/A'
2024-06-12 07:52:21.743 +01:00 [INF] Sending file. Request path: '/swagger-ui-standalone-preset.js'. Physical path: 'N/A'
2024-06-12 07:52:21.762 +01:00 [DBG] Connection id "0HN4ALGQEQE4T" completed keep alive response.
2024-06-12 07:52:21.762 +01:00 [DBG] Connection id "0HN4ALGQEQE4U" completed keep alive response.
2024-06-12 07:52:21.762 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5165/swagger/swagger-ui.css - 200 143943 text/css 219.217ms
2024-06-12 07:52:21.762 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5165/swagger/swagger-ui-standalone-preset.js - 200 339486 text/javascript 177.5129ms
2024-06-12 07:52:21.984 +01:00 [INF] Sending file. Request path: '/swagger-ui-bundle.js'. Physical path: 'N/A'
2024-06-12 07:52:21.984 +01:00 [DBG] Connection id "0HN4ALGQEQE4S" completed keep alive response.
2024-06-12 07:52:21.984 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5165/swagger/swagger-ui-bundle.js - 200 1096145 text/javascript 434.6679ms
2024-06-12 07:52:22.916 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5165/swagger/v1/swagger.json - null null
2024-06-12 07:52:22.918 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2024-06-12 07:52:22.918 +01:00 [DBG] Request did not match any endpoints
2024-06-12 07:52:23.054 +01:00 [INF] Request starting HTTP/1.1 GET http://localhost:5165/swagger/favicon-32x32.png - null null
2024-06-12 07:52:23.054 +01:00 [DBG] No candidates found for the request path '/swagger/favicon-32x32.png'
2024-06-12 07:52:23.054 +01:00 [DBG] Request did not match any endpoints
2024-06-12 07:52:23.136 +01:00 [INF] Sending file. Request path: '/favicon-32x32.png'. Physical path: 'N/A'
2024-06-12 07:52:23.136 +01:00 [DBG] Connection id "0HN4ALGQEQE4U" completed keep alive response.
2024-06-12 07:52:23.137 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5165/swagger/favicon-32x32.png - 200 628 image/png 83.6049ms
2024-06-12 07:52:23.571 +01:00 [DBG] Connection id "0HN4ALGQEQE4S" completed keep alive response.
2024-06-12 07:52:23.571 +01:00 [INF] Request finished HTTP/1.1 GET http://localhost:5165/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 654.3357ms
2024-06-12 07:53:53.089 +01:00 [DBG] Connection id "0HN4ALGQEQE4V" accepted.
2024-06-12 07:53:53.095 +01:00 [DBG] Connection id "0HN4ALGQEQE4V" started.
2024-06-12 07:53:53.099 +01:00 [INF] Request starting HTTP/1.1 POST http://localhost:5165/api/product - application/json 37
2024-06-12 07:53:53.112 +01:00 [DBG] 1 candidate(s) found for the request path '/api/product'
2024-06-12 07:53:53.119 +01:00 [DBG] Endpoint 'MyProject.Controller.ProductsController.Post (MyProject)' with route pattern 'api/product' is valid for the request path '/api/product'
2024-06-12 07:53:53.120 +01:00 [DBG] Request matched endpoint 'MyProject.Controller.ProductsController.Post (MyProject)'
2024-06-12 07:53:53.123 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2024-06-12 07:53:53.530 +01:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2024-06-12 07:53:55.508 +01:00 [DBG] Entity Framework Core 8.0.6 initialized 'TenantDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2024-06-12 07:53:55.654 +01:00 [DBG] Compiling query expression: 
'DbSet<Tenant>()
    .Where(x => x.Id == __tenant_0)
    .FirstOrDefault()'
2024-06-12 07:53:56.341 +01:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Tenant>(
    asyncEnumerable: new SingleQueryingEnumerable<Tenant>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Tenant.Id (string) Required PK AfterSave:Throw, 0], [Property: Tenant.Name (string) Required, 1] }
            SELECT TOP(1) t.Id, t.Name
            FROM Tenants AS t
            WHERE t.Id == @__tenant_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Tenant>, 
        MyProject.Data.TenantDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2024-06-12 07:53:56.541 +01:00 [DBG] Creating DbConnection.
2024-06-12 07:53:56.682 +01:00 [DBG] Created DbConnection. (132ms).
2024-06-12 07:53:56.691 +01:00 [DBG] Opening connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 07:53:57.841 +01:00 [DBG] Opened connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 07:53:57.856 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-06-12 07:53:57.882 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (14ms).
2024-06-12 07:53:57.899 +01:00 [DBG] Initialized DbCommand for 'ExecuteReader' (41ms).
2024-06-12 07:53:57.926 +01:00 [DBG] Executing DbCommand [Parameters=[@__tenant_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Name"
FROM "Tenants" AS t
WHERE t."Id" = @__tenant_0
LIMIT 1
2024-06-12 07:53:58.166 +01:00 [INF] Executed DbCommand (248ms) [Parameters=[@__tenant_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."Name"
FROM "Tenants" AS t
WHERE t."Id" = @__tenant_0
LIMIT 1
2024-06-12 07:53:58.285 +01:00 [DBG] Context 'TenantDbContext' started tracking 'Tenant' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 07:53:58.328 +01:00 [DBG] Closing data reader to 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 07:53:58.358 +01:00 [DBG] A data reader for 'userservice_db' on server 'tcp://localhost:5432' is being disposed after spending 169ms reading results.
2024-06-12 07:53:58.374 +01:00 [DBG] Closing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 07:53:58.385 +01:00 [DBG] Closed connection to database 'userservice_db' on server 'tcp://localhost:5432' (11ms).
2024-06-12 07:53:58.390 +01:00 [WRN] Failed to determine the https port for redirect.
2024-06-12 07:53:58.392 +01:00 [INF] Executing endpoint 'MyProject.Controller.ProductsController.Post (MyProject)'
2024-06-12 07:53:58.446 +01:00 [INF] Route matched with {action = "Post", controller = "Products"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Post(MyProject.DTOs.CreateProductRequest) on controller MyProject.Controller.ProductsController (MyProject).
2024-06-12 07:53:58.453 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2024-06-12 07:53:58.453 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2024-06-12 07:53:58.454 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2024-06-12 07:53:58.455 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2024-06-12 07:53:58.455 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2024-06-12 07:53:58.459 +01:00 [DBG] Executing controller factory for controller MyProject.Controller.ProductsController (MyProject)
2024-06-12 07:53:58.488 +01:00 [DBG] Executed controller factory for controller MyProject.Controller.ProductsController (MyProject)
2024-06-12 07:53:58.500 +01:00 [DBG] Attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest' ...
2024-06-12 07:53:58.550 +01:00 [DBG] Attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest' using the name '' in request data ...
2024-06-12 07:53:58.587 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2024-06-12 07:53:58.623 +01:00 [DBG] Connection id "0HN4ALGQEQE4V", Request id "0HN4ALGQEQE4V:00000001": started reading request body.
2024-06-12 07:53:58.624 +01:00 [DBG] Connection id "0HN4ALGQEQE4V", Request id "0HN4ALGQEQE4V:00000001": done reading request body.
2024-06-12 07:53:58.684 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'MyProject.DTOs.CreateProductRequest'
2024-06-12 07:53:58.686 +01:00 [DBG] Done attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest'.
2024-06-12 07:53:58.686 +01:00 [DBG] Done attempting to bind parameter 'request' of type 'MyProject.DTOs.CreateProductRequest'.
2024-06-12 07:53:58.686 +01:00 [DBG] Attempting to validate the bound parameter 'request' of type 'MyProject.DTOs.CreateProductRequest' ...
2024-06-12 07:53:58.750 +01:00 [DBG] Done attempting to validate the bound parameter 'request' of type 'MyProject.DTOs.CreateProductRequest'.
2024-06-12 07:55:03.915 +01:00 [DBG] Entity Framework Core 8.0.6 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2024-06-12 07:55:32.596 +01:00 [DBG] Connection id "0HN4ALGQEQE4V" received FIN.
2024-06-12 07:55:32.646 +01:00 [DBG] Connection id "0HN4ALGQEQE4V" sending FIN because: "The Socket transport's send loop completed gracefully."
2024-06-12 07:55:32.648 +01:00 [DBG] Connection id "0HN4ALGQEQE4V" disconnecting.
2024-06-12 07:55:32.706 +01:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Product.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 07:55:32.777 +01:00 [DBG] Context 'AppDbContext' started tracking 'Product' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-06-12 07:58:42.197 +01:00 [DBG] Connection id "0HN4ALGQEQE4T" received FIN.
2024-06-12 07:58:42.198 +01:00 [DBG] Connection id "0HN4ALGQEQE4U" received FIN.
2024-06-12 07:58:42.198 +01:00 [DBG] Connection id "0HN4ALGQEQE4S" received FIN.
2024-06-12 07:58:42.197 +01:00 [INF] Tenant from header context: beta
2024-06-12 07:58:42.205 +01:00 [DBG] Connection id "0HN4ALGQEQE4T" disconnecting.
2024-06-12 07:58:42.208 +01:00 [DBG] Connection id "0HN4ALGQEQE4T" stopped.
2024-06-12 07:58:42.209 +01:00 [DBG] DetectChanges starting for 'AppDbContext'.
2024-06-12 07:58:42.214 +01:00 [DBG] Connection id "0HN4ALGQEQE4U" disconnecting.
2024-06-12 07:58:42.215 +01:00 [DBG] Connection id "0HN4ALGQEQE4U" stopped.
2024-06-12 07:58:42.216 +01:00 [DBG] Connection id "0HN4ALGQEQE4S" disconnecting.
2024-06-12 07:58:42.217 +01:00 [DBG] Connection id "0HN4ALGQEQE4S" stopped.
2024-06-12 07:58:42.228 +01:00 [DBG] Connection id "0HN4ALGQEQE4T" sending FIN because: "The Socket transport's send loop completed gracefully."
2024-06-12 07:58:42.229 +01:00 [DBG] Connection id "0HN4ALGQEQE4U" sending FIN because: "The Socket transport's send loop completed gracefully."
2024-06-12 07:58:42.249 +01:00 [DBG] Connection id "0HN4ALGQEQE4S" sending FIN because: "The Socket transport's send loop completed gracefully."
2024-06-12 07:58:42.287 +01:00 [DBG] DetectChanges completed for 'AppDbContext'.
2024-06-12 07:58:42.295 +01:00 [INF] Entity state: Added
2024-06-12 07:58:52.223 +01:00 [DBG] SaveChanges starting for 'AppDbContext'.
2024-06-12 07:58:52.226 +01:00 [DBG] DetectChanges starting for 'AppDbContext'.
2024-06-12 07:58:52.226 +01:00 [DBG] DetectChanges completed for 'AppDbContext'.
2024-06-12 07:58:52.467 +01:00 [DBG] Creating DbConnection.
2024-06-12 07:58:52.468 +01:00 [DBG] Created DbConnection. (0ms).
2024-06-12 07:58:52.468 +01:00 [DBG] Opening connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 07:58:52.472 +01:00 [DBG] Opened connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 07:58:52.478 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-06-12 07:58:52.478 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2024-06-12 07:58:52.479 +01:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2024-06-12 07:58:52.480 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?' (DbType = Decimal), @p2='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Products" ("Name", "Price", "TenantId")
VALUES (@p0, @p1, @p2)
RETURNING "Id";
2024-06-12 07:58:52.654 +01:00 [ERR] Failed executing DbCommand (170ms) [Parameters=[@p0='?', @p1='?' (DbType = Decimal), @p2='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Products" ("Name", "Price", "TenantId")
VALUES (@p0, @p1, @p2)
RETURNING "Id";
2024-06-12 07:58:52.662 +01:00 [DBG] Closing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 07:58:52.663 +01:00 [DBG] Closed connection to database 'userservice_db' on server 'tcp://localhost:5432' (0ms).
2024-06-12 07:58:52.750 +01:00 [ERR] An exception occurred in the database while saving changes for context type 'MyProject.Data.AppDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23502: null value in column "TenantId" of relation "Products" violates not-null constraint

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23502
    MessageText: null value in column "TenantId" of relation "Products" violates not-null constraint
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: Products
    ColumnName: TenantId
    File: execMain.c
    Line: 1974
    Routine: ExecConstraints
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23502: null value in column "TenantId" of relation "Products" violates not-null constraint

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23502
    MessageText: null value in column "TenantId" of relation "Products" violates not-null constraint
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: Products
    ColumnName: TenantId
    File: execMain.c
    Line: 1974
    Routine: ExecConstraints
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2024-06-12 07:58:53.160 +01:00 [ERR] Error saving changes
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23502: null value in column "TenantId" of relation "Products" violates not-null constraint

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23502
    MessageText: null value in column "TenantId" of relation "Products" violates not-null constraint
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: Products
    ColumnName: TenantId
    File: execMain.c
    Line: 1974
    Routine: ExecConstraints
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at MyProject.Data.AppDbContext.SaveChangesAsync(CancellationToken cancellationToken) in c:\Users\ARthur\Desktop\projects\personal\MyProject\Data\AppDbContext.cs:line 65
2024-06-12 07:58:53.829 +01:00 [INF] Executed action MyProject.Controller.ProductsController.Post (MyProject) in 295365.7042ms
2024-06-12 07:58:53.832 +01:00 [INF] Executed endpoint 'MyProject.Controller.ProductsController.Post (MyProject)'
2024-06-12 07:58:53.837 +01:00 [ERR] HTTP POST /api/product responded 500 in 295445.3205 ms
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23502: null value in column "TenantId" of relation "Products" violates not-null constraint

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23502
    MessageText: null value in column "TenantId" of relation "Products" violates not-null constraint
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: Products
    ColumnName: TenantId
    File: execMain.c
    Line: 1974
    Routine: ExecConstraints
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at MyProject.Data.AppDbContext.SaveChangesAsync(CancellationToken cancellationToken) in c:\Users\ARthur\Desktop\projects\personal\MyProject\Data\AppDbContext.cs:line 65
   at MyProject.Repository.ProductService.CreateProduct(CreateProductRequest request) in c:\Users\ARthur\Desktop\projects\personal\MyProject\Repository\ProductService.cs:line 42
   at MyProject.Controller.ProductsController.Post(CreateProductRequest request) in c:\Users\ARthur\Desktop\projects\personal\MyProject\Controller\ProductsController.cs:line 34
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2024-06-12 07:58:54.238 +01:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Npgsql.PostgresException (0x80004005): 23502: null value in column "TenantId" of relation "Products" violates not-null constraint

DETAIL: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
  Exception data:
    Severity: ERROR
    SqlState: 23502
    MessageText: null value in column "TenantId" of relation "Products" violates not-null constraint
    Detail: Detail redacted as it may contain sensitive data. Specify 'Include Error Detail' in the connection string to include this information.
    SchemaName: public
    TableName: Products
    ColumnName: TenantId
    File: execMain.c
    Line: 1974
    Routine: ExecConstraints
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at MyProject.Data.AppDbContext.SaveChangesAsync(CancellationToken cancellationToken) in c:\Users\ARthur\Desktop\projects\personal\MyProject\Data\AppDbContext.cs:line 65
   at MyProject.Repository.ProductService.CreateProduct(CreateProductRequest request) in c:\Users\ARthur\Desktop\projects\personal\MyProject\Repository\ProductService.cs:line 42
   at MyProject.Controller.ProductsController.Post(CreateProductRequest request) in c:\Users\ARthur\Desktop\projects\personal\MyProject\Controller\ProductsController.cs:line 34
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at MyProject.Middleware.TenantResolver.InvokeAsync(HttpContext context, ICurrentTenantService currentTenantService) in c:\Users\ARthur\Desktop\projects\personal\MyProject\Middleware\TenantResolver.cs:line 28
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2024-06-12 07:58:54.308 +01:00 [DBG] 'AppDbContext' disposed.
2024-06-12 07:58:54.317 +01:00 [DBG] Disposing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 07:58:54.321 +01:00 [DBG] Disposed connection to database 'userservice_db' on server 'tcp://localhost:5432' (3ms).
2024-06-12 07:58:54.322 +01:00 [DBG] 'TenantDbContext' disposed.
2024-06-12 07:58:54.322 +01:00 [DBG] Disposing connection to database 'userservice_db' on server 'tcp://localhost:5432'.
2024-06-12 07:58:54.322 +01:00 [DBG] Disposed connection to database 'userservice_db' on server 'tcp://localhost:5432' (0ms).
2024-06-12 07:58:54.322 +01:00 [INF] Request finished HTTP/1.1 POST http://localhost:5165/api/product - 500 null text/plain; charset=utf-8 301223.5373ms
2024-06-12 07:58:54.323 +01:00 [DBG] Connection id "0HN4ALGQEQE4V" stopped.
